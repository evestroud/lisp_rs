(function(){const y=document.createElement("link").relList;if(y&&y.supports&&y.supports("modulepreload"))return;for(const M of document.querySelectorAll('link[rel="modulepreload"]'))I(M);new MutationObserver(M=>{for(const m of M)if(m.type==="childList")for(const L of m.addedNodes)L.tagName==="LINK"&&L.rel==="modulepreload"&&I(L)}).observe(document,{childList:!0,subtree:!0});function T(M){const m={};return M.integrity&&(m.integrity=M.integrity),M.referrerPolicy&&(m.referrerPolicy=M.referrerPolicy),M.crossOrigin==="use-credentials"?m.credentials="include":M.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function I(M){if(M.ep)return;M.ep=!0;const m=T(M);fetch(M.href,m)}})();var ye,X,qe,re,Pe,Xe,Le,me={},Ge=[],vt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,Ae=Array.isArray;function se(b,y){for(var T in y)b[T]=y[T];return b}function Ye(b){var y=b.parentNode;y&&y.removeChild(b)}function pt(b,y,T){var I,M,m,L={};for(m in y)m=="key"?I=y[m]:m=="ref"?M=y[m]:L[m]=y[m];if(arguments.length>2&&(L.children=arguments.length>3?ye.call(arguments,2):T),typeof b=="function"&&b.defaultProps!=null)for(m in b.defaultProps)L[m]===void 0&&(L[m]=b.defaultProps[m]);return de(b,L,I,M,null)}function de(b,y,T,I,M){var m={type:b,props:y,key:T,ref:I,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:M??++qe};return M==null&&X.vnode!=null&&X.vnode(m),m}function we(b){return b.children}function ue(b,y){this.props=b,this.context=y}function ce(b,y){if(y==null)return b.__?ce(b.__,b.__.__k.indexOf(b)+1):null;for(var T;y<b.__k.length;y++)if((T=b.__k[y])!=null&&T.__e!=null)return T.__e;return typeof b.type=="function"?ce(b):null}function Je(b){var y,T;if((b=b.__)!=null&&b.__c!=null){for(b.__e=b.__c.base=null,y=0;y<b.__k.length;y++)if((T=b.__k[y])!=null&&T.__e!=null){b.__e=b.__c.base=T.__e;break}return Je(b)}}function Ie(b){(!b.__d&&(b.__d=!0)&&re.push(b)&&!Se.__r++||Pe!==X.debounceRendering)&&((Pe=X.debounceRendering)||Xe)(Se)}function Se(){var b,y,T,I,M,m,L,t;for(re.sort(Le);b=re.shift();)b.__d&&(y=re.length,I=void 0,M=void 0,L=(m=(T=b).__v).__e,(t=T.__P)&&(I=[],(M=se({},m)).__v=m.__v+1,De(t,m,M,T.__n,t.ownerSVGElement!==void 0,m.__h!=null?[L]:null,I,L??ce(m),m.__h),it(I,m),m.__e!=L&&Je(m)),re.length>y&&re.sort(Le));Se.__r=0}function Ze(b,y,T,I,M,m,L,t,r,h){var c,_,a,u,v,d,e,s=I&&I.__k||Ge,o=s.length;for(T.__k=[],c=0;c<y.length;c++)if((u=T.__k[c]=(u=y[c])==null||typeof u=="boolean"||typeof u=="function"?null:typeof u=="string"||typeof u=="number"||typeof u=="bigint"?de(null,u,null,null,u):Ae(u)?de(we,{children:u},null,null,null):u.__b>0?de(u.type,u.props,u.key,u.ref?u.ref:null,u.__v):u)!=null){if(u.__=T,u.__b=T.__b+1,(a=s[c])===null||a&&u.key==a.key&&u.type===a.type)s[c]=void 0;else for(_=0;_<o;_++){if((a=s[_])&&u.key==a.key&&u.type===a.type){s[_]=void 0;break}a=null}De(b,u,a=a||me,M,m,L,t,r,h),v=u.__e,(_=u.ref)&&a.ref!=_&&(e||(e=[]),a.ref&&e.push(a.ref,null,u),e.push(_,u.__c||v,u)),v!=null?(d==null&&(d=v),typeof u.type=="function"&&u.__k===a.__k?u.__d=r=Qe(u,r,b):r=et(b,u,a,s,v,r),typeof T.type=="function"&&(T.__d=r)):r&&a.__e==r&&r.parentNode!=b&&(r=ce(a))}for(T.__e=d,c=o;c--;)s[c]!=null&&(typeof T.type=="function"&&s[c].__e!=null&&s[c].__e==T.__d&&(T.__d=tt(I).nextSibling),rt(s[c],s[c]));if(e)for(c=0;c<e.length;c++)st(e[c],e[++c],e[++c])}function Qe(b,y,T){for(var I,M=b.__k,m=0;M&&m<M.length;m++)(I=M[m])&&(I.__=b,y=typeof I.type=="function"?Qe(I,y,T):et(T,I,I,M,I.__e,y));return y}function et(b,y,T,I,M,m){var L,t,r;if(y.__d!==void 0)L=y.__d,y.__d=void 0;else if(T==null||M!=m||M.parentNode==null)e:if(m==null||m.parentNode!==b)b.appendChild(M),L=null;else{for(t=m,r=0;(t=t.nextSibling)&&r<I.length;r+=1)if(t==M)break e;b.insertBefore(M,m),L=m}return L!==void 0?L:M.nextSibling}function tt(b){var y,T,I;if(b.type==null||typeof b.type=="string")return b.__e;if(b.__k){for(y=b.__k.length-1;y>=0;y--)if((T=b.__k[y])&&(I=tt(T)))return I}return null}function gt(b,y,T,I,M){var m;for(m in T)m==="children"||m==="key"||m in y||Ce(b,m,null,T[m],I);for(m in y)M&&typeof y[m]!="function"||m==="children"||m==="key"||m==="value"||m==="checked"||T[m]===y[m]||Ce(b,m,y[m],T[m],I)}function Me(b,y,T){y[0]==="-"?b.setProperty(y,T??""):b[y]=T==null?"":typeof T!="number"||vt.test(y)?T:T+"px"}function Ce(b,y,T,I,M){var m;e:if(y==="style")if(typeof T=="string")b.style.cssText=T;else{if(typeof I=="string"&&(b.style.cssText=I=""),I)for(y in I)T&&y in T||Me(b.style,y,"");if(T)for(y in T)I&&T[y]===I[y]||Me(b.style,y,T[y])}else if(y[0]==="o"&&y[1]==="n")m=y!==(y=y.replace(/Capture$/,"")),y=y.toLowerCase()in b?y.toLowerCase().slice(2):y.slice(2),b.l||(b.l={}),b.l[y+m]=T,T?I||b.addEventListener(y,m?Fe:He,m):b.removeEventListener(y,m?Fe:He,m);else if(y!=="dangerouslySetInnerHTML"){if(M)y=y.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(y!=="width"&&y!=="height"&&y!=="href"&&y!=="list"&&y!=="form"&&y!=="tabIndex"&&y!=="download"&&y!=="rowSpan"&&y!=="colSpan"&&y in b)try{b[y]=T??"";break e}catch{}typeof T=="function"||(T==null||T===!1&&y[4]!=="-"?b.removeAttribute(y):b.setAttribute(y,T))}}function He(b){return this.l[b.type+!1](X.event?X.event(b):b)}function Fe(b){return this.l[b.type+!0](X.event?X.event(b):b)}function De(b,y,T,I,M,m,L,t,r){var h,c,_,a,u,v,d,e,s,o,i,n,f,p,C,l=y.type;if(y.constructor!==void 0)return null;T.__h!=null&&(r=T.__h,t=y.__e=T.__e,y.__h=null,m=[t]),(h=X.__b)&&h(y);try{e:if(typeof l=="function"){if(e=y.props,s=(h=l.contextType)&&I[h.__c],o=h?s?s.props.value:h.__:I,T.__c?d=(c=y.__c=T.__c).__=c.__E:("prototype"in l&&l.prototype.render?y.__c=c=new l(e,o):(y.__c=c=new ue(e,o),c.constructor=l,c.render=St),s&&s.sub(c),c.props=e,c.state||(c.state={}),c.context=o,c.__n=I,_=c.__d=!0,c.__h=[],c._sb=[]),c.__s==null&&(c.__s=c.state),l.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=se({},c.__s)),se(c.__s,l.getDerivedStateFromProps(e,c.__s))),a=c.props,u=c.state,c.__v=y,_)l.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(l.getDerivedStateFromProps==null&&e!==a&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(e,o),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(e,c.__s,o)===!1||y.__v===T.__v){for(y.__v!==T.__v&&(c.props=e,c.state=c.__s,c.__d=!1),c.__e=!1,y.__e=T.__e,y.__k=T.__k,y.__k.forEach(function(g){g&&(g.__=y)}),i=0;i<c._sb.length;i++)c.__h.push(c._sb[i]);c._sb=[],c.__h.length&&L.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(e,c.__s,o),c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(a,u,v)})}if(c.context=o,c.props=e,c.__P=b,n=X.__r,f=0,"prototype"in l&&l.prototype.render){for(c.state=c.__s,c.__d=!1,n&&n(y),h=c.render(c.props,c.state,c.context),p=0;p<c._sb.length;p++)c.__h.push(c._sb[p]);c._sb=[]}else do c.__d=!1,n&&n(y),h=c.render(c.props,c.state,c.context),c.state=c.__s;while(c.__d&&++f<25);c.state=c.__s,c.getChildContext!=null&&(I=se(se({},I),c.getChildContext())),_||c.getSnapshotBeforeUpdate==null||(v=c.getSnapshotBeforeUpdate(a,u)),Ze(b,Ae(C=h!=null&&h.type===we&&h.key==null?h.props.children:h)?C:[C],y,T,I,M,m,L,t,r),c.base=y.__e,y.__h=null,c.__h.length&&L.push(c),d&&(c.__E=c.__=null),c.__e=!1}else m==null&&y.__v===T.__v?(y.__k=T.__k,y.__e=T.__e):y.__e=mt(T.__e,y,T,I,M,m,L,r);(h=X.diffed)&&h(y)}catch(g){y.__v=null,(r||m!=null)&&(y.__e=t,y.__h=!!r,m[m.indexOf(t)]=null),X.__e(g,y,T)}}function it(b,y){X.__c&&X.__c(y,b),b.some(function(T){try{b=T.__h,T.__h=[],b.some(function(I){I.call(T)})}catch(I){X.__e(I,T.__v)}})}function mt(b,y,T,I,M,m,L,t){var r,h,c,_=T.props,a=y.props,u=y.type,v=0;if(u==="svg"&&(M=!0),m!=null){for(;v<m.length;v++)if((r=m[v])&&"setAttribute"in r==!!u&&(u?r.localName===u:r.nodeType===3)){b=r,m[v]=null;break}}if(b==null){if(u===null)return document.createTextNode(a);b=M?document.createElementNS("http://www.w3.org/2000/svg",u):document.createElement(u,a.is&&a),m=null,t=!1}if(u===null)_===a||t&&b.data===a||(b.data=a);else{if(m=m&&ye.call(b.childNodes),h=(_=T.props||me).dangerouslySetInnerHTML,c=a.dangerouslySetInnerHTML,!t){if(m!=null)for(_={},v=0;v<b.attributes.length;v++)_[b.attributes[v].name]=b.attributes[v].value;(c||h)&&(c&&(h&&c.__html==h.__html||c.__html===b.innerHTML)||(b.innerHTML=c&&c.__html||""))}if(gt(b,a,_,M,t),c)y.__k=[];else if(Ze(b,Ae(v=y.props.children)?v:[v],y,T,I,M&&u!=="foreignObject",m,L,m?m[0]:T.__k&&ce(T,0),t),m!=null)for(v=m.length;v--;)m[v]!=null&&Ye(m[v]);t||("value"in a&&(v=a.value)!==void 0&&(v!==b.value||u==="progress"&&!v||u==="option"&&v!==_.value)&&Ce(b,"value",v,_.value,!1),"checked"in a&&(v=a.checked)!==void 0&&v!==b.checked&&Ce(b,"checked",v,_.checked,!1))}return b}function st(b,y,T){try{typeof b=="function"?b(y):b.current=y}catch(I){X.__e(I,T)}}function rt(b,y,T){var I,M;if(X.unmount&&X.unmount(b),(I=b.ref)&&(I.current&&I.current!==b.__e||st(I,null,y)),(I=b.__c)!=null){if(I.componentWillUnmount)try{I.componentWillUnmount()}catch(m){X.__e(m,y)}I.base=I.__P=null,b.__c=void 0}if(I=b.__k)for(M=0;M<I.length;M++)I[M]&&rt(I[M],y,T||typeof b.type!="function");T||b.__e==null||Ye(b.__e),b.__=b.__e=b.__d=void 0}function St(b,y,T){return this.constructor(b,T)}function Ct(b,y,T){var I,M,m;X.__&&X.__(b,y),M=(I=typeof T=="function")?null:T&&T.__k||y.__k,m=[],De(y,b=(!I&&T||y).__k=pt(we,null,[b]),M||me,me,y.ownerSVGElement!==void 0,!I&&T?[T]:M?null:y.firstChild?ye.call(y.childNodes):null,m,!I&&T?T:M?M.__e:y.firstChild,I),it(m,b)}ye=Ge.slice,X={__e:function(b,y,T,I){for(var M,m,L;y=y.__;)if((M=y.__c)&&!M.__)try{if((m=M.constructor)&&m.getDerivedStateFromError!=null&&(M.setState(m.getDerivedStateFromError(b)),L=M.__d),M.componentDidCatch!=null&&(M.componentDidCatch(b,I||{}),L=M.__d),L)return M.__E=M}catch(t){b=t}throw b}},qe=0,ue.prototype.setState=function(b,y){var T;T=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=se({},this.state),typeof b=="function"&&(b=b(se({},T),this.props)),b&&se(T,b),b!=null&&this.__v&&(y&&this._sb.push(y),Ie(this))},ue.prototype.forceUpdate=function(b){this.__v&&(this.__e=!0,b&&this.__h.push(b),Ie(this))},ue.prototype.render=we,re=[],Xe=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Le=function(b,y){return b.__v.__b-y.__v.__b},Se.__r=0;var le,J,Ee,Ue,_e=0,nt=[],fe=[],Ne=X.__b,We=X.__r,$e=X.diffed,je=X.__c,Ve=X.unmount;function Be(b,y){X.__h&&X.__h(J,b,_e||y),_e=0;var T=J.__H||(J.__H={__:[],__h:[]});return b>=T.__.length&&T.__.push({__V:fe}),T.__[b]}function bt(b){return _e=1,yt(ht,b)}function yt(b,y,T){var I=Be(le++,2);if(I.t=b,!I.__c&&(I.__=[T?T(y):ht(void 0,y),function(t){var r=I.__N?I.__N[0]:I.__[0],h=I.t(r,t);r!==h&&(I.__N=[h,I.__[1]],I.__c.setState({}))}],I.__c=J,!J.u)){var M=function(t,r,h){if(!I.__c.__H)return!0;var c=I.__c.__H.__.filter(function(a){return a.__c});if(c.every(function(a){return!a.__N}))return!m||m.call(this,t,r,h);var _=!1;return c.forEach(function(a){if(a.__N){var u=a.__[0];a.__=a.__N,a.__N=void 0,u!==a.__[0]&&(_=!0)}}),!(!_&&I.__c.props===t)&&(!m||m.call(this,t,r,h))};J.u=!0;var m=J.shouldComponentUpdate,L=J.componentWillUpdate;J.componentWillUpdate=function(t,r,h){if(this.__e){var c=m;m=void 0,M(t,r,h),m=c}L&&L.call(this,t,r,h)},J.shouldComponentUpdate=M}return I.__N||I.__}function ot(b,y){var T=Be(le++,3);!X.__s&&at(T.__H,y)&&(T.__=b,T.i=y,J.__H.__h.push(T))}function wt(b){return _e=5,xe(function(){return{current:b}},[])}function xe(b,y){var T=Be(le++,7);return at(T.__H,y)?(T.__V=b(),T.i=y,T.__h=b,T.__V):T.__}function Et(b,y){return _e=8,xe(function(){return b},y)}function Lt(){for(var b;b=nt.shift();)if(b.__P&&b.__H)try{b.__H.__h.forEach(ve),b.__H.__h.forEach(Te),b.__H.__h=[]}catch(y){b.__H.__h=[],X.__e(y,b.__v)}}X.__b=function(b){J=null,Ne&&Ne(b)},X.__r=function(b){We&&We(b),le=0;var y=(J=b.__c).__H;y&&(Ee===J?(y.__h=[],J.__h=[],y.__.forEach(function(T){T.__N&&(T.__=T.__N),T.__V=fe,T.__N=T.i=void 0})):(y.__h.forEach(ve),y.__h.forEach(Te),y.__h=[],le=0)),Ee=J},X.diffed=function(b){$e&&$e(b);var y=b.__c;y&&y.__H&&(y.__H.__h.length&&(nt.push(y)!==1&&Ue===X.requestAnimationFrame||((Ue=X.requestAnimationFrame)||Tt)(Lt)),y.__H.__.forEach(function(T){T.i&&(T.__H=T.i),T.__V!==fe&&(T.__=T.__V),T.i=void 0,T.__V=fe})),Ee=J=null},X.__c=function(b,y){y.some(function(T){try{T.__h.forEach(ve),T.__h=T.__h.filter(function(I){return!I.__||Te(I)})}catch(I){y.some(function(M){M.__h&&(M.__h=[])}),y=[],X.__e(I,T.__v)}}),je&&je(b,y)},X.unmount=function(b){Ve&&Ve(b);var y,T=b.__c;T&&T.__H&&(T.__H.__.forEach(function(I){try{ve(I)}catch(M){y=M}}),T.__H=void 0,y&&X.__e(y,T.__v))};var Ke=typeof requestAnimationFrame=="function";function Tt(b){var y,T=function(){clearTimeout(I),Ke&&cancelAnimationFrame(y),setTimeout(b)},I=setTimeout(T,100);Ke&&(y=requestAnimationFrame(T))}function ve(b){var y=J,T=b.__c;typeof T=="function"&&(b.__c=void 0,T()),J=y}function Te(b){var y=J;b.__c=b.__(),J=y}function at(b,y){return!b||b.length!==y.length||y.some(function(T,I){return T!==b[I]})}function ht(b,y){return typeof y=="function"?y(b):y}var ct={exports:{}};(function(b,y){(function(T,I){b.exports=I()})(self,function(){return(()=>{var T={4567:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AccessibilityManager=void 0;const h=r(9042),c=r(6114),_=r(9924),a=r(3656),u=r(844),v=r(5596),d=r(9631);class e extends u.Disposable{constructor(o,i){super(),this._terminal=o,this._renderService=i,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityTreeRoot=document.createElement("div"),this._accessibilityTreeRoot.classList.add("xterm-accessibility"),this._accessibilityTreeRoot.tabIndex=0,this._rowContainer=document.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let n=0;n<this._terminal.rows;n++)this._rowElements[n]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[n]);if(this._topBoundaryFocusListener=n=>this._handleBoundaryFocus(n,0),this._bottomBoundaryFocusListener=n=>this._handleBoundaryFocus(n,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityTreeRoot.appendChild(this._rowContainer),this._renderRowsDebouncer=new _.TimeBasedDebouncer(this._renderRows.bind(this)),this._refreshRows(),this._liveRegion=document.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityTreeRoot.appendChild(this._liveRegion),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityTreeRoot),this.register(this._renderRowsDebouncer),this.register(this._terminal.onResize(n=>this._handleResize(n.rows))),this.register(this._terminal.onRender(n=>this._refreshRows(n.start,n.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(n=>this._handleChar(n))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(n=>this._handleTab(n))),this.register(this._terminal.onKey(n=>this._handleKey(n.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this._screenDprMonitor=new v.ScreenDprMonitor(window),this.register(this._screenDprMonitor),this._screenDprMonitor.setListener(()=>this._refreshRowsDimensions()),this.register((0,a.addDisposableDomListener)(window,"resize",()=>this._refreshRowsDimensions())),this.register((0,u.toDisposable)(()=>{(0,d.removeElementFromParent)(this._accessibilityTreeRoot),this._rowElements.length=0}))}_handleBoundaryFocus(o,i){const n=o.target,f=this._rowElements[i===0?1:this._rowElements.length-2];if(n.getAttribute("aria-posinset")===(i===0?"1":`${this._terminal.buffer.lines.length}`)||o.relatedTarget!==f)return;let p,C;if(i===0?(p=n,C=this._rowElements.pop(),this._rowContainer.removeChild(C)):(p=this._rowElements.shift(),C=n,this._rowContainer.removeChild(p)),p.removeEventListener("focus",this._topBoundaryFocusListener),C.removeEventListener("focus",this._bottomBoundaryFocusListener),i===0){const l=this._createAccessibilityTreeNode();this._rowElements.unshift(l),this._rowContainer.insertAdjacentElement("afterbegin",l)}else{const l=this._createAccessibilityTreeNode();this._rowElements.push(l),this._rowContainer.appendChild(l)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(i===0?-1:1),this._rowElements[i===0?1:this._rowElements.length-2].focus(),o.preventDefault(),o.stopImmediatePropagation()}_handleResize(o){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let i=this._rowContainer.children.length;i<this._terminal.rows;i++)this._rowElements[i]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[i]);for(;this._rowElements.length>o;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const o=document.createElement("div");return o.setAttribute("role","listitem"),o.tabIndex=-1,this._refreshRowDimensions(o),o}_handleTab(o){for(let i=0;i<o;i++)this._handleChar(" ")}_handleChar(o){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==o&&(this._charsToAnnounce+=o):this._charsToAnnounce+=o,o===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=h.tooMuchOutput)),c.isMac&&this._liveRegion.textContent&&this._liveRegion.textContent.length>0&&!this._liveRegion.parentNode&&setTimeout(()=>{this._accessibilityTreeRoot.appendChild(this._liveRegion)},0))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0,c.isMac&&(0,d.removeElementFromParent)(this._liveRegion)}_handleKey(o){this._clearLiveRegion(),/\p{Control}/u.test(o)||this._charsToConsume.push(o)}_refreshRows(o,i){this._renderRowsDebouncer.refresh(o,i,this._terminal.rows)}_renderRows(o,i){const n=this._terminal.buffer,f=n.lines.length.toString();for(let p=o;p<=i;p++){const C=n.translateBufferLineToString(n.ydisp+p,!0),l=(n.ydisp+p+1).toString(),g=this._rowElements[p];g&&(C.length===0?g.innerText=" ":g.textContent=C,g.setAttribute("aria-posinset",l),g.setAttribute("aria-setsize",f))}this._announceCharacters()}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityTreeRoot.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let o=0;o<this._terminal.rows;o++)this._refreshRowDimensions(this._rowElements[o])}}_refreshRowDimensions(o){o.style.height=`${this._renderService.dimensions.css.cell.height}px`}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}}t.AccessibilityManager=e},3614:(L,t)=>{function r(a){return a.replace(/\r?\n/g,"\r")}function h(a,u){return u?"\x1B[200~"+a+"\x1B[201~":a}function c(a,u,v){a=h(a=r(a),v.decPrivateModes.bracketedPasteMode),v.triggerDataEvent(a,!0),u.value=""}function _(a,u,v){const d=v.getBoundingClientRect(),e=a.clientX-d.left-10,s=a.clientY-d.top-10;u.style.width="20px",u.style.height="20px",u.style.left=`${e}px`,u.style.top=`${s}px`,u.style.zIndex="1000",u.focus()}Object.defineProperty(t,"__esModule",{value:!0}),t.rightClickHandler=t.moveTextAreaUnderMouseCursor=t.paste=t.handlePasteEvent=t.copyHandler=t.bracketTextForPaste=t.prepareTextForTerminal=void 0,t.prepareTextForTerminal=r,t.bracketTextForPaste=h,t.copyHandler=function(a,u){a.clipboardData&&a.clipboardData.setData("text/plain",u.selectionText),a.preventDefault()},t.handlePasteEvent=function(a,u,v){a.stopPropagation(),a.clipboardData&&c(a.clipboardData.getData("text/plain"),u,v)},t.paste=c,t.moveTextAreaUnderMouseCursor=_,t.rightClickHandler=function(a,u,v,d,e){_(a,u,v),e&&d.rightClickSelect(a),u.value=d.selectionText,u.select()}},7239:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorContrastCache=void 0;const h=r(1505);t.ColorContrastCache=class{constructor(){this._color=new h.TwoKeyMap,this._css=new h.TwoKeyMap}setCss(c,_,a){this._css.set(c,_,a)}getCss(c,_){return this._css.get(c,_)}setColor(c,_,a){this._color.set(c,_,a)}getColor(c,_){return this._color.get(c,_)}clear(){this._color.clear(),this._css.clear()}}},9631:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.removeElementFromParent=void 0,t.removeElementFromParent=function(...r){var h;for(const c of r)(h=c?.parentElement)===null||h===void 0||h.removeChild(c)}},3656:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addDisposableDomListener=void 0,t.addDisposableDomListener=function(r,h,c,_){r.addEventListener(h,c,_);let a=!1;return{dispose:()=>{a||(a=!0,r.removeEventListener(h,c,_))}}}},6465:function(L,t,r){var h=this&&this.__decorate||function(e,s,o,i){var n,f=arguments.length,p=f<3?s:i===null?i=Object.getOwnPropertyDescriptor(s,o):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(e,s,o,i);else for(var C=e.length-1;C>=0;C--)(n=e[C])&&(p=(f<3?n(p):f>3?n(s,o,p):n(s,o))||p);return f>3&&p&&Object.defineProperty(s,o,p),p},c=this&&this.__param||function(e,s){return function(o,i){s(o,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Linkifier2=void 0;const _=r(2585),a=r(8460),u=r(844),v=r(3656);let d=class extends u.Disposable{constructor(e){super(),this._bufferService=e,this._linkProviders=[],this._linkCacheDisposables=[],this._isMouseOut=!0,this._activeLine=-1,this._onShowLinkUnderline=this.register(new a.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new a.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,u.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,u.toDisposable)(()=>{this._lastMouseEvent=void 0}))}get currentLink(){return this._currentLink}registerLinkProvider(e){return this._linkProviders.push(e),{dispose:()=>{const s=this._linkProviders.indexOf(e);s!==-1&&this._linkProviders.splice(s,1)}}}attachToDom(e,s,o){this._element=e,this._mouseService=s,this._renderService=o,this.register((0,v.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,v.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,v.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,v.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(e){if(this._lastMouseEvent=e,!this._element||!this._mouseService)return;const s=this._positionFromMouseEvent(e,this._element,this._mouseService);if(!s)return;this._isMouseOut=!1;const o=e.composedPath();for(let i=0;i<o.length;i++){const n=o[i];if(n.classList.contains("xterm"))break;if(n.classList.contains("xterm-hover"))return}this._lastBufferCell&&s.x===this._lastBufferCell.x&&s.y===this._lastBufferCell.y||(this._handleHover(s),this._lastBufferCell=s)}_handleHover(e){if(this._activeLine!==e.y)return this._clearCurrentLink(),void this._askForLink(e,!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,e)||(this._clearCurrentLink(),this._askForLink(e,!0))}_askForLink(e,s){var o,i;this._activeProviderReplies&&s||((o=this._activeProviderReplies)===null||o===void 0||o.forEach(f=>{f?.forEach(p=>{p.link.dispose&&p.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=e.y);let n=!1;for(const[f,p]of this._linkProviders.entries())s?!((i=this._activeProviderReplies)===null||i===void 0)&&i.get(f)&&(n=this._checkLinkProviderResult(f,e,n)):p.provideLinks(e.y,C=>{var l,g;if(this._isMouseOut)return;const w=C?.map(k=>({link:k}));(l=this._activeProviderReplies)===null||l===void 0||l.set(f,w),n=this._checkLinkProviderResult(f,e,n),((g=this._activeProviderReplies)===null||g===void 0?void 0:g.size)===this._linkProviders.length&&this._removeIntersectingLinks(e.y,this._activeProviderReplies)})}_removeIntersectingLinks(e,s){const o=new Set;for(let i=0;i<s.size;i++){const n=s.get(i);if(n)for(let f=0;f<n.length;f++){const p=n[f],C=p.link.range.start.y<e?0:p.link.range.start.x,l=p.link.range.end.y>e?this._bufferService.cols:p.link.range.end.x;for(let g=C;g<=l;g++){if(o.has(g)){n.splice(f--,1);break}o.add(g)}}}}_checkLinkProviderResult(e,s,o){var i;if(!this._activeProviderReplies)return o;const n=this._activeProviderReplies.get(e);let f=!1;for(let p=0;p<e;p++)this._activeProviderReplies.has(p)&&!this._activeProviderReplies.get(p)||(f=!0);if(!f&&n){const p=n.find(C=>this._linkAtPosition(C.link,s));p&&(o=!0,this._handleNewLink(p))}if(this._activeProviderReplies.size===this._linkProviders.length&&!o)for(let p=0;p<this._activeProviderReplies.size;p++){const C=(i=this._activeProviderReplies.get(p))===null||i===void 0?void 0:i.find(l=>this._linkAtPosition(l.link,s));if(C){o=!0,this._handleNewLink(C);break}}return o}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(e){if(!this._element||!this._mouseService||!this._currentLink)return;const s=this._positionFromMouseEvent(e,this._element,this._mouseService);s&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,s)&&this._currentLink.link.activate(e,this._currentLink.link.text)}_clearCurrentLink(e,s){this._element&&this._currentLink&&this._lastMouseEvent&&(!e||!s||this._currentLink.link.range.start.y>=e&&this._currentLink.link.range.end.y<=s)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,u.disposeArray)(this._linkCacheDisposables))}_handleNewLink(e){if(!this._element||!this._lastMouseEvent||!this._mouseService)return;const s=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);s&&this._linkAtPosition(e.link,s)&&(this._currentLink=e,this._currentLink.state={decorations:{underline:e.link.decorations===void 0||e.link.decorations.underline,pointerCursor:e.link.decorations===void 0||e.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,e.link,this._lastMouseEvent),e.link.decorations={},Object.defineProperties(e.link.decorations,{pointerCursor:{get:()=>{var o,i;return(i=(o=this._currentLink)===null||o===void 0?void 0:o.state)===null||i===void 0?void 0:i.decorations.pointerCursor},set:o=>{var i,n;!((i=this._currentLink)===null||i===void 0)&&i.state&&this._currentLink.state.decorations.pointerCursor!==o&&(this._currentLink.state.decorations.pointerCursor=o,this._currentLink.state.isHovered&&((n=this._element)===null||n===void 0||n.classList.toggle("xterm-cursor-pointer",o)))}},underline:{get:()=>{var o,i;return(i=(o=this._currentLink)===null||o===void 0?void 0:o.state)===null||i===void 0?void 0:i.decorations.underline},set:o=>{var i,n,f;!((i=this._currentLink)===null||i===void 0)&&i.state&&((f=(n=this._currentLink)===null||n===void 0?void 0:n.state)===null||f===void 0?void 0:f.decorations.underline)!==o&&(this._currentLink.state.decorations.underline=o,this._currentLink.state.isHovered&&this._fireUnderlineEvent(e.link,o))}}}),this._renderService&&this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(o=>{const i=o.start===0?0:o.start+1+this._bufferService.buffer.ydisp,n=this._currentLink?this._lastMouseEvent:void 0;if(this._clearCurrentLink(i,o.end+1+this._bufferService.buffer.ydisp),n&&this._element){const f=this._positionFromMouseEvent(n,this._element,this._mouseService);f&&this._askForLink(f,!1)}})))}_linkHover(e,s,o){var i;!((i=this._currentLink)===null||i===void 0)&&i.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(s,!0),this._currentLink.state.decorations.pointerCursor&&e.classList.add("xterm-cursor-pointer")),s.hover&&s.hover(o,s.text)}_fireUnderlineEvent(e,s){const o=e.range,i=this._bufferService.buffer.ydisp,n=this._createLinkUnderlineEvent(o.start.x-1,o.start.y-i-1,o.end.x,o.end.y-i-1,void 0);(s?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(n)}_linkLeave(e,s,o){var i;!((i=this._currentLink)===null||i===void 0)&&i.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(s,!1),this._currentLink.state.decorations.pointerCursor&&e.classList.remove("xterm-cursor-pointer")),s.leave&&s.leave(o,s.text)}_linkAtPosition(e,s){const o=e.range.start.y*this._bufferService.cols+e.range.start.x,i=e.range.end.y*this._bufferService.cols+e.range.end.x,n=s.y*this._bufferService.cols+s.x;return o<=n&&n<=i}_positionFromMouseEvent(e,s,o){const i=o.getCoords(e,s,this._bufferService.cols,this._bufferService.rows);if(i)return{x:i[0],y:i[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(e,s,o,i,n){return{x1:e,y1:s,x2:o,y2:i,cols:this._bufferService.cols,fg:n}}};d=h([c(0,_.IBufferService)],d),t.Linkifier2=d},9042:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.tooMuchOutput=t.promptLabel=void 0,t.promptLabel="Terminal input",t.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(L,t,r){var h=this&&this.__decorate||function(d,e,s,o){var i,n=arguments.length,f=n<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(d,e,s,o);else for(var p=d.length-1;p>=0;p--)(i=d[p])&&(f=(n<3?i(f):n>3?i(e,s,f):i(e,s))||f);return n>3&&f&&Object.defineProperty(e,s,f),f},c=this&&this.__param||function(d,e){return function(s,o){e(s,o,d)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkProvider=void 0;const _=r(511),a=r(2585);let u=class{constructor(d,e,s){this._bufferService=d,this._optionsService=e,this._oscLinkService=s}provideLinks(d,e){var s;const o=this._bufferService.buffer.lines.get(d-1);if(!o)return void e(void 0);const i=[],n=this._optionsService.rawOptions.linkHandler,f=new _.CellData,p=o.getTrimmedLength();let C=-1,l=-1,g=!1;for(let w=0;w<p;w++)if(l!==-1||o.hasContent(w)){if(o.loadCell(w,f),f.hasExtendedAttrs()&&f.extended.urlId){if(l===-1){l=w,C=f.extended.urlId;continue}g=f.extended.urlId!==C}else l!==-1&&(g=!0);if(g||l!==-1&&w===p-1){const k=(s=this._oscLinkService.getLinkData(C))===null||s===void 0?void 0:s.uri;if(k){const R={start:{x:l+1,y:d},end:{x:w+(g||w!==p-1?0:1),y:d}};let O=!1;if(!n?.allowNonHttpProtocols)try{const H=new URL(k);["http:","https:"].includes(H.protocol)||(O=!0)}catch{O=!0}O||i.push({text:k,range:R,activate:(H,W)=>n?n.activate(H,W,R):v(0,W),hover:(H,W)=>{var j;return(j=n?.hover)===null||j===void 0?void 0:j.call(n,H,W,R)},leave:(H,W)=>{var j;return(j=n?.leave)===null||j===void 0?void 0:j.call(n,H,W,R)}})}g=!1,f.hasExtendedAttrs()&&f.extended.urlId?(l=w,C=f.extended.urlId):(l=-1,C=-1)}}e(i)}};function v(d,e){if(confirm(`Do you want to navigate to ${e}?

WARNING: This link could potentially be dangerous`)){const s=window.open();if(s){try{s.opener=null}catch{}s.location.href=e}else console.warn("Opening link blocked as opener could not be cleared")}}u=h([c(0,a.IBufferService),c(1,a.IOptionsService),c(2,a.IOscLinkService)],u),t.OscLinkProvider=u},6193:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RenderDebouncer=void 0,t.RenderDebouncer=class{constructor(r,h){this._parentWindow=r,this._renderCallback=h,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._parentWindow.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(r){return this._refreshCallbacks.push(r),this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(r,h,c){this._rowCount=c,r=r!==void 0?r:0,h=h!==void 0?h:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,r):r,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,h):h,this._animationFrame||(this._animationFrame=this._parentWindow.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const r=Math.max(this._rowStart,0),h=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(r,h),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const r of this._refreshCallbacks)r(0);this._refreshCallbacks=[]}}},5596:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ScreenDprMonitor=void 0;const h=r(844);class c extends h.Disposable{constructor(a){super(),this._parentWindow=a,this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this.register((0,h.toDisposable)(()=>{this.clearListener()}))}setListener(a){this._listener&&this.clearListener(),this._listener=a,this._outerListener=()=>{this._listener&&(this._listener(this._parentWindow.devicePixelRatio,this._currentDevicePixelRatio),this._updateDpr())},this._updateDpr()}_updateDpr(){var a;this._outerListener&&((a=this._resolutionMediaMatchList)===null||a===void 0||a.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._listener&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._listener=void 0,this._outerListener=void 0)}}t.ScreenDprMonitor=c},3236:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Terminal=void 0;const h=r(2950),c=r(1680),_=r(3614),a=r(2584),u=r(5435),v=r(9312),d=r(6114),e=r(3656),s=r(9042),o=r(4567),i=r(1296),n=r(7399),f=r(8460),p=r(8437),C=r(3230),l=r(4725),g=r(428),w=r(8934),k=r(6465),R=r(5114),O=r(8969),H=r(8055),W=r(4269),j=r(5941),S=r(3107),E=r(5744),D=r(9074),x=r(2585),U=r(3730),V=r(844),q=r(6731),N=typeof window<"u"?window.document:null;class z extends O.CoreTerminal{constructor(A={}){super(A),this.browser=d,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._onCursorMove=this.register(new f.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new f.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new f.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new f.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new f.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new f.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new f.EventEmitter),this._onBlur=this.register(new f.EventEmitter),this._onA11yCharEmitter=this.register(new f.EventEmitter),this._onA11yTabEmitter=this.register(new f.EventEmitter),this._onWillOpen=this.register(new f.EventEmitter),this._setup(),this.linkifier2=this.register(this._instantiationService.createInstance(k.Linkifier2)),this.linkifier2.registerLinkProvider(this._instantiationService.createInstance(U.OscLinkProvider)),this._decorationService=this._instantiationService.createInstance(D.DecorationService),this._instantiationService.setService(x.IDecorationService,this._decorationService),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((P,F)=>this.refresh(P,F))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(P=>this._reportWindowsOptions(P))),this.register(this._inputHandler.onColor(P=>this._handleColorEvent(P))),this.register((0,f.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,f.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,f.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,f.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(P=>this._afterResize(P.cols,P.rows))),this.register((0,V.toDisposable)(()=>{var P,F;this._customKeyEventHandler=void 0,(F=(P=this.element)===null||P===void 0?void 0:P.parentNode)===null||F===void 0||F.removeChild(this.element)}))}get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}_handleColorEvent(A){if(this._themeService)for(const P of A){let F,$="";switch(P.index){case 256:F="foreground",$="10";break;case 257:F="background",$="11";break;case 258:F="cursor",$="12";break;default:F="ansi",$="4;"+P.index}switch(P.type){case 0:const Y=H.color.toColorRGB(F==="ansi"?this._themeService.colors.ansi[P.index]:this._themeService.colors[F]);this.coreService.triggerDataEvent(`${a.C0.ESC}]${$};${(0,j.toRgbString)(Y)}${a.C1_ESCAPED.ST}`);break;case 1:if(F==="ansi")this._themeService.modifyColors(K=>K.ansi[P.index]=H.rgba.toColor(...P.color));else{const K=F;this._themeService.modifyColors(Q=>Q[K]=H.rgba.toColor(...P.color))}break;case 2:this._themeService.restoreColor(P.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(A){var P;A?!this._accessibilityManager&&this._renderService&&(this._accessibilityManager=new o.AccessibilityManager(this,this._renderService)):((P=this._accessibilityManager)===null||P===void 0||P.dispose(),this._accessibilityManager=void 0)}_handleTextAreaFocus(A){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(a.C0.ESC+"[I"),this.updateCursorStyle(A),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var A;return(A=this.textarea)===null||A===void 0?void 0:A.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(a.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const A=this.buffer.ybase+this.buffer.y,P=this.buffer.lines.get(A);if(!P)return;const F=Math.min(this.buffer.x,this.cols-1),$=this._renderService.dimensions.css.cell.height,Y=P.getWidth(F),K=this._renderService.dimensions.css.cell.width*Y,Q=this.buffer.y*this._renderService.dimensions.css.cell.height,te=F*this._renderService.dimensions.css.cell.width;this.textarea.style.left=te+"px",this.textarea.style.top=Q+"px",this.textarea.style.width=K+"px",this.textarea.style.height=$+"px",this.textarea.style.lineHeight=$+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,e.addDisposableDomListener)(this.element,"copy",P=>{this.hasSelection()&&(0,_.copyHandler)(P,this._selectionService)}));const A=P=>(0,_.handlePasteEvent)(P,this.textarea,this.coreService);this.register((0,e.addDisposableDomListener)(this.textarea,"paste",A)),this.register((0,e.addDisposableDomListener)(this.element,"paste",A)),d.isFirefox?this.register((0,e.addDisposableDomListener)(this.element,"mousedown",P=>{P.button===2&&(0,_.rightClickHandler)(P,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,e.addDisposableDomListener)(this.element,"contextmenu",P=>{(0,_.rightClickHandler)(P,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),d.isLinux&&this.register((0,e.addDisposableDomListener)(this.element,"auxclick",P=>{P.button===1&&(0,_.moveTextAreaUnderMouseCursor)(P,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,e.addDisposableDomListener)(this.textarea,"keyup",A=>this._keyUp(A),!0)),this.register((0,e.addDisposableDomListener)(this.textarea,"keydown",A=>this._keyDown(A),!0)),this.register((0,e.addDisposableDomListener)(this.textarea,"keypress",A=>this._keyPress(A),!0)),this.register((0,e.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,e.addDisposableDomListener)(this.textarea,"compositionupdate",A=>this._compositionHelper.compositionupdate(A))),this.register((0,e.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,e.addDisposableDomListener)(this.textarea,"input",A=>this._inputEvent(A),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(A){var P;if(!A)throw new Error("Terminal requires a parent element.");A.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),this._document=A.ownerDocument,this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),this.element.setAttribute("tabindex","0"),A.appendChild(this.element);const F=N.createDocumentFragment();this._viewportElement=N.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),F.appendChild(this._viewportElement),this._viewportScrollArea=N.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=N.createElement("div"),this.screenElement.classList.add("xterm-screen"),this._helperContainer=N.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),F.appendChild(this.screenElement),this.textarea=N.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",s.promptLabel),d.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this._instantiationService.createInstance(R.CoreBrowserService,this.textarea,(P=this._document.defaultView)!==null&&P!==void 0?P:window),this._instantiationService.setService(l.ICoreBrowserService,this._coreBrowserService),this.register((0,e.addDisposableDomListener)(this.textarea,"focus",$=>this._handleTextAreaFocus($))),this.register((0,e.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(g.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(l.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(q.ThemeService),this._instantiationService.setService(l.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(W.CharacterJoinerService),this._instantiationService.setService(l.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(C.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(l.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange($=>this._onRender.fire($))),this.onResize($=>this._renderService.resize($.cols,$.rows)),this._compositionView=N.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(h.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this.element.appendChild(F);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this._mouseService=this._instantiationService.createInstance(w.MouseService),this._instantiationService.setService(l.IMouseService,this._mouseService),this.viewport=this._instantiationService.createInstance(c.Viewport,$=>this.scrollLines($,!0,1),this._viewportElement,this._viewportScrollArea),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(v.SelectionService,this.element,this.screenElement,this.linkifier2)),this._instantiationService.setService(l.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines($=>this.scrollLines($.amount,$.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw($=>this._renderService.handleSelectionChanged($.start,$.end,$.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection($=>{this.textarea.value=$,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event($=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,e.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.linkifier2.attachToDom(this.screenElement,this._mouseService,this._renderService),this.register(this._instantiationService.createInstance(S.BufferDecorationRenderer,this.screenElement)),this.register((0,e.addDisposableDomListener)(this.element,"mousedown",$=>this._selectionService.handleMouseDown($))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager=new o.AccessibilityManager(this,this._renderService)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",$=>this._handleScreenReaderModeOptionChange($))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(E.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",$=>{!this._overviewRulerRenderer&&$&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(E.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(i.DomRenderer,this.element,this.screenElement,this._viewportElement,this.linkifier2)}bindMouse(){const A=this,P=this.element;function F(K){const Q=A._mouseService.getMouseReportCoords(K,A.screenElement);if(!Q)return!1;let te,ee;switch(K.overrideType||K.type){case"mousemove":ee=32,K.buttons===void 0?(te=3,K.button!==void 0&&(te=K.button<3?K.button:3)):te=1&K.buttons?0:4&K.buttons?1:2&K.buttons?2:3;break;case"mouseup":ee=0,te=K.button<3?K.button:3;break;case"mousedown":ee=1,te=K.button<3?K.button:3;break;case"wheel":if(A.viewport.getLinesScrolled(K)===0)return!1;ee=K.deltaY<0?0:1,te=4;break;default:return!1}return!(ee===void 0||te===void 0||te>4)&&A.coreMouseService.triggerMouseEvent({col:Q.col,row:Q.row,x:Q.x,y:Q.y,button:te,action:ee,ctrl:K.ctrlKey,alt:K.altKey,shift:K.shiftKey})}const $={mouseup:null,wheel:null,mousedrag:null,mousemove:null},Y={mouseup:K=>(F(K),K.buttons||(this._document.removeEventListener("mouseup",$.mouseup),$.mousedrag&&this._document.removeEventListener("mousemove",$.mousedrag)),this.cancel(K)),wheel:K=>(F(K),this.cancel(K,!0)),mousedrag:K=>{K.buttons&&F(K)},mousemove:K=>{K.buttons||F(K)}};this.register(this.coreMouseService.onProtocolChange(K=>{K?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(K)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&K?$.mousemove||(P.addEventListener("mousemove",Y.mousemove),$.mousemove=Y.mousemove):(P.removeEventListener("mousemove",$.mousemove),$.mousemove=null),16&K?$.wheel||(P.addEventListener("wheel",Y.wheel,{passive:!1}),$.wheel=Y.wheel):(P.removeEventListener("wheel",$.wheel),$.wheel=null),2&K?$.mouseup||($.mouseup=Y.mouseup):(this._document.removeEventListener("mouseup",$.mouseup),$.mouseup=null),4&K?$.mousedrag||($.mousedrag=Y.mousedrag):(this._document.removeEventListener("mousemove",$.mousedrag),$.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,e.addDisposableDomListener)(P,"mousedown",K=>{if(K.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(K))return F(K),$.mouseup&&this._document.addEventListener("mouseup",$.mouseup),$.mousedrag&&this._document.addEventListener("mousemove",$.mousedrag),this.cancel(K)})),this.register((0,e.addDisposableDomListener)(P,"wheel",K=>{if(!$.wheel){if(!this.buffer.hasScrollback){const Q=this.viewport.getLinesScrolled(K);if(Q===0)return;const te=a.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(K.deltaY<0?"A":"B");let ee="";for(let G=0;G<Math.abs(Q);G++)ee+=te;return this.coreService.triggerDataEvent(ee,!0),this.cancel(K,!0)}return this.viewport.handleWheel(K)?this.cancel(K):void 0}},{passive:!1})),this.register((0,e.addDisposableDomListener)(P,"touchstart",K=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(K),this.cancel(K)},{passive:!0})),this.register((0,e.addDisposableDomListener)(P,"touchmove",K=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(K)?void 0:this.cancel(K)},{passive:!1}))}refresh(A,P){var F;(F=this._renderService)===null||F===void 0||F.refreshRows(A,P)}updateCursorStyle(A){var P;!((P=this._selectionService)===null||P===void 0)&&P.shouldColumnSelect(A)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(A,P,F=0){super.scrollLines(A,P,F),this.refresh(0,this.rows-1)}paste(A){(0,_.paste)(A,this.textarea,this.coreService)}attachCustomKeyEventHandler(A){this._customKeyEventHandler=A}registerLinkProvider(A){return this.linkifier2.registerLinkProvider(A)}registerCharacterJoiner(A){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const P=this._characterJoinerService.register(A);return this.refresh(0,this.rows-1),P}deregisterCharacterJoiner(A){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(A)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}addMarker(A){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+A)}registerDecoration(A){return this._decorationService.registerDecoration(A)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(A,P,F){this._selectionService.setSelection(A,P,F)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var A;(A=this._selectionService)===null||A===void 0||A.clearSelection()}selectAll(){var A;(A=this._selectionService)===null||A===void 0||A.selectAll()}selectLines(A,P){var F;(F=this._selectionService)===null||F===void 0||F.selectLines(A,P)}_keyDown(A){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1)return!1;const P=this.browser.isMac&&this.options.macOptionIsMeta&&A.altKey;if(!P&&!this._compositionHelper.keydown(A))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this._bufferService.scrollToBottom(),!1;P||A.key!=="Dead"&&A.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const F=(0,n.evaluateKeyboardEvent)(A,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(A),F.type===3||F.type===2){const $=this.rows-1;return this.scrollLines(F.type===2?-$:$),this.cancel(A,!0)}return F.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,A)||(F.cancel&&this.cancel(A,!0),!F.key||!!(A.key&&!A.ctrlKey&&!A.altKey&&!A.metaKey&&A.key.length===1&&A.key.charCodeAt(0)>=65&&A.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(F.key!==a.C0.ETX&&F.key!==a.C0.CR||(this.textarea.value=""),this._onKey.fire({key:F.key,domEvent:A}),this._showCursor(),this.coreService.triggerDataEvent(F.key,!0),!this.optionsService.rawOptions.screenReaderMode||A.altKey||A.ctrlKey?this.cancel(A,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(A,P){const F=A.isMac&&!this.options.macOptionIsMeta&&P.altKey&&!P.ctrlKey&&!P.metaKey||A.isWindows&&P.altKey&&P.ctrlKey&&!P.metaKey||A.isWindows&&P.getModifierState("AltGraph");return P.type==="keypress"?F:F&&(!P.keyCode||P.keyCode>47)}_keyUp(A){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1||(function(P){return P.keyCode===16||P.keyCode===17||P.keyCode===18}(A)||this.focus(),this.updateCursorStyle(A),this._keyPressHandled=!1)}_keyPress(A){let P;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(A)===!1)return!1;if(this.cancel(A),A.charCode)P=A.charCode;else if(A.which===null||A.which===void 0)P=A.keyCode;else{if(A.which===0||A.charCode===0)return!1;P=A.which}return!(!P||(A.altKey||A.ctrlKey||A.metaKey)&&!this._isThirdLevelShift(this.browser,A)||(P=String.fromCharCode(P),this._onKey.fire({key:P,domEvent:A}),this._showCursor(),this.coreService.triggerDataEvent(P,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(A){if(A.data&&A.inputType==="insertText"&&(!A.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const P=A.data;return this.coreService.triggerDataEvent(P,!0),this.cancel(A),!0}return!1}resize(A,P){A!==this.cols||P!==this.rows?super.resize(A,P):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(A,P){var F,$;(F=this._charSizeService)===null||F===void 0||F.measure(),($=this.viewport)===null||$===void 0||$.syncScrollArea(!0)}clear(){if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let A=1;A<this.rows;A++)this.buffer.lines.push(this.buffer.getBlankLine(p.DEFAULT_ATTR_DATA));this.refresh(0,this.rows-1),this._onScroll.fire({position:this.buffer.ydisp,source:0})}}reset(){var A,P;this.options.rows=this.rows,this.options.cols=this.cols;const F=this._customKeyEventHandler;this._setup(),super.reset(),(A=this._selectionService)===null||A===void 0||A.reset(),this._decorationService.reset(),this._customKeyEventHandler=F,this.refresh(0,this.rows-1),(P=this.viewport)===null||P===void 0||P.syncScrollArea()}clearTextureAtlas(){var A;(A=this._renderService)===null||A===void 0||A.clearTextureAtlas()}_reportFocus(){var A;!((A=this.element)===null||A===void 0)&&A.classList.contains("focus")?this.coreService.triggerDataEvent(a.C0.ESC+"[I"):this.coreService.triggerDataEvent(a.C0.ESC+"[O")}_reportWindowsOptions(A){if(this._renderService)switch(A){case u.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const P=this._renderService.dimensions.css.canvas.width.toFixed(0),F=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${a.C0.ESC}[4;${F};${P}t`);break;case u.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const $=this._renderService.dimensions.css.cell.width.toFixed(0),Y=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${a.C0.ESC}[6;${Y};${$}t`)}}cancel(A,P){if(this.options.cancelEvents||P)return A.preventDefault(),A.stopPropagation(),!1}}t.Terminal=z},9924:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TimeBasedDebouncer=void 0,t.TimeBasedDebouncer=class{constructor(r,h=1e3){this._renderCallback=r,this._debounceThresholdMS=h,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(r,h,c){this._rowCount=c,r=r!==void 0?r:0,h=h!==void 0?h:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,r):r,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,h):h;const _=Date.now();if(_-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=_,this._innerRefresh();else if(!this._additionalRefreshRequested){const a=_-this._lastRefreshMs,u=this._debounceThresholdMS-a;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},u)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const r=Math.max(this._rowStart,0),h=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(r,h)}}},1680:function(L,t,r){var h=this&&this.__decorate||function(e,s,o,i){var n,f=arguments.length,p=f<3?s:i===null?i=Object.getOwnPropertyDescriptor(s,o):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(e,s,o,i);else for(var C=e.length-1;C>=0;C--)(n=e[C])&&(p=(f<3?n(p):f>3?n(s,o,p):n(s,o))||p);return f>3&&p&&Object.defineProperty(s,o,p),p},c=this&&this.__param||function(e,s){return function(o,i){s(o,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.Viewport=void 0;const _=r(844),a=r(3656),u=r(4725),v=r(2585);let d=class extends _.Disposable{constructor(e,s,o,i,n,f,p,C,l){super(),this._scrollLines=e,this._viewportElement=s,this._scrollArea=o,this._bufferService=i,this._optionsService=n,this._charSizeService=f,this._renderService=p,this._coreBrowserService=C,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,a.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(g=>this._activeBuffer=g.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(g=>this._renderDimensions=g)),this._handleThemeChange(l.colors),this.register(l.onChangeColors(g=>this._handleThemeChange(g))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea(),0)}_handleThemeChange(e){this._viewportElement.style.backgroundColor=e.background.css}_refresh(e){if(e)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderService.dimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderService.dimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const s=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderService.dimensions.css.canvas.height);this._lastRecordedBufferHeight!==s&&(this._lastRecordedBufferHeight=s,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const e=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==e&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=e),this._refreshAnimationFrame=null}syncScrollArea(e=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(e);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(e)}_handleScroll(e){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._scrollLines(0);const s=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._scrollLines(s)}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const e=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(e*(this._smoothScrollState.target-this._smoothScrollState.origin)),e<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(e,s){const o=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(s<0&&this._viewportElement.scrollTop!==0||s>0&&o<this._lastRecordedBufferHeight)||(e.cancelable&&e.preventDefault(),!1)}handleWheel(e){const s=this._getPixelsScrolled(e);return s!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+s:this._smoothScrollState.target+=s,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=s,this._bubbleScroll(e,s))}_getPixelsScrolled(e){if(e.deltaY===0||e.shiftKey)return 0;let s=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_LINE?s*=this._currentRowHeight:e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(s*=this._currentRowHeight*this._bufferService.rows),s}getLinesScrolled(e){if(e.deltaY===0||e.shiftKey)return 0;let s=this._applyScrollModifier(e.deltaY,e);return e.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(s/=this._currentRowHeight+0,this._wheelPartialScroll+=s,s=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):e.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(s*=this._bufferService.rows),s}_applyScrollModifier(e,s){const o=this._optionsService.rawOptions.fastScrollModifier;return o==="alt"&&s.altKey||o==="ctrl"&&s.ctrlKey||o==="shift"&&s.shiftKey?e*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:e*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(e){this._lastTouchY=e.touches[0].pageY}handleTouchMove(e){const s=this._lastTouchY-e.touches[0].pageY;return this._lastTouchY=e.touches[0].pageY,s!==0&&(this._viewportElement.scrollTop+=s,this._bubbleScroll(e,s))}};d=h([c(3,v.IBufferService),c(4,v.IOptionsService),c(5,u.ICharSizeService),c(6,u.IRenderService),c(7,u.ICoreBrowserService),c(8,u.IThemeService)],d),t.Viewport=d},3107:function(L,t,r){var h=this&&this.__decorate||function(e,s,o,i){var n,f=arguments.length,p=f<3?s:i===null?i=Object.getOwnPropertyDescriptor(s,o):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(e,s,o,i);else for(var C=e.length-1;C>=0;C--)(n=e[C])&&(p=(f<3?n(p):f>3?n(s,o,p):n(s,o))||p);return f>3&&p&&Object.defineProperty(s,o,p),p},c=this&&this.__param||function(e,s){return function(o,i){s(o,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferDecorationRenderer=void 0;const _=r(3656),a=r(4725),u=r(844),v=r(2585);let d=class extends u.Disposable{constructor(e,s,o,i){super(),this._screenElement=e,this._bufferService=s,this._decorationService=o,this._renderService=i,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register((0,_.addDisposableDomListener)(window,"resize",()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(n=>this._removeDecoration(n))),this.register((0,u.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const e of this._decorationService.decorations)this._renderDecoration(e);this._dimensionsChanged=!1}_renderDecoration(e){this._refreshStyle(e),this._dimensionsChanged&&this._refreshXPosition(e)}_createElement(e){var s;const o=document.createElement("div");o.classList.add("xterm-decoration"),o.style.width=`${Math.round((e.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,o.style.height=(e.options.height||1)*this._renderService.dimensions.css.cell.height+"px",o.style.top=(e.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",o.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const i=(s=e.options.x)!==null&&s!==void 0?s:0;return i&&i>this._bufferService.cols&&(o.style.display="none"),this._refreshXPosition(e,o),o}_refreshStyle(e){const s=e.marker.line-this._bufferService.buffers.active.ydisp;if(s<0||s>=this._bufferService.rows)e.element&&(e.element.style.display="none",e.onRenderEmitter.fire(e.element));else{let o=this._decorationElements.get(e);o||(o=this._createElement(e),e.element=o,this._decorationElements.set(e,o),this._container.appendChild(o)),o.style.top=s*this._renderService.dimensions.css.cell.height+"px",o.style.display=this._altBufferIsActive?"none":"block",e.onRenderEmitter.fire(o)}}_refreshXPosition(e,s=e.element){var o;if(!s)return;const i=(o=e.options.x)!==null&&o!==void 0?o:0;(e.options.anchor||"left")==="right"?s.style.right=i?i*this._renderService.dimensions.css.cell.width+"px":"":s.style.left=i?i*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(e){var s;(s=this._decorationElements.get(e))===null||s===void 0||s.remove(),this._decorationElements.delete(e),e.dispose()}};d=h([c(1,v.IBufferService),c(2,v.IDecorationService),c(3,a.IRenderService)],d),t.BufferDecorationRenderer=d},5871:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorZoneStore=void 0,t.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(r){if(r.options.overviewRulerOptions){for(const h of this._zones)if(h.color===r.options.overviewRulerOptions.color&&h.position===r.options.overviewRulerOptions.position){if(this._lineIntersectsZone(h,r.marker.line))return;if(this._lineAdjacentToZone(h,r.marker.line,r.options.overviewRulerOptions.position))return void this._addLineToZone(h,r.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=r.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=r.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=r.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=r.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:r.options.overviewRulerOptions.color,position:r.options.overviewRulerOptions.position,startBufferLine:r.marker.line,endBufferLine:r.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(r){this._linePadding=r}_lineIntersectsZone(r,h){return h>=r.startBufferLine&&h<=r.endBufferLine}_lineAdjacentToZone(r,h,c){return h>=r.startBufferLine-this._linePadding[c||"full"]&&h<=r.endBufferLine+this._linePadding[c||"full"]}_addLineToZone(r,h){r.startBufferLine=Math.min(r.startBufferLine,h),r.endBufferLine=Math.max(r.endBufferLine,h)}}},5744:function(L,t,r){var h=this&&this.__decorate||function(n,f,p,C){var l,g=arguments.length,w=g<3?f:C===null?C=Object.getOwnPropertyDescriptor(f,p):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(n,f,p,C);else for(var k=n.length-1;k>=0;k--)(l=n[k])&&(w=(g<3?l(w):g>3?l(f,p,w):l(f,p))||w);return g>3&&w&&Object.defineProperty(f,p,w),w},c=this&&this.__param||function(n,f){return function(p,C){f(p,C,n)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OverviewRulerRenderer=void 0;const _=r(5871),a=r(3656),u=r(4725),v=r(844),d=r(2585),e={full:0,left:0,center:0,right:0},s={full:0,left:0,center:0,right:0},o={full:0,left:0,center:0,right:0};let i=class extends v.Disposable{constructor(n,f,p,C,l,g,w){var k;super(),this._viewportElement=n,this._screenElement=f,this._bufferService=p,this._decorationService=C,this._renderService=l,this._optionsService=g,this._coreBrowseService=w,this._colorZoneStore=new _.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=document.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(k=this._viewportElement.parentElement)===null||k===void 0||k.insertBefore(this._canvas,this._viewportElement);const R=this._canvas.getContext("2d");if(!R)throw new Error("Ctx cannot be null");this._ctx=R,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,v.toDisposable)(()=>{var O;(O=this._canvas)===null||O===void 0||O.remove()}))}get _width(){return this._optionsService.options.overviewRulerWidth||0}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register((0,a.addDisposableDomListener)(this._coreBrowseService.window,"resize",()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const n=Math.floor(this._canvas.width/3),f=Math.ceil(this._canvas.width/3);s.full=this._canvas.width,s.left=n,s.center=f,s.right=n,this._refreshDrawHeightConstants(),o.full=0,o.left=0,o.center=s.left,o.right=s.left+s.center}_refreshDrawHeightConstants(){e.full=Math.round(2*this._coreBrowseService.dpr);const n=this._canvas.height/this._bufferService.buffer.lines.length,f=Math.round(Math.max(Math.min(n,12),6)*this._coreBrowseService.dpr);e.left=f,e.center=f,e.right=f}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*e.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*e.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*e.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*e.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowseService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowseService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const f of this._decorationService.decorations)this._colorZoneStore.addDecoration(f);this._ctx.lineWidth=1;const n=this._colorZoneStore.zones;for(const f of n)f.position!=="full"&&this._renderColorZone(f);for(const f of n)f.position==="full"&&this._renderColorZone(f);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(n){this._ctx.fillStyle=n.color,this._ctx.fillRect(o[n.position||"full"],Math.round((this._canvas.height-1)*(n.startBufferLine/this._bufferService.buffers.active.lines.length)-e[n.position||"full"]/2),s[n.position||"full"],Math.round((this._canvas.height-1)*((n.endBufferLine-n.startBufferLine)/this._bufferService.buffers.active.lines.length)+e[n.position||"full"]))}_queueRefresh(n,f){this._shouldUpdateDimensions=n||this._shouldUpdateDimensions,this._shouldUpdateAnchor=f||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowseService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};i=h([c(2,d.IBufferService),c(3,d.IDecorationService),c(4,u.IRenderService),c(5,d.IOptionsService),c(6,u.ICoreBrowserService)],i),t.OverviewRulerRenderer=i},2950:function(L,t,r){var h=this&&this.__decorate||function(d,e,s,o){var i,n=arguments.length,f=n<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(d,e,s,o);else for(var p=d.length-1;p>=0;p--)(i=d[p])&&(f=(n<3?i(f):n>3?i(e,s,f):i(e,s))||f);return n>3&&f&&Object.defineProperty(e,s,f),f},c=this&&this.__param||function(d,e){return function(s,o){e(s,o,d)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CompositionHelper=void 0;const _=r(4725),a=r(2585),u=r(2584);let v=class{constructor(d,e,s,o,i,n){this._textarea=d,this._compositionView=e,this._bufferService=s,this._optionsService=o,this._coreService=i,this._renderService=n,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}get isComposing(){return this._isComposing}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(d){this._compositionView.textContent=d.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(d){if(this._isComposing||this._isSendingComposition){if(d.keyCode===229||d.keyCode===16||d.keyCode===17||d.keyCode===18)return!1;this._finalizeComposition(!1)}return d.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(d){if(this._compositionView.classList.remove("active"),this._isComposing=!1,d){const e={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let s;this._isSendingComposition=!1,e.start+=this._dataAlreadySent.length,s=this._isComposing?this._textarea.value.substring(e.start,e.end):this._textarea.value.substring(e.start),s.length>0&&this._coreService.triggerDataEvent(s,!0)}},0)}else{this._isSendingComposition=!1;const e=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(e,!0)}}_handleAnyTextareaChanges(){const d=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const e=this._textarea.value,s=e.replace(d,"");this._dataAlreadySent=s,e.length>d.length?this._coreService.triggerDataEvent(s,!0):e.length<d.length?this._coreService.triggerDataEvent(`${u.C0.DEL}`,!0):e.length===d.length&&e!==d&&this._coreService.triggerDataEvent(e,!0)}},0)}updateCompositionElements(d){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const e=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),s=this._renderService.dimensions.css.cell.height,o=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,i=e*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=i+"px",this._compositionView.style.top=o+"px",this._compositionView.style.height=s+"px",this._compositionView.style.lineHeight=s+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const n=this._compositionView.getBoundingClientRect();this._textarea.style.left=i+"px",this._textarea.style.top=o+"px",this._textarea.style.width=Math.max(n.width,1)+"px",this._textarea.style.height=Math.max(n.height,1)+"px",this._textarea.style.lineHeight=n.height+"px"}d||setTimeout(()=>this.updateCompositionElements(!0),0)}}};v=h([c(2,a.IBufferService),c(3,a.IOptionsService),c(4,a.ICoreService),c(5,_.IRenderService)],v),t.CompositionHelper=v},9806:(L,t)=>{function r(h,c,_){const a=_.getBoundingClientRect(),u=h.getComputedStyle(_),v=parseInt(u.getPropertyValue("padding-left")),d=parseInt(u.getPropertyValue("padding-top"));return[c.clientX-a.left-v,c.clientY-a.top-d]}Object.defineProperty(t,"__esModule",{value:!0}),t.getCoords=t.getCoordsRelativeToElement=void 0,t.getCoordsRelativeToElement=r,t.getCoords=function(h,c,_,a,u,v,d,e,s){if(!v)return;const o=r(h,c,_);return o?(o[0]=Math.ceil((o[0]+(s?d/2:0))/d),o[1]=Math.ceil(o[1]/e),o[0]=Math.min(Math.max(o[0],1),a+(s?1:0)),o[1]=Math.min(Math.max(o[1],1),u),o):void 0}},9504:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.moveToCellSequence=void 0;const h=r(2584);function c(e,s,o,i){const n=e-_(e,o),f=s-_(s,o),p=Math.abs(n-f)-function(C,l,g){let w=0;const k=C-_(C,g),R=l-_(l,g);for(let O=0;O<Math.abs(k-R);O++){const H=a(C,l)==="A"?-1:1,W=g.buffer.lines.get(k+H*O);W?.isWrapped&&w++}return w}(e,s,o);return d(p,v(a(e,s),i))}function _(e,s){let o=0,i=s.buffer.lines.get(e),n=i?.isWrapped;for(;n&&e>=0&&e<s.rows;)o++,i=s.buffer.lines.get(--e),n=i?.isWrapped;return o}function a(e,s){return e>s?"A":"B"}function u(e,s,o,i,n,f){let p=e,C=s,l="";for(;p!==o||C!==i;)p+=n?1:-1,n&&p>f.cols-1?(l+=f.buffer.translateBufferLineToString(C,!1,e,p),p=0,e=0,C++):!n&&p<0&&(l+=f.buffer.translateBufferLineToString(C,!1,0,e+1),p=f.cols-1,e=p,C--);return l+f.buffer.translateBufferLineToString(C,!1,e,p)}function v(e,s){const o=s?"O":"[";return h.C0.ESC+o+e}function d(e,s){e=Math.floor(e);let o="";for(let i=0;i<e;i++)o+=s;return o}t.moveToCellSequence=function(e,s,o,i){const n=o.buffer.x,f=o.buffer.y;if(!o.buffer.hasScrollback)return function(l,g,w,k,R,O){return c(g,k,R,O).length===0?"":d(u(l,g,l,g-_(g,R),!1,R).length,v("D",O))}(n,f,0,s,o,i)+c(f,s,o,i)+function(l,g,w,k,R,O){let H;H=c(g,k,R,O).length>0?k-_(k,R):g;const W=k,j=function(S,E,D,x,U,V){let q;return q=c(D,x,U,V).length>0?x-_(x,U):E,S<D&&q<=x||S>=D&&q<x?"C":"D"}(l,g,w,k,R,O);return d(u(l,H,w,W,j==="C",R).length,v(j,O))}(n,f,e,s,o,i);let p;if(f===s)return p=n>e?"D":"C",d(Math.abs(n-e),v(p,i));p=f>s?"D":"C";const C=Math.abs(f-s);return d(function(l,g){return g.cols-l}(f>s?e:n,o)+(C-1)*o.cols+1+((f>s?n:e)-1),v(p,i))}},1296:function(L,t,r){var h=this&&this.__decorate||function(l,g,w,k){var R,O=arguments.length,H=O<3?g:k===null?k=Object.getOwnPropertyDescriptor(g,w):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(l,g,w,k);else for(var W=l.length-1;W>=0;W--)(R=l[W])&&(H=(O<3?R(H):O>3?R(g,w,H):R(g,w))||H);return O>3&&H&&Object.defineProperty(g,w,H),H},c=this&&this.__param||function(l,g){return function(w,k){g(w,k,l)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRenderer=void 0;const _=r(9631),a=r(3787),u=r(2223),v=r(6171),d=r(4725),e=r(8055),s=r(8460),o=r(844),i=r(2585),n="xterm-dom-renderer-owner-",f="xterm-focus";let p=1,C=class extends o.Disposable{constructor(l,g,w,k,R,O,H,W,j,S){super(),this._element=l,this._screenElement=g,this._viewportElement=w,this._linkifier2=k,this._charSizeService=O,this._optionsService=H,this._bufferService=W,this._coreBrowserService=j,this._terminalClass=p++,this._rowElements=[],this._cellToRowElements=[],this.onRequestRedraw=this.register(new s.EventEmitter).event,this._rowContainer=document.createElement("div"),this._rowContainer.classList.add("xterm-rows"),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=document.createElement("div"),this._selectionContainer.classList.add("xterm-selection"),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,v.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(S.onChangeColors(E=>this._injectCss(E))),this._injectCss(S.colors),this._rowFactory=R.createInstance(a.DomRendererRowFactory,document),this._element.classList.add(n+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(E=>this._handleLinkHover(E))),this.register(this._linkifier2.onHideLinkUnderline(E=>this._handleLinkLeave(E))),this.register((0,o.toDisposable)(()=>{this._element.classList.remove(n+this._terminalClass),(0,_.removeElementFromParent)(this._rowContainer,this._selectionContainer,this._themeStyleElement,this._dimensionsStyleElement)}))}_updateDimensions(){const l=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*l,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*l),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/l),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/l),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const w of this._rowElements)w.style.width=`${this.dimensions.css.canvas.width}px`,w.style.height=`${this.dimensions.css.cell.height}px`,w.style.lineHeight=`${this.dimensions.css.cell.height}px`,w.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const g=`${this._terminalSelector} .xterm-rows span { display: inline-block; height: 100%; vertical-align: top; width: ${this.dimensions.css.cell.width}px}`;this._dimensionsStyleElement.textContent=g,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(l){this._themeStyleElement||(this._themeStyleElement=document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let g=`${this._terminalSelector} .xterm-rows { color: ${l.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px;}`;g+=`${this._terminalSelector} span:not(.${a.BOLD_CLASS}) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.${a.BOLD_CLASS} { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.${a.ITALIC_CLASS} { font-style: italic;}`,g+="@keyframes blink_box_shadow_"+this._terminalClass+" { 50% {  box-shadow: none; }}",g+="@keyframes blink_block_"+this._terminalClass+` { 0% {  background-color: ${l.cursor.css};  color: ${l.cursorAccent.css}; } 50% {  background-color: ${l.cursorAccent.css};  color: ${l.cursor.css}; }}`,g+=`${this._terminalSelector} .xterm-rows:not(.xterm-focus) .${a.CURSOR_CLASS}.${a.CURSOR_STYLE_BLOCK_CLASS} { outline: 1px solid ${l.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .xterm-rows.xterm-focus .${a.CURSOR_CLASS}.${a.CURSOR_BLINK_CLASS}:not(.${a.CURSOR_STYLE_BLOCK_CLASS}) { animation: blink_box_shadow_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${a.CURSOR_CLASS}.${a.CURSOR_BLINK_CLASS}.${a.CURSOR_STYLE_BLOCK_CLASS} { animation: blink_block_`+this._terminalClass+` 1s step-end infinite;}${this._terminalSelector} .xterm-rows.xterm-focus .${a.CURSOR_CLASS}.${a.CURSOR_STYLE_BLOCK_CLASS} { background-color: ${l.cursor.css}; color: ${l.cursorAccent.css};}${this._terminalSelector} .xterm-rows .${a.CURSOR_CLASS}.${a.CURSOR_STYLE_BAR_CLASS} { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${l.cursor.css} inset;}${this._terminalSelector} .xterm-rows .${a.CURSOR_CLASS}.${a.CURSOR_STYLE_UNDERLINE_CLASS} { box-shadow: 0 -1px 0 ${l.cursor.css} inset;}`,g+=`${this._terminalSelector} .xterm-selection { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .xterm-selection div { position: absolute; background-color: ${l.selectionBackgroundOpaque.css};}${this._terminalSelector} .xterm-selection div { position: absolute; background-color: ${l.selectionInactiveBackgroundOpaque.css};}`;for(const[w,k]of l.ansi.entries())g+=`${this._terminalSelector} .xterm-fg-${w} { color: ${k.css}; }${this._terminalSelector} .xterm-bg-${w} { background-color: ${k.css}; }`;g+=`${this._terminalSelector} .xterm-fg-${u.INVERTED_DEFAULT_COLOR} { color: ${e.color.opaque(l.background).css}; }${this._terminalSelector} .xterm-bg-${u.INVERTED_DEFAULT_COLOR} { background-color: ${l.foreground.css}; }`,this._themeStyleElement.textContent=g}handleDevicePixelRatioChange(){this._updateDimensions()}_refreshRowElements(l,g){for(let w=this._rowElements.length;w<=g;w++){const k=document.createElement("div");this._rowContainer.appendChild(k),this._rowElements.push(k)}for(;this._rowElements.length>g;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(l,g){this._refreshRowElements(l,g),this._updateDimensions()}handleCharSizeChanged(){this._updateDimensions()}handleBlur(){this._rowContainer.classList.remove(f)}handleFocus(){this._rowContainer.classList.add(f)}handleSelectionChanged(l,g,w){for(;this._selectionContainer.children.length;)this._selectionContainer.removeChild(this._selectionContainer.children[0]);if(this._rowFactory.handleSelectionChanged(l,g,w),this.renderRows(0,this._bufferService.rows-1),!l||!g)return;const k=l[1]-this._bufferService.buffer.ydisp,R=g[1]-this._bufferService.buffer.ydisp,O=Math.max(k,0),H=Math.min(R,this._bufferService.rows-1);if(O>=this._bufferService.rows||H<0)return;const W=document.createDocumentFragment();if(w){const j=l[0]>g[0];W.appendChild(this._createSelectionElement(O,j?g[0]:l[0],j?l[0]:g[0],H-O+1))}else{const j=k===O?l[0]:0,S=O===R?g[0]:this._bufferService.cols;W.appendChild(this._createSelectionElement(O,j,S));const E=H-O-1;if(W.appendChild(this._createSelectionElement(O+1,0,this._bufferService.cols,E)),O!==H){const D=R===H?g[0]:this._bufferService.cols;W.appendChild(this._createSelectionElement(H,0,D))}}this._selectionContainer.appendChild(W)}_createSelectionElement(l,g,w,k=1){const R=document.createElement("div");return R.style.height=k*this.dimensions.css.cell.height+"px",R.style.top=l*this.dimensions.css.cell.height+"px",R.style.left=g*this.dimensions.css.cell.width+"px",R.style.width=this.dimensions.css.cell.width*(w-g)+"px",R}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions()}clear(){for(const l of this._rowElements)l.replaceChildren()}renderRows(l,g){const w=this._bufferService.buffer.ybase+this._bufferService.buffer.y,k=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),R=this._optionsService.rawOptions.cursorBlink;for(let O=l;O<=g;O++){const H=this._rowElements[O],W=O+this._bufferService.buffer.ydisp,j=this._bufferService.buffer.lines.get(W),S=this._optionsService.rawOptions.cursorStyle;this._cellToRowElements[O]&&this._cellToRowElements[O].length===this._bufferService.cols||(this._cellToRowElements[O]=new Int16Array(this._bufferService.cols)),H.replaceChildren(this._rowFactory.createRow(j,W,W===w,S,k,R,this.dimensions.css.cell.width,this._bufferService.cols,this._cellToRowElements[O]))}}get _terminalSelector(){return`.${n}${this._terminalClass}`}_handleLinkHover(l){this._setCellUnderline(l.x1,l.x2,l.y1,l.y2,l.cols,!0)}_handleLinkLeave(l){this._setCellUnderline(l.x1,l.x2,l.y1,l.y2,l.cols,!1)}_setCellUnderline(l,g,w,k,R,O){if(l=this._cellToRowElements[w][l],g=this._cellToRowElements[k][g],l!==-1&&g!==-1)for(;l!==g||w!==k;){const H=this._rowElements[w];if(!H)return;const W=H.children[l];W&&(W.style.textDecoration=O?"underline":"none"),++l>=R&&(l=0,w++)}}};C=h([c(4,i.IInstantiationService),c(5,d.ICharSizeService),c(6,i.IOptionsService),c(7,i.IBufferService),c(8,d.ICoreBrowserService),c(9,d.IThemeService)],C),t.DomRenderer=C},3787:function(L,t,r){var h=this&&this.__decorate||function(p,C,l,g){var w,k=arguments.length,R=k<3?C:g===null?g=Object.getOwnPropertyDescriptor(C,l):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(p,C,l,g);else for(var O=p.length-1;O>=0;O--)(w=p[O])&&(R=(k<3?w(R):k>3?w(C,l,R):w(C,l))||R);return k>3&&R&&Object.defineProperty(C,l,R),R},c=this&&this.__param||function(p,C){return function(l,g){C(l,g,p)}};Object.defineProperty(t,"__esModule",{value:!0}),t.DomRendererRowFactory=t.CURSOR_STYLE_UNDERLINE_CLASS=t.CURSOR_STYLE_BAR_CLASS=t.CURSOR_STYLE_BLOCK_CLASS=t.CURSOR_BLINK_CLASS=t.CURSOR_CLASS=t.STRIKETHROUGH_CLASS=t.UNDERLINE_CLASS=t.ITALIC_CLASS=t.DIM_CLASS=t.BOLD_CLASS=void 0;const _=r(2223),a=r(643),u=r(511),v=r(2585),d=r(8055),e=r(4725),s=r(4269),o=r(6171),i=r(3734);t.BOLD_CLASS="xterm-bold",t.DIM_CLASS="xterm-dim",t.ITALIC_CLASS="xterm-italic",t.UNDERLINE_CLASS="xterm-underline",t.STRIKETHROUGH_CLASS="xterm-strikethrough",t.CURSOR_CLASS="xterm-cursor",t.CURSOR_BLINK_CLASS="xterm-cursor-blink",t.CURSOR_STYLE_BLOCK_CLASS="xterm-cursor-block",t.CURSOR_STYLE_BAR_CLASS="xterm-cursor-bar",t.CURSOR_STYLE_UNDERLINE_CLASS="xterm-cursor-underline";let n=class{constructor(p,C,l,g,w,k,R){this._document=p,this._characterJoinerService=C,this._optionsService=l,this._coreBrowserService=g,this._coreService=w,this._decorationService=k,this._themeService=R,this._workCell=new u.CellData,this._columnSelectMode=!1}handleSelectionChanged(p,C,l){this._selectionStart=p,this._selectionEnd=C,this._columnSelectMode=l}createRow(p,C,l,g,w,k,R,O,H){const W=this._document.createDocumentFragment(),j=this._characterJoinerService.getJoinedCharacters(C);let S=0;for(let U=Math.min(p.length,O)-1;U>=0;U--)if(p.loadCell(U,this._workCell).getCode()!==a.NULL_CELL_CODE||l&&U===w){S=U+1;break}const E=this._themeService.colors;let D=-1,x=0;for(;x<S;x++){p.loadCell(x,this._workCell);let U=this._workCell.getWidth();if(U===0){H[x]=D;continue}let V=!1,q=x,N=this._workCell;if(j.length>0&&x===j[0][0]){V=!0;const G=j.shift();N=new s.JoinedCellData(this._workCell,p.translateToString(!0,G[0],G[1]),G[1]-G[0]),q=G[1]-1,U=N.getWidth()}const z=this._document.createElement("span");if(U>1&&(z.style.width=R*U+"px"),V&&(z.style.display="inline",w>=x&&w<=q&&(w=x)),!this._coreService.isCursorHidden&&l&&x===w)switch(z.classList.add(t.CURSOR_CLASS),k&&z.classList.add(t.CURSOR_BLINK_CLASS),g){case"bar":z.classList.add(t.CURSOR_STYLE_BAR_CLASS);break;case"underline":z.classList.add(t.CURSOR_STYLE_UNDERLINE_CLASS);break;default:z.classList.add(t.CURSOR_STYLE_BLOCK_CLASS)}if(N.isBold()&&z.classList.add(t.BOLD_CLASS),N.isItalic()&&z.classList.add(t.ITALIC_CLASS),N.isDim()&&z.classList.add(t.DIM_CLASS),N.isInvisible()?z.textContent=a.WHITESPACE_CELL_CHAR:z.textContent=N.getChars()||a.WHITESPACE_CELL_CHAR,N.isUnderline()&&(z.classList.add(`${t.UNDERLINE_CLASS}-${N.extended.underlineStyle}`),z.textContent===" "&&(z.textContent=" "),!N.isUnderlineColorDefault()))if(N.isUnderlineColorRGB())z.style.textDecorationColor=`rgb(${i.AttributeData.toColorRGB(N.getUnderlineColor()).join(",")})`;else{let G=N.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&N.isBold()&&G<8&&(G+=8),z.style.textDecorationColor=E.ansi[G].css}N.isStrikethrough()&&z.classList.add(t.STRIKETHROUGH_CLASS);let B=N.getFgColor(),A=N.getFgColorMode(),P=N.getBgColor(),F=N.getBgColorMode();const $=!!N.isInverse();if($){const G=B;B=P,P=G;const ft=A;A=F,F=ft}let Y,K,Q=!1;this._decorationService.forEachDecorationAtCell(x,C,void 0,G=>{G.options.layer!=="top"&&Q||(G.backgroundColorRGB&&(F=50331648,P=G.backgroundColorRGB.rgba>>8&16777215,Y=G.backgroundColorRGB),G.foregroundColorRGB&&(A=50331648,B=G.foregroundColorRGB.rgba>>8&16777215,K=G.foregroundColorRGB),Q=G.options.layer==="top")});const te=this._isCellInSelection(x,C);let ee;switch(Q||E.selectionForeground&&te&&(A=50331648,B=E.selectionForeground.rgba>>8&16777215,K=E.selectionForeground),te&&(Y=this._coreBrowserService.isFocused?E.selectionBackgroundOpaque:E.selectionInactiveBackgroundOpaque,Q=!0),Q&&z.classList.add("xterm-decoration-top"),F){case 16777216:case 33554432:ee=E.ansi[P],z.classList.add(`xterm-bg-${P}`);break;case 50331648:ee=d.rgba.toColor(P>>16,P>>8&255,255&P),this._addStyle(z,`background-color:#${f((P>>>0).toString(16),"0",6)}`);break;default:$?(ee=E.foreground,z.classList.add(`xterm-bg-${_.INVERTED_DEFAULT_COLOR}`)):ee=E.background}switch(Y||N.isDim()&&(Y=d.color.multiplyOpacity(ee,.5)),A){case 16777216:case 33554432:N.isBold()&&B<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(B+=8),this._applyMinimumContrast(z,ee,E.ansi[B],N,Y,void 0)||z.classList.add(`xterm-fg-${B}`);break;case 50331648:const G=d.rgba.toColor(B>>16&255,B>>8&255,255&B);this._applyMinimumContrast(z,ee,G,N,Y,K)||this._addStyle(z,`color:#${f(B.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(z,ee,E.foreground,N,Y,void 0)||$&&z.classList.add(`xterm-fg-${_.INVERTED_DEFAULT_COLOR}`)}W.appendChild(z),H[x]=++D,x=q}return x<O-1&&H.subarray(x).fill(++D),W}_applyMinimumContrast(p,C,l,g,w,k){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,o.excludeFromContrastRatioDemands)(g.getCode()))return!1;let R;return w||k||(R=this._themeService.colors.contrastCache.getColor(C.rgba,l.rgba)),R===void 0&&(R=d.color.ensureContrastRatio(w||C,k||l,this._optionsService.rawOptions.minimumContrastRatio),this._themeService.colors.contrastCache.setColor((w||C).rgba,(k||l).rgba,R??null)),!!R&&(this._addStyle(p,`color:${R.css}`),!0)}_addStyle(p,C){p.setAttribute("style",`${p.getAttribute("style")||""}${C};`)}_isCellInSelection(p,C){const l=this._selectionStart,g=this._selectionEnd;return!(!l||!g)&&(this._columnSelectMode?l[0]<=g[0]?p>=l[0]&&C>=l[1]&&p<g[0]&&C<=g[1]:p<l[0]&&C>=l[1]&&p>=g[0]&&C<=g[1]:C>l[1]&&C<g[1]||l[1]===g[1]&&C===l[1]&&p>=l[0]&&p<g[0]||l[1]<g[1]&&C===g[1]&&p<g[0]||l[1]<g[1]&&C===l[1]&&p>=l[0])}};function f(p,C,l){for(;p.length<l;)p=C+p;return p}n=h([c(1,e.ICharacterJoinerService),c(2,v.IOptionsService),c(3,e.ICoreBrowserService),c(4,v.ICoreService),c(5,v.IDecorationService),c(6,e.IThemeService)],n),t.DomRendererRowFactory=n},2223:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TEXT_BASELINE=t.DIM_OPACITY=t.INVERTED_DEFAULT_COLOR=void 0;const h=r(6114);t.INVERTED_DEFAULT_COLOR=257,t.DIM_OPACITY=.5,t.TEXT_BASELINE=h.isFirefox||h.isLegacyEdge?"bottom":"ideographic"},6171:(L,t)=>{function r(h){return 57508<=h&&h<=57558}Object.defineProperty(t,"__esModule",{value:!0}),t.createRenderDimensions=t.excludeFromContrastRatioDemands=t.isRestrictedPowerlineGlyph=t.isPowerlineGlyph=t.throwIfFalsy=void 0,t.throwIfFalsy=function(h){if(!h)throw new Error("value must not be falsy");return h},t.isPowerlineGlyph=r,t.isRestrictedPowerlineGlyph=function(h){return 57520<=h&&h<=57527},t.excludeFromContrastRatioDemands=function(h){return r(h)||function(c){return 9472<=c&&c<=9631}(h)},t.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}}},456:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionModel=void 0,t.SelectionModel=class{constructor(r){this._bufferService=r,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const r=this.selectionStart[0]+this.selectionStartLength;return r>this._bufferService.cols?r%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(r/this._bufferService.cols)-1]:[r%this._bufferService.cols,this.selectionStart[1]+Math.floor(r/this._bufferService.cols)]:[r,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const r=this.selectionStart[0]+this.selectionStartLength;return r>this._bufferService.cols?[r%this._bufferService.cols,this.selectionStart[1]+Math.floor(r/this._bufferService.cols)]:[Math.max(r,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const r=this.selectionStart,h=this.selectionEnd;return!(!r||!h)&&(r[1]>h[1]||r[1]===h[1]&&r[0]>h[0])}handleTrim(r){return this.selectionStart&&(this.selectionStart[1]-=r),this.selectionEnd&&(this.selectionEnd[1]-=r),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(L,t,r){var h=this&&this.__decorate||function(e,s,o,i){var n,f=arguments.length,p=f<3?s:i===null?i=Object.getOwnPropertyDescriptor(s,o):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(e,s,o,i);else for(var C=e.length-1;C>=0;C--)(n=e[C])&&(p=(f<3?n(p):f>3?n(s,o,p):n(s,o))||p);return f>3&&p&&Object.defineProperty(s,o,p),p},c=this&&this.__param||function(e,s){return function(o,i){s(o,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharSizeService=void 0;const _=r(2585),a=r(8460),u=r(844);let v=class extends u.Disposable{constructor(e,s,o){super(),this._optionsService=o,this.width=0,this.height=0,this._onCharSizeChange=this.register(new a.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event,this._measureStrategy=new d(e,s,this._optionsService),this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}get hasValidSize(){return this.width>0&&this.height>0}measure(){const e=this._measureStrategy.measure();e.width===this.width&&e.height===this.height||(this.width=e.width,this.height=e.height,this._onCharSizeChange.fire())}};v=h([c(2,_.IOptionsService)],v),t.CharSizeService=v;class d{constructor(s,o,i){this._document=s,this._parentElement=o,this._optionsService=i,this._result={width:0,height:0},this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W",this._measureElement.setAttribute("aria-hidden","true"),this._parentElement.appendChild(this._measureElement)}measure(){this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`;const s=this._measureElement.getBoundingClientRect();return s.width!==0&&s.height!==0&&(this._result.width=s.width,this._result.height=Math.ceil(s.height)),this._result}}},4269:function(L,t,r){var h=this&&this.__decorate||function(s,o,i,n){var f,p=arguments.length,C=p<3?o:n===null?n=Object.getOwnPropertyDescriptor(o,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(s,o,i,n);else for(var l=s.length-1;l>=0;l--)(f=s[l])&&(C=(p<3?f(C):p>3?f(o,i,C):f(o,i))||C);return p>3&&C&&Object.defineProperty(o,i,C),C},c=this&&this.__param||function(s,o){return function(i,n){o(i,n,s)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CharacterJoinerService=t.JoinedCellData=void 0;const _=r(3734),a=r(643),u=r(511),v=r(2585);class d extends _.AttributeData{constructor(o,i,n){super(),this.content=0,this.combinedData="",this.fg=o.fg,this.bg=o.bg,this.combinedData=i,this._width=n}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(o){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.JoinedCellData=d;let e=class lt{constructor(o){this._bufferService=o,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new u.CellData}register(o){const i={id:this._nextCharacterJoinerId++,handler:o};return this._characterJoiners.push(i),i.id}deregister(o){for(let i=0;i<this._characterJoiners.length;i++)if(this._characterJoiners[i].id===o)return this._characterJoiners.splice(i,1),!0;return!1}getJoinedCharacters(o){if(this._characterJoiners.length===0)return[];const i=this._bufferService.buffer.lines.get(o);if(!i||i.length===0)return[];const n=[],f=i.translateToString(!0);let p=0,C=0,l=0,g=i.getFg(0),w=i.getBg(0);for(let k=0;k<i.getTrimmedLength();k++)if(i.loadCell(k,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==g||this._workCell.bg!==w){if(k-p>1){const R=this._getJoinedRanges(f,l,C,i,p);for(let O=0;O<R.length;O++)n.push(R[O])}p=k,l=C,g=this._workCell.fg,w=this._workCell.bg}C+=this._workCell.getChars().length||a.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-p>1){const k=this._getJoinedRanges(f,l,C,i,p);for(let R=0;R<k.length;R++)n.push(k[R])}return n}_getJoinedRanges(o,i,n,f,p){const C=o.substring(i,n);let l=[];try{l=this._characterJoiners[0].handler(C)}catch(g){console.error(g)}for(let g=1;g<this._characterJoiners.length;g++)try{const w=this._characterJoiners[g].handler(C);for(let k=0;k<w.length;k++)lt._mergeRanges(l,w[k])}catch(w){console.error(w)}return this._stringRangesToCellRanges(l,f,p),l}_stringRangesToCellRanges(o,i,n){let f=0,p=!1,C=0,l=o[f];if(l){for(let g=n;g<this._bufferService.cols;g++){const w=i.getWidth(g),k=i.getString(g).length||a.WHITESPACE_CELL_CHAR.length;if(w!==0){if(!p&&l[0]<=C&&(l[0]=g,p=!0),l[1]<=C){if(l[1]=g,l=o[++f],!l)break;l[0]<=C?(l[0]=g,p=!0):p=!1}C+=k}}l&&(l[1]=this._bufferService.cols)}}static _mergeRanges(o,i){let n=!1;for(let f=0;f<o.length;f++){const p=o[f];if(n){if(i[1]<=p[0])return o[f-1][1]=i[1],o;if(i[1]<=p[1])return o[f-1][1]=Math.max(i[1],p[1]),o.splice(f,1),o;o.splice(f,1),f--}else{if(i[1]<=p[0])return o.splice(f,0,i),o;if(i[1]<=p[1])return p[0]=Math.min(i[0],p[0]),o;i[0]<p[1]&&(p[0]=Math.min(i[0],p[0]),n=!0)}}return n?o[o.length-1][1]=i[1]:o.push(i),o}};e=h([c(0,v.IBufferService)],e),t.CharacterJoinerService=e},5114:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreBrowserService=void 0,t.CoreBrowserService=class{constructor(r,h){this._textarea=r,this.window=h,this._isFocused=!1,this._cachedIsFocused=void 0,this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}},8934:function(L,t,r){var h=this&&this.__decorate||function(v,d,e,s){var o,i=arguments.length,n=i<3?d:s===null?s=Object.getOwnPropertyDescriptor(d,e):s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")n=Reflect.decorate(v,d,e,s);else for(var f=v.length-1;f>=0;f--)(o=v[f])&&(n=(i<3?o(n):i>3?o(d,e,n):o(d,e))||n);return i>3&&n&&Object.defineProperty(d,e,n),n},c=this&&this.__param||function(v,d){return function(e,s){d(e,s,v)}};Object.defineProperty(t,"__esModule",{value:!0}),t.MouseService=void 0;const _=r(4725),a=r(9806);let u=class{constructor(v,d){this._renderService=v,this._charSizeService=d}getCoords(v,d,e,s,o){return(0,a.getCoords)(window,v,d,e,s,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,o)}getMouseReportCoords(v,d){const e=(0,a.getCoordsRelativeToElement)(window,v,d);if(!(!this._charSizeService.hasValidSize||e[0]<0||e[1]<0||e[0]>=this._renderService.dimensions.css.canvas.width||e[1]>=this._renderService.dimensions.css.canvas.height))return{col:Math.floor(e[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(e[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(e[0]),y:Math.floor(e[1])}}};u=h([c(0,_.IRenderService),c(1,_.ICharSizeService)],u),t.MouseService=u},3230:function(L,t,r){var h=this&&this.__decorate||function(n,f,p,C){var l,g=arguments.length,w=g<3?f:C===null?C=Object.getOwnPropertyDescriptor(f,p):C;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(n,f,p,C);else for(var k=n.length-1;k>=0;k--)(l=n[k])&&(w=(g<3?l(w):g>3?l(f,p,w):l(f,p))||w);return g>3&&w&&Object.defineProperty(f,p,w),w},c=this&&this.__param||function(n,f){return function(p,C){f(p,C,n)}};Object.defineProperty(t,"__esModule",{value:!0}),t.RenderService=void 0;const _=r(6193),a=r(8460),u=r(844),v=r(5596),d=r(3656),e=r(2585),s=r(4725),o=r(7226);let i=class extends u.Disposable{constructor(n,f,p,C,l,g,w,k){if(super(),this._rowCount=n,this._charSizeService=C,this._pausedResizeTask=new o.DebouncedIdleTask,this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new a.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new a.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new a.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new a.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this.register({dispose:()=>{var R;return(R=this._renderer)===null||R===void 0?void 0:R.dispose()}}),this._renderDebouncer=new _.RenderDebouncer(w.window,(R,O)=>this._renderRows(R,O)),this.register(this._renderDebouncer),this._screenDprMonitor=new v.ScreenDprMonitor(w.window),this._screenDprMonitor.setListener(()=>this.handleDevicePixelRatioChange()),this.register(this._screenDprMonitor),this.register(g.onResize(()=>this._fullRefresh())),this.register(g.buffers.onBufferActivate(()=>{var R;return(R=this._renderer)===null||R===void 0?void 0:R.clear()})),this.register(p.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(l.onDecorationRegistered(()=>this._fullRefresh())),this.register(l.onDecorationRemoved(()=>this._fullRefresh())),this.register(p.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio"],()=>{this.clear(),this.handleResize(g.cols,g.rows),this._fullRefresh()})),this.register(p.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(g.buffer.y,g.buffer.y,!0))),this.register((0,d.addDisposableDomListener)(w.window,"resize",()=>this.handleDevicePixelRatioChange())),this.register(k.onChangeColors(()=>this._fullRefresh())),"IntersectionObserver"in w.window){const R=new w.window.IntersectionObserver(O=>this._handleIntersectionChange(O[O.length-1]),{threshold:0});R.observe(f),this.register({dispose:()=>R.disconnect()})}}get dimensions(){return this._renderer.dimensions}_handleIntersectionChange(n){this._isPaused=n.isIntersecting===void 0?n.intersectionRatio===0:!n.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(n,f,p=!1){this._isPaused?this._needsFullRefresh=!0:(p||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(n,f,this._rowCount))}_renderRows(n,f){this._renderer&&(this._renderer.renderRows(n,f),this._needsSelectionRefresh&&(this._renderer.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:n,end:f}),this._onRender.fire({start:n,end:f}),this._isNextRenderRedrawOnly=!0)}resize(n,f){this._rowCount=f,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer&&(this._renderer.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.dimensions))}hasRenderer(){return!!this._renderer}setRenderer(n){var f;(f=this._renderer)===null||f===void 0||f.dispose(),this._renderer=n,this._renderer.onRequestRedraw(p=>this.refreshRows(p.start,p.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh()}addRefreshCallback(n){return this._renderDebouncer.addRefreshCallback(n)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var n,f;this._renderer&&((f=(n=this._renderer).clearTextureAtlas)===null||f===void 0||f.call(n),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer&&(this._renderer.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(n,f){this._renderer&&(this._isPaused?this._pausedResizeTask.set(()=>this._renderer.handleResize(n,f)):this._renderer.handleResize(n,f),this._fullRefresh())}handleCharSizeChanged(){var n;(n=this._renderer)===null||n===void 0||n.handleCharSizeChanged()}handleBlur(){var n;(n=this._renderer)===null||n===void 0||n.handleBlur()}handleFocus(){var n;(n=this._renderer)===null||n===void 0||n.handleFocus()}handleSelectionChanged(n,f,p){var C;this._selectionState.start=n,this._selectionState.end=f,this._selectionState.columnSelectMode=p,(C=this._renderer)===null||C===void 0||C.handleSelectionChanged(n,f,p)}handleCursorMove(){var n;(n=this._renderer)===null||n===void 0||n.handleCursorMove()}clear(){var n;(n=this._renderer)===null||n===void 0||n.clear()}};i=h([c(2,e.IOptionsService),c(3,s.ICharSizeService),c(4,e.IDecorationService),c(5,e.IBufferService),c(6,s.ICoreBrowserService),c(7,s.IThemeService)],i),t.RenderService=i},9312:function(L,t,r){var h=this&&this.__decorate||function(l,g,w,k){var R,O=arguments.length,H=O<3?g:k===null?k=Object.getOwnPropertyDescriptor(g,w):k;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")H=Reflect.decorate(l,g,w,k);else for(var W=l.length-1;W>=0;W--)(R=l[W])&&(H=(O<3?R(H):O>3?R(g,w,H):R(g,w))||H);return O>3&&H&&Object.defineProperty(g,w,H),H},c=this&&this.__param||function(l,g){return function(w,k){g(w,k,l)}};Object.defineProperty(t,"__esModule",{value:!0}),t.SelectionService=void 0;const _=r(6114),a=r(456),u=r(511),v=r(8460),d=r(4725),e=r(2585),s=r(9806),o=r(9504),i=r(844),n=r(4841),f=String.fromCharCode(160),p=new RegExp(f,"g");let C=class extends i.Disposable{constructor(l,g,w,k,R,O,H,W,j){super(),this._element=l,this._screenElement=g,this._linkifier=w,this._bufferService=k,this._coreService=R,this._mouseService=O,this._optionsService=H,this._renderService=W,this._coreBrowserService=j,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new u.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new v.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new v.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new v.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new v.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=S=>this._handleMouseMove(S),this._mouseUpListener=S=>this._handleMouseUp(S),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(S=>this._handleTrim(S)),this.register(this._bufferService.buffers.onBufferActivate(S=>this._handleBufferActivate(S))),this.enable(),this._model=new a.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,i.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const l=this._model.finalSelectionStart,g=this._model.finalSelectionEnd;return!(!l||!g||l[0]===g[0]&&l[1]===g[1])}get selectionText(){const l=this._model.finalSelectionStart,g=this._model.finalSelectionEnd;if(!l||!g)return"";const w=this._bufferService.buffer,k=[];if(this._activeSelectionMode===3){if(l[0]===g[0])return"";const R=l[0]<g[0]?l[0]:g[0],O=l[0]<g[0]?g[0]:l[0];for(let H=l[1];H<=g[1];H++){const W=w.translateBufferLineToString(H,!0,R,O);k.push(W)}}else{const R=l[1]===g[1]?g[0]:void 0;k.push(w.translateBufferLineToString(l[1],!0,l[0],R));for(let O=l[1]+1;O<=g[1]-1;O++){const H=w.lines.get(O),W=w.translateBufferLineToString(O,!0);H?.isWrapped?k[k.length-1]+=W:k.push(W)}if(l[1]!==g[1]){const O=w.lines.get(g[1]),H=w.translateBufferLineToString(g[1],!0,0,g[0]);O&&O.isWrapped?k[k.length-1]+=H:k.push(H)}}return k.map(R=>R.replace(p," ")).join(_.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(l){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),_.isLinux&&l&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(l){const g=this._getMouseBufferCoords(l),w=this._model.finalSelectionStart,k=this._model.finalSelectionEnd;return!!(w&&k&&g)&&this._areCoordsInSelection(g,w,k)}isCellInSelection(l,g){const w=this._model.finalSelectionStart,k=this._model.finalSelectionEnd;return!(!w||!k)&&this._areCoordsInSelection([l,g],w,k)}_areCoordsInSelection(l,g,w){return l[1]>g[1]&&l[1]<w[1]||g[1]===w[1]&&l[1]===g[1]&&l[0]>=g[0]&&l[0]<w[0]||g[1]<w[1]&&l[1]===w[1]&&l[0]<w[0]||g[1]<w[1]&&l[1]===g[1]&&l[0]>=g[0]}_selectWordAtCursor(l,g){var w,k;const R=(k=(w=this._linkifier.currentLink)===null||w===void 0?void 0:w.link)===null||k===void 0?void 0:k.range;if(R)return this._model.selectionStart=[R.start.x-1,R.start.y-1],this._model.selectionStartLength=(0,n.getRangeLength)(R,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const O=this._getMouseBufferCoords(l);return!!O&&(this._selectWordAt(O,g),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(l,g){this._model.clearSelection(),l=Math.max(l,0),g=Math.min(g,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,l],this._model.selectionEnd=[this._bufferService.cols,g],this.refresh(),this._onSelectionChange.fire()}_handleTrim(l){this._model.handleTrim(l)&&this.refresh()}_getMouseBufferCoords(l){const g=this._mouseService.getCoords(l,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(g)return g[0]--,g[1]--,g[1]+=this._bufferService.buffer.ydisp,g}_getMouseEventScrollAmount(l){let g=(0,s.getCoordsRelativeToElement)(this._coreBrowserService.window,l,this._screenElement)[1];const w=this._renderService.dimensions.css.canvas.height;return g>=0&&g<=w?0:(g>w&&(g-=w),g=Math.min(Math.max(g,-50),50),g/=50,g/Math.abs(g)+Math.round(14*g))}shouldForceSelection(l){return _.isMac?l.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:l.shiftKey}handleMouseDown(l){if(this._mouseDownTimeStamp=l.timeStamp,(l.button!==2||!this.hasSelection)&&l.button===0){if(!this._enabled){if(!this.shouldForceSelection(l))return;l.stopPropagation()}l.preventDefault(),this._dragScrollAmount=0,this._enabled&&l.shiftKey?this._handleIncrementalClick(l):l.detail===1?this._handleSingleClick(l):l.detail===2?this._handleDoubleClick(l):l.detail===3&&this._handleTripleClick(l),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(l){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(l))}_handleSingleClick(l){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(l)?3:0,this._model.selectionStart=this._getMouseBufferCoords(l),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const g=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);g&&g.length!==this._model.selectionStart[0]&&g.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(l){this._selectWordAtCursor(l,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(l){const g=this._getMouseBufferCoords(l);g&&(this._activeSelectionMode=2,this._selectLineAt(g[1]))}shouldColumnSelect(l){return l.altKey&&!(_.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(l){if(l.stopImmediatePropagation(),!this._model.selectionStart)return;const g=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(l),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(l),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const w=this._bufferService.buffer;if(this._model.selectionEnd[1]<w.lines.length){const k=w.lines.get(this._model.selectionEnd[1]);k&&k.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]++}g&&g[0]===this._model.selectionEnd[0]&&g[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const l=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(l.ydisp+this._bufferService.rows,l.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=l.ydisp),this.refresh()}}_handleMouseUp(l){const g=l.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&g<500&&l.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const w=this._mouseService.getCoords(l,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(w&&w[0]!==void 0&&w[1]!==void 0){const k=(0,o.moveToCellSequence)(w[0]-1,w[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(k,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const l=this._model.finalSelectionStart,g=this._model.finalSelectionEnd,w=!(!l||!g||l[0]===g[0]&&l[1]===g[1]);w?l&&g&&(this._oldSelectionStart&&this._oldSelectionEnd&&l[0]===this._oldSelectionStart[0]&&l[1]===this._oldSelectionStart[1]&&g[0]===this._oldSelectionEnd[0]&&g[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(l,g,w)):this._oldHasSelection&&this._fireOnSelectionChange(l,g,w)}_fireOnSelectionChange(l,g,w){this._oldSelectionStart=l,this._oldSelectionEnd=g,this._oldHasSelection=w,this._onSelectionChange.fire()}_handleBufferActivate(l){this.clearSelection(),this._trimListener.dispose(),this._trimListener=l.activeBuffer.lines.onTrim(g=>this._handleTrim(g))}_convertViewportColToCharacterIndex(l,g){let w=g;for(let k=0;g>=k;k++){const R=l.loadCell(k,this._workCell).getChars().length;this._workCell.getWidth()===0?w--:R>1&&g!==k&&(w+=R-1)}return w}setSelection(l,g,w){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[l,g],this._model.selectionStartLength=w,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(l){this._isClickInSelection(l)||(this._selectWordAtCursor(l,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(l,g,w=!0,k=!0){if(l[0]>=this._bufferService.cols)return;const R=this._bufferService.buffer,O=R.lines.get(l[1]);if(!O)return;const H=R.translateBufferLineToString(l[1],!1);let W=this._convertViewportColToCharacterIndex(O,l[0]),j=W;const S=l[0]-W;let E=0,D=0,x=0,U=0;if(H.charAt(W)===" "){for(;W>0&&H.charAt(W-1)===" ";)W--;for(;j<H.length&&H.charAt(j+1)===" ";)j++}else{let N=l[0],z=l[0];O.getWidth(N)===0&&(E++,N--),O.getWidth(z)===2&&(D++,z++);const B=O.getString(z).length;for(B>1&&(U+=B-1,j+=B-1);N>0&&W>0&&!this._isCharWordSeparator(O.loadCell(N-1,this._workCell));){O.loadCell(N-1,this._workCell);const A=this._workCell.getChars().length;this._workCell.getWidth()===0?(E++,N--):A>1&&(x+=A-1,W-=A-1),W--,N--}for(;z<O.length&&j+1<H.length&&!this._isCharWordSeparator(O.loadCell(z+1,this._workCell));){O.loadCell(z+1,this._workCell);const A=this._workCell.getChars().length;this._workCell.getWidth()===2?(D++,z++):A>1&&(U+=A-1,j+=A-1),j++,z++}}j++;let V=W+S-E+x,q=Math.min(this._bufferService.cols,j-W+E+D-x-U);if(g||H.slice(W,j).trim()!==""){if(w&&V===0&&O.getCodePoint(0)!==32){const N=R.lines.get(l[1]-1);if(N&&O.isWrapped&&N.getCodePoint(this._bufferService.cols-1)!==32){const z=this._getWordAt([this._bufferService.cols-1,l[1]-1],!1,!0,!1);if(z){const B=this._bufferService.cols-z.start;V-=B,q+=B}}}if(k&&V+q===this._bufferService.cols&&O.getCodePoint(this._bufferService.cols-1)!==32){const N=R.lines.get(l[1]+1);if(N?.isWrapped&&N.getCodePoint(0)!==32){const z=this._getWordAt([0,l[1]+1],!1,!1,!0);z&&(q+=z.length)}}return{start:V,length:q}}}_selectWordAt(l,g){const w=this._getWordAt(l,g);if(w){for(;w.start<0;)w.start+=this._bufferService.cols,l[1]--;this._model.selectionStart=[w.start,l[1]],this._model.selectionStartLength=w.length}}_selectToWordAt(l){const g=this._getWordAt(l,!0);if(g){let w=l[1];for(;g.start<0;)g.start+=this._bufferService.cols,w--;if(!this._model.areSelectionValuesReversed())for(;g.start+g.length>this._bufferService.cols;)g.length-=this._bufferService.cols,w++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?g.start:g.start+g.length,w]}}_isCharWordSeparator(l){return l.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(l.getChars())>=0}_selectLineAt(l){const g=this._bufferService.buffer.getWrappedRangeForLine(l),w={start:{x:0,y:g.first},end:{x:this._bufferService.cols-1,y:g.last}};this._model.selectionStart=[0,g.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,n.getRangeLength)(w,this._bufferService.cols)}};C=h([c(3,e.IBufferService),c(4,e.ICoreService),c(5,d.IMouseService),c(6,e.IOptionsService),c(7,d.IRenderService),c(8,d.ICoreBrowserService)],C),t.SelectionService=C},4725:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IThemeService=t.ICharacterJoinerService=t.ISelectionService=t.IRenderService=t.IMouseService=t.ICoreBrowserService=t.ICharSizeService=void 0;const h=r(8343);t.ICharSizeService=(0,h.createDecorator)("CharSizeService"),t.ICoreBrowserService=(0,h.createDecorator)("CoreBrowserService"),t.IMouseService=(0,h.createDecorator)("MouseService"),t.IRenderService=(0,h.createDecorator)("RenderService"),t.ISelectionService=(0,h.createDecorator)("SelectionService"),t.ICharacterJoinerService=(0,h.createDecorator)("CharacterJoinerService"),t.IThemeService=(0,h.createDecorator)("ThemeService")},6731:function(L,t,r){var h=this&&this.__decorate||function(C,l,g,w){var k,R=arguments.length,O=R<3?l:w===null?w=Object.getOwnPropertyDescriptor(l,g):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")O=Reflect.decorate(C,l,g,w);else for(var H=C.length-1;H>=0;H--)(k=C[H])&&(O=(R<3?k(O):R>3?k(l,g,O):k(l,g))||O);return R>3&&O&&Object.defineProperty(l,g,O),O},c=this&&this.__param||function(C,l){return function(g,w){l(g,w,C)}};Object.defineProperty(t,"__esModule",{value:!0}),t.ThemeService=t.DEFAULT_ANSI_COLORS=void 0;const _=r(7239),a=r(8055),u=r(8460),v=r(844),d=r(2585),e=a.css.toColor("#ffffff"),s=a.css.toColor("#000000"),o=a.css.toColor("#ffffff"),i=a.css.toColor("#000000"),n={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};t.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const C=[a.css.toColor("#2e3436"),a.css.toColor("#cc0000"),a.css.toColor("#4e9a06"),a.css.toColor("#c4a000"),a.css.toColor("#3465a4"),a.css.toColor("#75507b"),a.css.toColor("#06989a"),a.css.toColor("#d3d7cf"),a.css.toColor("#555753"),a.css.toColor("#ef2929"),a.css.toColor("#8ae234"),a.css.toColor("#fce94f"),a.css.toColor("#729fcf"),a.css.toColor("#ad7fa8"),a.css.toColor("#34e2e2"),a.css.toColor("#eeeeec")],l=[0,95,135,175,215,255];for(let g=0;g<216;g++){const w=l[g/36%6|0],k=l[g/6%6|0],R=l[g%6];C.push({css:a.channels.toCss(w,k,R),rgba:a.channels.toRgba(w,k,R)})}for(let g=0;g<24;g++){const w=8+10*g;C.push({css:a.channels.toCss(w,w,w),rgba:a.channels.toRgba(w,w,w)})}return C})());let f=class extends v.Disposable{constructor(C){super(),this._optionsService=C,this._onChangeColors=this.register(new u.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._contrastCache=new _.ColorContrastCache,this._colors={foreground:e,background:s,cursor:o,cursorAccent:i,selectionForeground:void 0,selectionBackgroundTransparent:n,selectionBackgroundOpaque:a.color.blend(s,n),selectionInactiveBackgroundTransparent:n,selectionInactiveBackgroundOpaque:a.color.blend(s,n),ansi:t.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}get colors(){return this._colors}_setTheme(C={}){const l=this._colors;if(l.foreground=p(C.foreground,e),l.background=p(C.background,s),l.cursor=p(C.cursor,o),l.cursorAccent=p(C.cursorAccent,i),l.selectionBackgroundTransparent=p(C.selectionBackground,n),l.selectionBackgroundOpaque=a.color.blend(l.background,l.selectionBackgroundTransparent),l.selectionInactiveBackgroundTransparent=p(C.selectionInactiveBackground,l.selectionBackgroundTransparent),l.selectionInactiveBackgroundOpaque=a.color.blend(l.background,l.selectionInactiveBackgroundTransparent),l.selectionForeground=C.selectionForeground?p(C.selectionForeground,a.NULL_COLOR):void 0,l.selectionForeground===a.NULL_COLOR&&(l.selectionForeground=void 0),a.color.isOpaque(l.selectionBackgroundTransparent)&&(l.selectionBackgroundTransparent=a.color.opacity(l.selectionBackgroundTransparent,.3)),a.color.isOpaque(l.selectionInactiveBackgroundTransparent)&&(l.selectionInactiveBackgroundTransparent=a.color.opacity(l.selectionInactiveBackgroundTransparent,.3)),l.ansi=t.DEFAULT_ANSI_COLORS.slice(),l.ansi[0]=p(C.black,t.DEFAULT_ANSI_COLORS[0]),l.ansi[1]=p(C.red,t.DEFAULT_ANSI_COLORS[1]),l.ansi[2]=p(C.green,t.DEFAULT_ANSI_COLORS[2]),l.ansi[3]=p(C.yellow,t.DEFAULT_ANSI_COLORS[3]),l.ansi[4]=p(C.blue,t.DEFAULT_ANSI_COLORS[4]),l.ansi[5]=p(C.magenta,t.DEFAULT_ANSI_COLORS[5]),l.ansi[6]=p(C.cyan,t.DEFAULT_ANSI_COLORS[6]),l.ansi[7]=p(C.white,t.DEFAULT_ANSI_COLORS[7]),l.ansi[8]=p(C.brightBlack,t.DEFAULT_ANSI_COLORS[8]),l.ansi[9]=p(C.brightRed,t.DEFAULT_ANSI_COLORS[9]),l.ansi[10]=p(C.brightGreen,t.DEFAULT_ANSI_COLORS[10]),l.ansi[11]=p(C.brightYellow,t.DEFAULT_ANSI_COLORS[11]),l.ansi[12]=p(C.brightBlue,t.DEFAULT_ANSI_COLORS[12]),l.ansi[13]=p(C.brightMagenta,t.DEFAULT_ANSI_COLORS[13]),l.ansi[14]=p(C.brightCyan,t.DEFAULT_ANSI_COLORS[14]),l.ansi[15]=p(C.brightWhite,t.DEFAULT_ANSI_COLORS[15]),C.extendedAnsi){const g=Math.min(l.ansi.length-16,C.extendedAnsi.length);for(let w=0;w<g;w++)l.ansi[w+16]=p(C.extendedAnsi[w],t.DEFAULT_ANSI_COLORS[w+16])}this._contrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(C){this._restoreColor(C),this._onChangeColors.fire(this.colors)}_restoreColor(C){if(C!==void 0)switch(C){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[C]=this._restoreColors.ansi[C]}else for(let l=0;l<this._restoreColors.ansi.length;++l)this._colors.ansi[l]=this._restoreColors.ansi[l]}modifyColors(C){C(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function p(C,l){if(C!==void 0)try{return a.css.toColor(C)}catch{}return l}f=h([c(0,d.IOptionsService)],f),t.ThemeService=f},6349:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CircularList=void 0;const h=r(8460),c=r(844);class _ extends c.Disposable{constructor(u){super(),this._maxLength=u,this.onDeleteEmitter=this.register(new h.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new h.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new h.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(u){if(this._maxLength===u)return;const v=new Array(u);for(let d=0;d<Math.min(u,this.length);d++)v[d]=this._array[this._getCyclicIndex(d)];this._array=v,this._maxLength=u,this._startIndex=0}get length(){return this._length}set length(u){if(u>this._length)for(let v=this._length;v<u;v++)this._array[v]=void 0;this._length=u}get(u){return this._array[this._getCyclicIndex(u)]}set(u,v){this._array[this._getCyclicIndex(u)]=v}push(u){this._array[this._getCyclicIndex(this._length)]=u,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(u,v,...d){if(v){for(let e=u;e<this._length-v;e++)this._array[this._getCyclicIndex(e)]=this._array[this._getCyclicIndex(e+v)];this._length-=v,this.onDeleteEmitter.fire({index:u,amount:v})}for(let e=this._length-1;e>=u;e--)this._array[this._getCyclicIndex(e+d.length)]=this._array[this._getCyclicIndex(e)];for(let e=0;e<d.length;e++)this._array[this._getCyclicIndex(u+e)]=d[e];if(d.length&&this.onInsertEmitter.fire({index:u,amount:d.length}),this._length+d.length>this._maxLength){const e=this._length+d.length-this._maxLength;this._startIndex+=e,this._length=this._maxLength,this.onTrimEmitter.fire(e)}else this._length+=d.length}trimStart(u){u>this._length&&(u=this._length),this._startIndex+=u,this._length-=u,this.onTrimEmitter.fire(u)}shiftElements(u,v,d){if(!(v<=0)){if(u<0||u>=this._length)throw new Error("start argument out of range");if(u+d<0)throw new Error("Cannot shift elements in list beyond index 0");if(d>0){for(let s=v-1;s>=0;s--)this.set(u+s+d,this.get(u+s));const e=u+v+d-this._length;if(e>0)for(this._length+=e;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let e=0;e<v;e++)this.set(u+e+d,this.get(u+e))}}_getCyclicIndex(u){return(this._startIndex+u)%this._maxLength}}t.CircularList=_},1439:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function r(h,c=5){if(typeof h!="object")return h;const _=Array.isArray(h)?[]:{};for(const a in h)_[a]=c<=1?h[a]:h[a]&&r(h[a],c-1);return _}},8055:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.contrastRatio=t.toPaddedHex=t.rgba=t.rgb=t.css=t.color=t.channels=t.NULL_COLOR=void 0;const h=r(6114);let c=0,_=0,a=0,u=0;var v,d,e;function s(i){const n=i.toString(16);return n.length<2?"0"+n:n}function o(i,n){return i<n?(n+.05)/(i+.05):(i+.05)/(n+.05)}t.NULL_COLOR={css:"#00000000",rgba:0},function(i){i.toCss=function(n,f,p,C){return C!==void 0?`#${s(n)}${s(f)}${s(p)}${s(C)}`:`#${s(n)}${s(f)}${s(p)}`},i.toRgba=function(n,f,p,C=255){return(n<<24|f<<16|p<<8|C)>>>0}}(v=t.channels||(t.channels={})),function(i){function n(f,p){return u=Math.round(255*p),[c,_,a]=e.toChannels(f.rgba),{css:v.toCss(c,_,a,u),rgba:v.toRgba(c,_,a,u)}}i.blend=function(f,p){if(u=(255&p.rgba)/255,u===1)return{css:p.css,rgba:p.rgba};const C=p.rgba>>24&255,l=p.rgba>>16&255,g=p.rgba>>8&255,w=f.rgba>>24&255,k=f.rgba>>16&255,R=f.rgba>>8&255;return c=w+Math.round((C-w)*u),_=k+Math.round((l-k)*u),a=R+Math.round((g-R)*u),{css:v.toCss(c,_,a),rgba:v.toRgba(c,_,a)}},i.isOpaque=function(f){return(255&f.rgba)==255},i.ensureContrastRatio=function(f,p,C){const l=e.ensureContrastRatio(f.rgba,p.rgba,C);if(l)return e.toColor(l>>24&255,l>>16&255,l>>8&255)},i.opaque=function(f){const p=(255|f.rgba)>>>0;return[c,_,a]=e.toChannels(p),{css:v.toCss(c,_,a),rgba:p}},i.opacity=n,i.multiplyOpacity=function(f,p){return u=255&f.rgba,n(f,u*p/255)},i.toColorRGB=function(f){return[f.rgba>>24&255,f.rgba>>16&255,f.rgba>>8&255]}}(t.color||(t.color={})),function(i){let n,f;if(!h.isNode){const p=document.createElement("canvas");p.width=1,p.height=1;const C=p.getContext("2d",{willReadFrequently:!0});C&&(n=C,n.globalCompositeOperation="copy",f=n.createLinearGradient(0,0,1,1))}i.toColor=function(p){if(p.match(/#[\da-f]{3,8}/i))switch(p.length){case 4:return c=parseInt(p.slice(1,2).repeat(2),16),_=parseInt(p.slice(2,3).repeat(2),16),a=parseInt(p.slice(3,4).repeat(2),16),e.toColor(c,_,a);case 5:return c=parseInt(p.slice(1,2).repeat(2),16),_=parseInt(p.slice(2,3).repeat(2),16),a=parseInt(p.slice(3,4).repeat(2),16),u=parseInt(p.slice(4,5).repeat(2),16),e.toColor(c,_,a,u);case 7:return{css:p,rgba:(parseInt(p.slice(1),16)<<8|255)>>>0};case 9:return{css:p,rgba:parseInt(p.slice(1),16)>>>0}}const C=p.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(C)return c=parseInt(C[1]),_=parseInt(C[2]),a=parseInt(C[3]),u=Math.round(255*(C[5]===void 0?1:parseFloat(C[5]))),e.toColor(c,_,a,u);if(!n||!f)throw new Error("css.toColor: Unsupported css format");if(n.fillStyle=f,n.fillStyle=p,typeof n.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(n.fillRect(0,0,1,1),[c,_,a,u]=n.getImageData(0,0,1,1).data,u!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:v.toRgba(c,_,a,u),css:p}}}(t.css||(t.css={})),function(i){function n(f,p,C){const l=f/255,g=p/255,w=C/255;return .2126*(l<=.03928?l/12.92:Math.pow((l+.055)/1.055,2.4))+.7152*(g<=.03928?g/12.92:Math.pow((g+.055)/1.055,2.4))+.0722*(w<=.03928?w/12.92:Math.pow((w+.055)/1.055,2.4))}i.relativeLuminance=function(f){return n(f>>16&255,f>>8&255,255&f)},i.relativeLuminance2=n}(d=t.rgb||(t.rgb={})),function(i){function n(p,C,l){const g=p>>24&255,w=p>>16&255,k=p>>8&255;let R=C>>24&255,O=C>>16&255,H=C>>8&255,W=o(d.relativeLuminance2(R,O,H),d.relativeLuminance2(g,w,k));for(;W<l&&(R>0||O>0||H>0);)R-=Math.max(0,Math.ceil(.1*R)),O-=Math.max(0,Math.ceil(.1*O)),H-=Math.max(0,Math.ceil(.1*H)),W=o(d.relativeLuminance2(R,O,H),d.relativeLuminance2(g,w,k));return(R<<24|O<<16|H<<8|255)>>>0}function f(p,C,l){const g=p>>24&255,w=p>>16&255,k=p>>8&255;let R=C>>24&255,O=C>>16&255,H=C>>8&255,W=o(d.relativeLuminance2(R,O,H),d.relativeLuminance2(g,w,k));for(;W<l&&(R<255||O<255||H<255);)R=Math.min(255,R+Math.ceil(.1*(255-R))),O=Math.min(255,O+Math.ceil(.1*(255-O))),H=Math.min(255,H+Math.ceil(.1*(255-H))),W=o(d.relativeLuminance2(R,O,H),d.relativeLuminance2(g,w,k));return(R<<24|O<<16|H<<8|255)>>>0}i.ensureContrastRatio=function(p,C,l){const g=d.relativeLuminance(p>>8),w=d.relativeLuminance(C>>8);if(o(g,w)<l){if(w<g){const O=n(p,C,l),H=o(g,d.relativeLuminance(O>>8));if(H<l){const W=f(p,C,l);return H>o(g,d.relativeLuminance(W>>8))?O:W}return O}const k=f(p,C,l),R=o(g,d.relativeLuminance(k>>8));if(R<l){const O=n(p,C,l);return R>o(g,d.relativeLuminance(O>>8))?k:O}return k}},i.reduceLuminance=n,i.increaseLuminance=f,i.toChannels=function(p){return[p>>24&255,p>>16&255,p>>8&255,255&p]},i.toColor=function(p,C,l,g){return{css:v.toCss(p,C,l,g),rgba:v.toRgba(p,C,l,g)}}}(e=t.rgba||(t.rgba={})),t.toPaddedHex=s,t.contrastRatio=o},8969:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CoreTerminal=void 0;const h=r(844),c=r(2585),_=r(4348),a=r(7866),u=r(744),v=r(7302),d=r(6975),e=r(8460),s=r(1753),o=r(1480),i=r(7994),n=r(9282),f=r(5435),p=r(5981),C=r(2660);let l=!1;class g extends h.Disposable{constructor(k){super(),this._onBinary=this.register(new e.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new e.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new e.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new e.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new e.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new e.EventEmitter),this._instantiationService=new _.InstantiationService,this.optionsService=this.register(new v.OptionsService(k)),this._instantiationService.setService(c.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(u.BufferService)),this._instantiationService.setService(c.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(a.LogService)),this._instantiationService.setService(c.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(d.CoreService)),this._instantiationService.setService(c.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(s.CoreMouseService)),this._instantiationService.setService(c.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(o.UnicodeService)),this._instantiationService.setService(c.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(i.CharsetService),this._instantiationService.setService(c.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(C.OscLinkService),this._instantiationService.setService(c.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new f.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,e.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,e.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,e.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,e.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onSpecificOptionChange("windowsMode",R=>this._handleWindowsModeOptionChange(R))),this.register(this._bufferService.onScroll(R=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(R=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new p.WriteBuffer((R,O)=>this._inputHandler.parse(R,O))),this.register((0,e.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed)),this.register((0,h.toDisposable)(()=>{var R;(R=this._windowsMode)===null||R===void 0||R.dispose(),this._windowsMode=void 0}))}get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new e.EventEmitter),this._onScroll.event(k=>{var R;(R=this._onScrollApi)===null||R===void 0||R.fire(k.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(k){for(const R in k)this.optionsService.options[R]=k[R]}write(k,R){this._writeBuffer.write(k,R)}writeSync(k,R){this._logService.logLevel<=c.LogLevelEnum.WARN&&!l&&(this._logService.warn("writeSync is unreliable and will be removed soon."),l=!0),this._writeBuffer.writeSync(k,R)}resize(k,R){isNaN(k)||isNaN(R)||(k=Math.max(k,u.MINIMUM_COLS),R=Math.max(R,u.MINIMUM_ROWS),this._bufferService.resize(k,R))}scroll(k,R=!1){this._bufferService.scroll(k,R)}scrollLines(k,R,O){this._bufferService.scrollLines(k,R,O)}scrollPages(k){this._bufferService.scrollPages(k)}scrollToTop(){this._bufferService.scrollToTop()}scrollToBottom(){this._bufferService.scrollToBottom()}scrollToLine(k){this._bufferService.scrollToLine(k)}registerEscHandler(k,R){return this._inputHandler.registerEscHandler(k,R)}registerDcsHandler(k,R){return this._inputHandler.registerDcsHandler(k,R)}registerCsiHandler(k,R){return this._inputHandler.registerCsiHandler(k,R)}registerOscHandler(k,R){return this._inputHandler.registerOscHandler(k,R)}_setup(){this.optionsService.rawOptions.windowsMode&&this._enableWindowsMode()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsModeOptionChange(k){var R;k?this._enableWindowsMode():((R=this._windowsMode)===null||R===void 0||R.dispose(),this._windowsMode=void 0)}_enableWindowsMode(){if(!this._windowsMode){const k=[];k.push(this.onLineFeed(n.updateWindowsModeWrappedState.bind(null,this._bufferService))),k.push(this.registerCsiHandler({final:"H"},()=>((0,n.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsMode={dispose:()=>{for(const R of k)R.dispose()}}}}}t.CoreTerminal=g},8460:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.forwardEvent=t.EventEmitter=void 0,t.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=r=>(this._listeners.push(r),{dispose:()=>{if(!this._disposed){for(let h=0;h<this._listeners.length;h++)if(this._listeners[h]===r)return void this._listeners.splice(h,1)}}})),this._event}fire(r,h){const c=[];for(let _=0;_<this._listeners.length;_++)c.push(this._listeners[_]);for(let _=0;_<c.length;_++)c[_].call(void 0,r,h)}dispose(){this._listeners&&(this._listeners.length=0),this._disposed=!0}},t.forwardEvent=function(r,h){return r(c=>h.fire(c))}},5435:function(L,t,r){var h=this&&this.__decorate||function(j,S,E,D){var x,U=arguments.length,V=U<3?S:D===null?D=Object.getOwnPropertyDescriptor(S,E):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")V=Reflect.decorate(j,S,E,D);else for(var q=j.length-1;q>=0;q--)(x=j[q])&&(V=(U<3?x(V):U>3?x(S,E,V):x(S,E))||V);return U>3&&V&&Object.defineProperty(S,E,V),V},c=this&&this.__param||function(j,S){return function(E,D){S(E,D,j)}};Object.defineProperty(t,"__esModule",{value:!0}),t.InputHandler=t.WindowsOptionsReportType=void 0;const _=r(2584),a=r(7116),u=r(2015),v=r(844),d=r(482),e=r(8437),s=r(8460),o=r(643),i=r(511),n=r(3734),f=r(2585),p=r(6242),C=r(6351),l=r(5941),g={"(":0,")":1,"*":2,"+":3,"-":1,".":2},w=131072;function k(j,S){if(j>24)return S.setWinLines||!1;switch(j){case 1:return!!S.restoreWin;case 2:return!!S.minimizeWin;case 3:return!!S.setWinPosition;case 4:return!!S.setWinSizePixels;case 5:return!!S.raiseWin;case 6:return!!S.lowerWin;case 7:return!!S.refreshWin;case 8:return!!S.setWinSizeChars;case 9:return!!S.maximizeWin;case 10:return!!S.fullscreenWin;case 11:return!!S.getWinState;case 13:return!!S.getWinPosition;case 14:return!!S.getWinSizePixels;case 15:return!!S.getScreenSizePixels;case 16:return!!S.getCellSizePixels;case 18:return!!S.getWinSizeChars;case 19:return!!S.getScreenSizeChars;case 20:return!!S.getIconTitle;case 21:return!!S.getWinTitle;case 22:return!!S.pushTitle;case 23:return!!S.popTitle;case 24:return!!S.setWinLines}return!1}var R;(function(j){j[j.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",j[j.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(R=t.WindowsOptionsReportType||(t.WindowsOptionsReportType={}));let O=0;class H extends v.Disposable{constructor(S,E,D,x,U,V,q,N,z=new u.EscapeSequenceParser){super(),this._bufferService=S,this._charsetService=E,this._coreService=D,this._logService=x,this._optionsService=U,this._oscLinkService=V,this._coreMouseService=q,this._unicodeService=N,this._parser=z,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new d.StringToUtf32,this._utf8Decoder=new d.Utf8ToUtf32,this._workCell=new i.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=e.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=e.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new s.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new s.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new s.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new s.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new s.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new s.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new s.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new s.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new s.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new s.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new s.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new s.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new s.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new W(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(B=>this._activeBuffer=B.activeBuffer)),this._parser.setCsiHandlerFallback((B,A)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(B),params:A.toArray()})}),this._parser.setEscHandlerFallback(B=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(B)})}),this._parser.setExecuteHandlerFallback(B=>{this._logService.debug("Unknown EXECUTE code: ",{code:B})}),this._parser.setOscHandlerFallback((B,A,P)=>{this._logService.debug("Unknown OSC code: ",{identifier:B,action:A,data:P})}),this._parser.setDcsHandlerFallback((B,A,P)=>{A==="HOOK"&&(P=P.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(B),action:A,payload:P})}),this._parser.setPrintHandler((B,A,P)=>this.print(B,A,P)),this._parser.registerCsiHandler({final:"@"},B=>this.insertChars(B)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},B=>this.scrollLeft(B)),this._parser.registerCsiHandler({final:"A"},B=>this.cursorUp(B)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},B=>this.scrollRight(B)),this._parser.registerCsiHandler({final:"B"},B=>this.cursorDown(B)),this._parser.registerCsiHandler({final:"C"},B=>this.cursorForward(B)),this._parser.registerCsiHandler({final:"D"},B=>this.cursorBackward(B)),this._parser.registerCsiHandler({final:"E"},B=>this.cursorNextLine(B)),this._parser.registerCsiHandler({final:"F"},B=>this.cursorPrecedingLine(B)),this._parser.registerCsiHandler({final:"G"},B=>this.cursorCharAbsolute(B)),this._parser.registerCsiHandler({final:"H"},B=>this.cursorPosition(B)),this._parser.registerCsiHandler({final:"I"},B=>this.cursorForwardTab(B)),this._parser.registerCsiHandler({final:"J"},B=>this.eraseInDisplay(B,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},B=>this.eraseInDisplay(B,!0)),this._parser.registerCsiHandler({final:"K"},B=>this.eraseInLine(B,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},B=>this.eraseInLine(B,!0)),this._parser.registerCsiHandler({final:"L"},B=>this.insertLines(B)),this._parser.registerCsiHandler({final:"M"},B=>this.deleteLines(B)),this._parser.registerCsiHandler({final:"P"},B=>this.deleteChars(B)),this._parser.registerCsiHandler({final:"S"},B=>this.scrollUp(B)),this._parser.registerCsiHandler({final:"T"},B=>this.scrollDown(B)),this._parser.registerCsiHandler({final:"X"},B=>this.eraseChars(B)),this._parser.registerCsiHandler({final:"Z"},B=>this.cursorBackwardTab(B)),this._parser.registerCsiHandler({final:"`"},B=>this.charPosAbsolute(B)),this._parser.registerCsiHandler({final:"a"},B=>this.hPositionRelative(B)),this._parser.registerCsiHandler({final:"b"},B=>this.repeatPrecedingCharacter(B)),this._parser.registerCsiHandler({final:"c"},B=>this.sendDeviceAttributesPrimary(B)),this._parser.registerCsiHandler({prefix:">",final:"c"},B=>this.sendDeviceAttributesSecondary(B)),this._parser.registerCsiHandler({final:"d"},B=>this.linePosAbsolute(B)),this._parser.registerCsiHandler({final:"e"},B=>this.vPositionRelative(B)),this._parser.registerCsiHandler({final:"f"},B=>this.hVPosition(B)),this._parser.registerCsiHandler({final:"g"},B=>this.tabClear(B)),this._parser.registerCsiHandler({final:"h"},B=>this.setMode(B)),this._parser.registerCsiHandler({prefix:"?",final:"h"},B=>this.setModePrivate(B)),this._parser.registerCsiHandler({final:"l"},B=>this.resetMode(B)),this._parser.registerCsiHandler({prefix:"?",final:"l"},B=>this.resetModePrivate(B)),this._parser.registerCsiHandler({final:"m"},B=>this.charAttributes(B)),this._parser.registerCsiHandler({final:"n"},B=>this.deviceStatus(B)),this._parser.registerCsiHandler({prefix:"?",final:"n"},B=>this.deviceStatusPrivate(B)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},B=>this.softReset(B)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},B=>this.setCursorStyle(B)),this._parser.registerCsiHandler({final:"r"},B=>this.setScrollRegion(B)),this._parser.registerCsiHandler({final:"s"},B=>this.saveCursor(B)),this._parser.registerCsiHandler({final:"t"},B=>this.windowOptions(B)),this._parser.registerCsiHandler({final:"u"},B=>this.restoreCursor(B)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},B=>this.insertColumns(B)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},B=>this.deleteColumns(B)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},B=>this.selectProtected(B)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},B=>this.requestMode(B,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},B=>this.requestMode(B,!1)),this._parser.setExecuteHandler(_.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(_.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(_.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(_.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(_.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(_.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(_.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(_.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(_.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(_.C1.IND,()=>this.index()),this._parser.setExecuteHandler(_.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(_.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new p.OscHandler(B=>(this.setTitle(B),this.setIconName(B),!0))),this._parser.registerOscHandler(1,new p.OscHandler(B=>this.setIconName(B))),this._parser.registerOscHandler(2,new p.OscHandler(B=>this.setTitle(B))),this._parser.registerOscHandler(4,new p.OscHandler(B=>this.setOrReportIndexedColor(B))),this._parser.registerOscHandler(8,new p.OscHandler(B=>this.setHyperlink(B))),this._parser.registerOscHandler(10,new p.OscHandler(B=>this.setOrReportFgColor(B))),this._parser.registerOscHandler(11,new p.OscHandler(B=>this.setOrReportBgColor(B))),this._parser.registerOscHandler(12,new p.OscHandler(B=>this.setOrReportCursorColor(B))),this._parser.registerOscHandler(104,new p.OscHandler(B=>this.restoreIndexedColor(B))),this._parser.registerOscHandler(110,new p.OscHandler(B=>this.restoreFgColor(B))),this._parser.registerOscHandler(111,new p.OscHandler(B=>this.restoreBgColor(B))),this._parser.registerOscHandler(112,new p.OscHandler(B=>this.restoreCursorColor(B))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const B in a.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:B},()=>this.selectCharset("("+B)),this._parser.registerEscHandler({intermediates:")",final:B},()=>this.selectCharset(")"+B)),this._parser.registerEscHandler({intermediates:"*",final:B},()=>this.selectCharset("*"+B)),this._parser.registerEscHandler({intermediates:"+",final:B},()=>this.selectCharset("+"+B)),this._parser.registerEscHandler({intermediates:"-",final:B},()=>this.selectCharset("-"+B)),this._parser.registerEscHandler({intermediates:".",final:B},()=>this.selectCharset("."+B)),this._parser.registerEscHandler({intermediates:"/",final:B},()=>this.selectCharset("/"+B));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(B=>(this._logService.error("Parsing error: ",B),B)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new C.DcsHandler((B,A)=>this.requestStatusString(B,A)))}getAttrData(){return this._curAttrData}_preserveStack(S,E,D,x){this._parseStack.paused=!0,this._parseStack.cursorStartX=S,this._parseStack.cursorStartY=E,this._parseStack.decodedLength=D,this._parseStack.position=x}_logSlowResolvingAsync(S){this._logService.logLevel<=f.LogLevelEnum.WARN&&Promise.race([S,new Promise((E,D)=>setTimeout(()=>D("#SLOW_TIMEOUT"),5e3))]).catch(E=>{if(E!=="#SLOW_TIMEOUT")throw E;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(S,E){let D,x=this._activeBuffer.x,U=this._activeBuffer.y,V=0;const q=this._parseStack.paused;if(q){if(D=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,E))return this._logSlowResolvingAsync(D),D;x=this._parseStack.cursorStartX,U=this._parseStack.cursorStartY,this._parseStack.paused=!1,S.length>w&&(V=this._parseStack.position+w)}if(this._logService.logLevel<=f.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof S=="string"?` "${S}"`:` "${Array.prototype.map.call(S,N=>String.fromCharCode(N)).join("")}"`),typeof S=="string"?S.split("").map(N=>N.charCodeAt(0)):S),this._parseBuffer.length<S.length&&this._parseBuffer.length<w&&(this._parseBuffer=new Uint32Array(Math.min(S.length,w))),q||this._dirtyRowTracker.clearRange(),S.length>w)for(let N=V;N<S.length;N+=w){const z=N+w<S.length?N+w:S.length,B=typeof S=="string"?this._stringDecoder.decode(S.substring(N,z),this._parseBuffer):this._utf8Decoder.decode(S.subarray(N,z),this._parseBuffer);if(D=this._parser.parse(this._parseBuffer,B))return this._preserveStack(x,U,B,N),this._logSlowResolvingAsync(D),D}else if(!q){const N=typeof S=="string"?this._stringDecoder.decode(S,this._parseBuffer):this._utf8Decoder.decode(S,this._parseBuffer);if(D=this._parser.parse(this._parseBuffer,N))return this._preserveStack(x,U,N,0),this._logSlowResolvingAsync(D),D}this._activeBuffer.x===x&&this._activeBuffer.y===U||this._onCursorMove.fire(),this._onRequestRefreshRows.fire(this._dirtyRowTracker.start,this._dirtyRowTracker.end)}print(S,E,D){let x,U;const V=this._charsetService.charset,q=this._optionsService.rawOptions.screenReaderMode,N=this._bufferService.cols,z=this._coreService.decPrivateModes.wraparound,B=this._coreService.modes.insertMode,A=this._curAttrData;let P=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&D-E>0&&P.getWidth(this._activeBuffer.x-1)===2&&P.setCellFromCodePoint(this._activeBuffer.x-1,0,1,A.fg,A.bg,A.extended);for(let F=E;F<D;++F){if(x=S[F],U=this._unicodeService.wcwidth(x),x<127&&V){const $=V[String.fromCharCode(x)];$&&(x=$.charCodeAt(0))}if(q&&this._onA11yChar.fire((0,d.stringFromCodePoint)(x)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),U||!this._activeBuffer.x){if(this._activeBuffer.x+U-1>=N){if(z){for(;this._activeBuffer.x<N;)P.setCellFromCodePoint(this._activeBuffer.x++,0,1,A.fg,A.bg,A.extended);this._activeBuffer.x=0,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),P=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y)}else if(this._activeBuffer.x=N-1,U===2)continue}if(B&&(P.insertCells(this._activeBuffer.x,U,this._activeBuffer.getNullCell(A),A),P.getWidth(N-1)===2&&P.setCellFromCodePoint(N-1,o.NULL_CELL_CODE,o.NULL_CELL_WIDTH,A.fg,A.bg,A.extended)),P.setCellFromCodePoint(this._activeBuffer.x++,x,U,A.fg,A.bg,A.extended),U>0)for(;--U;)P.setCellFromCodePoint(this._activeBuffer.x++,0,0,A.fg,A.bg,A.extended)}else P.getWidth(this._activeBuffer.x-1)?P.addCodepointToCell(this._activeBuffer.x-1,x):P.addCodepointToCell(this._activeBuffer.x-2,x)}D-E>0&&(P.loadCell(this._activeBuffer.x-1,this._workCell),this._workCell.getWidth()===2||this._workCell.getCode()>65535?this._parser.precedingCodepoint=0:this._workCell.isCombined()?this._parser.precedingCodepoint=this._workCell.getChars().charCodeAt(0):this._parser.precedingCodepoint=this._workCell.content),this._activeBuffer.x<N&&D-E>0&&P.getWidth(this._activeBuffer.x)===0&&!P.hasContent(this._activeBuffer.x)&&P.setCellFromCodePoint(this._activeBuffer.x,0,1,A.fg,A.bg,A.extended),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(S,E){return S.final!=="t"||S.prefix||S.intermediates?this._parser.registerCsiHandler(S,E):this._parser.registerCsiHandler(S,D=>!k(D.params[0],this._optionsService.rawOptions.windowOptions)||E(D))}registerDcsHandler(S,E){return this._parser.registerDcsHandler(S,new C.DcsHandler(E))}registerEscHandler(S,E){return this._parser.registerEscHandler(S,E)}registerOscHandler(S,E){return this._parser.registerOscHandler(S,new p.OscHandler(E))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var S;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&(!((S=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))===null||S===void 0)&&S.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);E.hasWidth(this._activeBuffer.x)&&!E.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const S=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-S),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(S=this._bufferService.cols-1){this._activeBuffer.x=Math.min(S,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(S,E){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=S,this._activeBuffer.y=this._activeBuffer.scrollTop+E):(this._activeBuffer.x=S,this._activeBuffer.y=E),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(S,E){this._restrictCursor(),this._setCursor(this._activeBuffer.x+S,this._activeBuffer.y+E)}cursorUp(S){const E=this._activeBuffer.y-this._activeBuffer.scrollTop;return E>=0?this._moveCursor(0,-Math.min(E,S.params[0]||1)):this._moveCursor(0,-(S.params[0]||1)),!0}cursorDown(S){const E=this._activeBuffer.scrollBottom-this._activeBuffer.y;return E>=0?this._moveCursor(0,Math.min(E,S.params[0]||1)):this._moveCursor(0,S.params[0]||1),!0}cursorForward(S){return this._moveCursor(S.params[0]||1,0),!0}cursorBackward(S){return this._moveCursor(-(S.params[0]||1),0),!0}cursorNextLine(S){return this.cursorDown(S),this._activeBuffer.x=0,!0}cursorPrecedingLine(S){return this.cursorUp(S),this._activeBuffer.x=0,!0}cursorCharAbsolute(S){return this._setCursor((S.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(S){return this._setCursor(S.length>=2?(S.params[1]||1)-1:0,(S.params[0]||1)-1),!0}charPosAbsolute(S){return this._setCursor((S.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(S){return this._moveCursor(S.params[0]||1,0),!0}linePosAbsolute(S){return this._setCursor(this._activeBuffer.x,(S.params[0]||1)-1),!0}vPositionRelative(S){return this._moveCursor(0,S.params[0]||1),!0}hVPosition(S){return this.cursorPosition(S),!0}tabClear(S){const E=S.params[0];return E===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:E===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(S){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let E=S.params[0]||1;for(;E--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(S){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let E=S.params[0]||1;for(;E--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(S){const E=S.params[0];return E===1&&(this._curAttrData.bg|=536870912),E!==2&&E!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(S,E,D,x=!1,U=!1){const V=this._activeBuffer.lines.get(this._activeBuffer.ybase+S);V.replaceCells(E,D,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData(),U),x&&(V.isWrapped=!1)}_resetBufferLine(S,E=!1){const D=this._activeBuffer.lines.get(this._activeBuffer.ybase+S);D.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),E),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+S),D.isWrapped=!1}eraseInDisplay(S,E=!1){let D;switch(this._restrictCursor(this._bufferService.cols),S.params[0]){case 0:for(D=this._activeBuffer.y,this._dirtyRowTracker.markDirty(D),this._eraseInBufferLine(D++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,E);D<this._bufferService.rows;D++)this._resetBufferLine(D,E);this._dirtyRowTracker.markDirty(D);break;case 1:for(D=this._activeBuffer.y,this._dirtyRowTracker.markDirty(D),this._eraseInBufferLine(D,0,this._activeBuffer.x+1,!0,E),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(D+1).isWrapped=!1);D--;)this._resetBufferLine(D,E);this._dirtyRowTracker.markDirty(0);break;case 2:for(D=this._bufferService.rows,this._dirtyRowTracker.markDirty(D-1);D--;)this._resetBufferLine(D,E);this._dirtyRowTracker.markDirty(0);break;case 3:const x=this._activeBuffer.lines.length-this._bufferService.rows;x>0&&(this._activeBuffer.lines.trimStart(x),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-x,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-x,0),this._onScroll.fire(0))}return!0}eraseInLine(S,E=!1){switch(this._restrictCursor(this._bufferService.cols),S.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,E);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,E);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,E)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(S){this._restrictCursor();let E=S.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const D=this._activeBuffer.ybase+this._activeBuffer.y,x=this._bufferService.rows-1-this._activeBuffer.scrollBottom,U=this._bufferService.rows-1+this._activeBuffer.ybase-x+1;for(;E--;)this._activeBuffer.lines.splice(U-1,1),this._activeBuffer.lines.splice(D,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(S){this._restrictCursor();let E=S.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const D=this._activeBuffer.ybase+this._activeBuffer.y;let x;for(x=this._bufferService.rows-1-this._activeBuffer.scrollBottom,x=this._bufferService.rows-1+this._activeBuffer.ybase-x;E--;)this._activeBuffer.lines.splice(D,1),this._activeBuffer.lines.splice(x,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(S){this._restrictCursor();const E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return E&&(E.insertCells(this._activeBuffer.x,S.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(S){this._restrictCursor();const E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return E&&(E.deleteCells(this._activeBuffer.x,S.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(S){let E=S.params[0]||1;for(;E--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(S){let E=S.params[0]||1;for(;E--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(e.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(S){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const E=S.params[0]||1;for(let D=this._activeBuffer.scrollTop;D<=this._activeBuffer.scrollBottom;++D){const x=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);x.deleteCells(0,E,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),x.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(S){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const E=S.params[0]||1;for(let D=this._activeBuffer.scrollTop;D<=this._activeBuffer.scrollBottom;++D){const x=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);x.insertCells(0,E,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),x.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(S){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const E=S.params[0]||1;for(let D=this._activeBuffer.scrollTop;D<=this._activeBuffer.scrollBottom;++D){const x=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);x.insertCells(this._activeBuffer.x,E,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),x.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(S){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const E=S.params[0]||1;for(let D=this._activeBuffer.scrollTop;D<=this._activeBuffer.scrollBottom;++D){const x=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);x.deleteCells(this._activeBuffer.x,E,this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),x.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(S){this._restrictCursor();const E=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return E&&(E.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(S.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData()),this._eraseAttrData()),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(S){if(!this._parser.precedingCodepoint)return!0;const E=S.params[0]||1,D=new Uint32Array(E);for(let x=0;x<E;++x)D[x]=this._parser.precedingCodepoint;return this.print(D,0,D.length),!0}sendDeviceAttributesPrimary(S){return S.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(_.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(_.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(S){return S.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(_.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(_.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(S.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(_.C0.ESC+"[>83;40003;0c")),!0}_is(S){return(this._optionsService.rawOptions.termName+"").indexOf(S)===0}setMode(S){for(let E=0;E<S.length;E++)switch(S.params[E]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(S){for(let E=0;E<S.length;E++)switch(S.params[E]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,a.DEFAULT_CHARSET),this._charsetService.setgCharset(1,a.DEFAULT_CHARSET),this._charsetService.setgCharset(2,a.DEFAULT_CHARSET),this._charsetService.setgCharset(3,a.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(S){for(let E=0;E<S.length;E++)switch(S.params[E]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(S){for(let E=0;E<S.length;E++)switch(S.params[E]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),S.params[E]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(S,E){const D=this._coreService.decPrivateModes,{activeProtocol:x,activeEncoding:U}=this._coreMouseService,V=this._coreService,{buffers:q,cols:N}=this._bufferService,{active:z,alt:B}=q,A=this._optionsService.rawOptions,P=K=>K?1:2,F=S.params[0];return $=F,Y=E?F===2?3:F===4?P(V.modes.insertMode):F===12?4:F===20?P(A.convertEol):0:F===1?P(D.applicationCursorKeys):F===3?A.windowOptions.setWinLines?N===80?2:N===132?1:0:0:F===6?P(D.origin):F===7?P(D.wraparound):F===8?3:F===9?P(x==="X10"):F===12?P(A.cursorBlink):F===25?P(!V.isCursorHidden):F===45?P(D.reverseWraparound):F===66?P(D.applicationKeypad):F===1e3?P(x==="VT200"):F===1002?P(x==="DRAG"):F===1003?P(x==="ANY"):F===1004?P(D.sendFocus):F===1005?4:F===1006?P(U==="SGR"):F===1015?4:F===1016?P(U==="SGR_PIXELS"):F===1048?1:F===47||F===1047||F===1049?P(z===B):F===2004?P(D.bracketedPasteMode):0,V.triggerDataEvent(`${_.C0.ESC}[${E?"":"?"}${$};${Y}$y`),!0;var $,Y}_updateAttrColor(S,E,D,x,U){return E===2?(S|=50331648,S&=-16777216,S|=n.AttributeData.fromColorRGB([D,x,U])):E===5&&(S&=-50331904,S|=33554432|255&D),S}_extractColor(S,E,D){const x=[0,0,-1,0,0,0];let U=0,V=0;do{if(x[V+U]=S.params[E+V],S.hasSubParams(E+V)){const q=S.getSubParams(E+V);let N=0;do x[1]===5&&(U=1),x[V+N+1+U]=q[N];while(++N<q.length&&N+V+1+U<x.length);break}if(x[1]===5&&V+U>=2||x[1]===2&&V+U>=5)break;x[1]&&(U=1)}while(++V+E<S.length&&V+U<x.length);for(let q=2;q<x.length;++q)x[q]===-1&&(x[q]=0);switch(x[0]){case 38:D.fg=this._updateAttrColor(D.fg,x[1],x[3],x[4],x[5]);break;case 48:D.bg=this._updateAttrColor(D.bg,x[1],x[3],x[4],x[5]);break;case 58:D.extended=D.extended.clone(),D.extended.underlineColor=this._updateAttrColor(D.extended.underlineColor,x[1],x[3],x[4],x[5])}return V}_processUnderline(S,E){E.extended=E.extended.clone(),(!~S||S>5)&&(S=1),E.extended.underlineStyle=S,E.fg|=268435456,S===0&&(E.fg&=-268435457),E.updateExtended()}_processSGR0(S){S.fg=e.DEFAULT_ATTR_DATA.fg,S.bg=e.DEFAULT_ATTR_DATA.bg,S.extended=S.extended.clone(),S.extended.underlineStyle=0,S.extended.underlineColor&=-67108864,S.updateExtended()}charAttributes(S){if(S.length===1&&S.params[0]===0)return this._processSGR0(this._curAttrData),!0;const E=S.length;let D;const x=this._curAttrData;for(let U=0;U<E;U++)D=S.params[U],D>=30&&D<=37?(x.fg&=-50331904,x.fg|=16777216|D-30):D>=40&&D<=47?(x.bg&=-50331904,x.bg|=16777216|D-40):D>=90&&D<=97?(x.fg&=-50331904,x.fg|=16777224|D-90):D>=100&&D<=107?(x.bg&=-50331904,x.bg|=16777224|D-100):D===0?this._processSGR0(x):D===1?x.fg|=134217728:D===3?x.bg|=67108864:D===4?(x.fg|=268435456,this._processUnderline(S.hasSubParams(U)?S.getSubParams(U)[0]:1,x)):D===5?x.fg|=536870912:D===7?x.fg|=67108864:D===8?x.fg|=1073741824:D===9?x.fg|=2147483648:D===2?x.bg|=134217728:D===21?this._processUnderline(2,x):D===22?(x.fg&=-134217729,x.bg&=-134217729):D===23?x.bg&=-67108865:D===24?(x.fg&=-268435457,this._processUnderline(0,x)):D===25?x.fg&=-536870913:D===27?x.fg&=-67108865:D===28?x.fg&=-1073741825:D===29?x.fg&=2147483647:D===39?(x.fg&=-67108864,x.fg|=16777215&e.DEFAULT_ATTR_DATA.fg):D===49?(x.bg&=-67108864,x.bg|=16777215&e.DEFAULT_ATTR_DATA.bg):D===38||D===48||D===58?U+=this._extractColor(S,U,x):D===59?(x.extended=x.extended.clone(),x.extended.underlineColor=-1,x.updateExtended()):D===100?(x.fg&=-67108864,x.fg|=16777215&e.DEFAULT_ATTR_DATA.fg,x.bg&=-67108864,x.bg|=16777215&e.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",D);return!0}deviceStatus(S){switch(S.params[0]){case 5:this._coreService.triggerDataEvent(`${_.C0.ESC}[0n`);break;case 6:const E=this._activeBuffer.y+1,D=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${_.C0.ESC}[${E};${D}R`)}return!0}deviceStatusPrivate(S){if(S.params[0]===6){const E=this._activeBuffer.y+1,D=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${_.C0.ESC}[?${E};${D}R`)}return!0}softReset(S){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=e.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(S){const E=S.params[0]||1;switch(E){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const D=E%2==1;return this._optionsService.options.cursorBlink=D,!0}setScrollRegion(S){const E=S.params[0]||1;let D;return(S.length<2||(D=S.params[1])>this._bufferService.rows||D===0)&&(D=this._bufferService.rows),D>E&&(this._activeBuffer.scrollTop=E-1,this._activeBuffer.scrollBottom=D-1,this._setCursor(0,0)),!0}windowOptions(S){if(!k(S.params[0],this._optionsService.rawOptions.windowOptions))return!0;const E=S.length>1?S.params[1]:0;switch(S.params[0]){case 14:E!==2&&this._onRequestWindowsOptionsReport.fire(R.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(R.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${_.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:E!==0&&E!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),E!==0&&E!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:E!==0&&E!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),E!==0&&E!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(S){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(S){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(S){return this._windowTitle=S,this._onTitleChange.fire(S),!0}setIconName(S){return this._iconName=S,!0}setOrReportIndexedColor(S){const E=[],D=S.split(";");for(;D.length>1;){const x=D.shift(),U=D.shift();if(/^\d+$/.exec(x)){const V=parseInt(x);if(0<=V&&V<256)if(U==="?")E.push({type:0,index:V});else{const q=(0,l.parseColor)(U);q&&E.push({type:1,index:V,color:q})}}}return E.length&&this._onColor.fire(E),!0}setHyperlink(S){const E=S.split(";");return!(E.length<2)&&(E[1]?this._createHyperlink(E[0],E[1]):!E[0]&&this._finishHyperlink())}_createHyperlink(S,E){this._getCurrentLinkId()&&this._finishHyperlink();const D=S.split(":");let x;const U=D.findIndex(V=>V.startsWith("id="));return U!==-1&&(x=D[U].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:x,uri:E}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(S,E){const D=S.split(";");for(let x=0;x<D.length&&!(E>=this._specialColors.length);++x,++E)if(D[x]==="?")this._onColor.fire([{type:0,index:this._specialColors[E]}]);else{const U=(0,l.parseColor)(D[x]);U&&this._onColor.fire([{type:1,index:this._specialColors[E],color:U}])}return!0}setOrReportFgColor(S){return this._setOrReportSpecialColor(S,0)}setOrReportBgColor(S){return this._setOrReportSpecialColor(S,1)}setOrReportCursorColor(S){return this._setOrReportSpecialColor(S,2)}restoreIndexedColor(S){if(!S)return this._onColor.fire([{type:2}]),!0;const E=[],D=S.split(";");for(let x=0;x<D.length;++x)if(/^\d+$/.exec(D[x])){const U=parseInt(D[x]);0<=U&&U<256&&E.push({type:2,index:U})}return E.length&&this._onColor.fire(E),!0}restoreFgColor(S){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(S){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(S){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,a.DEFAULT_CHARSET),!0}selectCharset(S){return S.length!==2?(this.selectDefaultCharset(),!0):(S[0]==="/"||this._charsetService.setgCharset(g[S[0]],a.CHARSETS[S[1]]||a.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const S=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,S,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=e.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=e.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(S){return this._charsetService.setgLevel(S),!0}screenAlignmentPattern(){const S=new i.CellData;S.content=4194304|"E".charCodeAt(0),S.fg=this._curAttrData.fg,S.bg=this._curAttrData.bg,this._setCursor(0,0);for(let E=0;E<this._bufferService.rows;++E){const D=this._activeBuffer.ybase+this._activeBuffer.y+E,x=this._activeBuffer.lines.get(D);x&&(x.fill(S),x.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(S,E){const D=this._bufferService.buffer,x=this._optionsService.rawOptions;return(U=>(this._coreService.triggerDataEvent(`${_.C0.ESC}${U}${_.C0.ESC}\\`),!0))(S==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:S==='"p'?'P1$r61;1"p':S==="r"?`P1$r${D.scrollTop+1};${D.scrollBottom+1}r`:S==="m"?"P1$r0m":S===" q"?`P1$r${{block:2,underline:4,bar:6}[x.cursorStyle]-(x.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(S,E){this._dirtyRowTracker.markRangeDirty(S,E)}}t.InputHandler=H;let W=class{constructor(j){this._bufferService=j,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(j){j<this.start?this.start=j:j>this.end&&(this.end=j)}markRangeDirty(j,S){j>S&&(O=j,j=S,S=O),j<this.start&&(this.start=j),S>this.end&&(this.end=S)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};W=h([c(0,f.IBufferService)],W)},844:(L,t)=>{function r(h){for(const c of h)c.dispose();h.length=0}Object.defineProperty(t,"__esModule",{value:!0}),t.getDisposeArrayDisposable=t.disposeArray=t.toDisposable=t.Disposable=void 0,t.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const h of this._disposables)h.dispose();this._disposables.length=0}register(h){return this._disposables.push(h),h}unregister(h){const c=this._disposables.indexOf(h);c!==-1&&this._disposables.splice(c,1)}},t.toDisposable=function(h){return{dispose:h}},t.disposeArray=r,t.getDisposeArrayDisposable=function(h){return{dispose:()=>r(h)}}},1505:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FourKeyMap=t.TwoKeyMap=void 0;class r{constructor(){this._data={}}set(c,_,a){this._data[c]||(this._data[c]={}),this._data[c][_]=a}get(c,_){return this._data[c]?this._data[c][_]:void 0}clear(){this._data={}}}t.TwoKeyMap=r,t.FourKeyMap=class{constructor(){this._data=new r}set(h,c,_,a,u){this._data.get(h,c)||this._data.set(h,c,new r),this._data.get(h,c).set(_,a,u)}get(h,c,_,a){var u;return(u=this._data.get(h,c))===null||u===void 0?void 0:u.get(_,a)}clear(){this._data.clear()}}},6114:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isChromeOS=t.isLinux=t.isWindows=t.isIphone=t.isIpad=t.isMac=t.getSafariVersion=t.isSafari=t.isLegacyEdge=t.isFirefox=t.isNode=void 0,t.isNode=typeof navigator>"u";const r=t.isNode?"node":navigator.userAgent,h=t.isNode?"node":navigator.platform;t.isFirefox=r.includes("Firefox"),t.isLegacyEdge=r.includes("Edge"),t.isSafari=/^((?!chrome|android).)*safari/i.test(r),t.getSafariVersion=function(){if(!t.isSafari)return 0;const c=r.match(/Version\/(\d+)/);return c===null||c.length<2?0:parseInt(c[1])},t.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(h),t.isIpad=h==="iPad",t.isIphone=h==="iPhone",t.isWindows=["Windows","Win16","Win32","WinCE"].includes(h),t.isLinux=h.indexOf("Linux")>=0,t.isChromeOS=/\bCrOS\b/.test(r)},6106:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SortedList=void 0;let r=0;t.SortedList=class{constructor(h){this._getKey=h,this._array=[]}clear(){this._array.length=0}insert(h){this._array.length!==0?(r=this._search(this._getKey(h),0,this._array.length-1),this._array.splice(r,0,h)):this._array.push(h)}delete(h){if(this._array.length===0)return!1;const c=this._getKey(h);if(c===void 0||(r=this._search(c,0,this._array.length-1),r===-1)||this._getKey(this._array[r])!==c)return!1;do if(this._array[r]===h)return this._array.splice(r,1),!0;while(++r<this._array.length&&this._getKey(this._array[r])===c);return!1}*getKeyIterator(h){if(this._array.length!==0&&(r=this._search(h,0,this._array.length-1),!(r<0||r>=this._array.length)&&this._getKey(this._array[r])===h))do yield this._array[r];while(++r<this._array.length&&this._getKey(this._array[r])===h)}forEachByKey(h,c){if(this._array.length!==0&&(r=this._search(h,0,this._array.length-1),!(r<0||r>=this._array.length)&&this._getKey(this._array[r])===h))do c(this._array[r]);while(++r<this._array.length&&this._getKey(this._array[r])===h)}values(){return this._array.values()}_search(h,c,_){if(_<c)return c;let a=Math.floor((c+_)/2);const u=this._getKey(this._array[a]);if(u>h)return this._search(h,c,a-1);if(u<h)return this._search(h,a+1,_);for(;a>0&&this._getKey(this._array[a-1])===h;)a--;return a}}},7226:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DebouncedIdleTask=t.IdleTaskQueue=t.PriorityTaskQueue=void 0;const h=r(6114);class c{constructor(){this._tasks=[],this._i=0}enqueue(u){this._tasks.push(u),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(u){this._idleCallback=void 0;let v=0,d=0,e=u.timeRemaining(),s=0;for(;this._i<this._tasks.length;){if(v=Date.now(),this._tasks[this._i]()||this._i++,v=Math.max(1,Date.now()-v),d=Math.max(v,d),s=u.timeRemaining(),1.5*d>s)return e-v<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(e-v))}ms`),void this._start();e=s}this.clear()}}class _ extends c{_requestCallback(u){return setTimeout(()=>u(this._createDeadline(16)))}_cancelCallback(u){clearTimeout(u)}_createDeadline(u){const v=Date.now()+u;return{timeRemaining:()=>Math.max(0,v-Date.now())}}}t.PriorityTaskQueue=_,t.IdleTaskQueue=!h.isNode&&"requestIdleCallback"in window?class extends c{_requestCallback(a){return requestIdleCallback(a)}_cancelCallback(a){cancelIdleCallback(a)}}:_,t.DebouncedIdleTask=class{constructor(){this._queue=new t.IdleTaskQueue}set(a){this._queue.clear(),this._queue.enqueue(a)}flush(){this._queue.flush()}}},9282:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.updateWindowsModeWrappedState=void 0;const h=r(643);t.updateWindowsModeWrappedState=function(c){const _=c.buffer.lines.get(c.buffer.ybase+c.buffer.y-1),a=_?.get(c.cols-1),u=c.buffer.lines.get(c.buffer.ybase+c.buffer.y);u&&a&&(u.isWrapped=a[h.CHAR_DATA_CODE_INDEX]!==h.NULL_CELL_CODE&&a[h.CHAR_DATA_CODE_INDEX]!==h.WHITESPACE_CELL_CODE)}},3734:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedAttrs=t.AttributeData=void 0;class r{constructor(){this.fg=0,this.bg=0,this.extended=new h}static toColorRGB(_){return[_>>>16&255,_>>>8&255,255&_]}static fromColorRGB(_){return(255&_[0])<<16|(255&_[1])<<8|255&_[2]}clone(){const _=new r;return _.fg=this.fg,_.bg=this.bg,_.extended=this.extended.clone(),_}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}}t.AttributeData=r;class h{constructor(_=0,a=0){this._ext=0,this._urlId=0,this._ext=_,this._urlId=a}get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(_){this._ext=_}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(_){this._ext&=-469762049,this._ext|=_<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(_){this._ext&=-67108864,this._ext|=67108863&_}get urlId(){return this._urlId}set urlId(_){this._urlId=_}clone(){return new h(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}t.ExtendedAttrs=h},9092:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferStringIterator=t.Buffer=t.MAX_BUFFER_SIZE=void 0;const h=r(6349),c=r(8437),_=r(511),a=r(643),u=r(4634),v=r(4863),d=r(7116),e=r(3734),s=r(7226);t.MAX_BUFFER_SIZE=4294967295,t.Buffer=class{constructor(i,n,f){this._hasScrollback=i,this._optionsService=n,this._bufferService=f,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=c.DEFAULT_ATTR_DATA.clone(),this.savedCharset=d.DEFAULT_CHARSET,this.markers=[],this._nullCell=_.CellData.fromCharData([0,a.NULL_CELL_CHAR,a.NULL_CELL_WIDTH,a.NULL_CELL_CODE]),this._whitespaceCell=_.CellData.fromCharData([0,a.WHITESPACE_CELL_CHAR,a.WHITESPACE_CELL_WIDTH,a.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new s.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new h.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(i){return i?(this._nullCell.fg=i.fg,this._nullCell.bg=i.bg,this._nullCell.extended=i.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new e.ExtendedAttrs),this._nullCell}getWhitespaceCell(i){return i?(this._whitespaceCell.fg=i.fg,this._whitespaceCell.bg=i.bg,this._whitespaceCell.extended=i.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new e.ExtendedAttrs),this._whitespaceCell}getBlankLine(i,n){return new c.BufferLine(this._bufferService.cols,this.getNullCell(i),n)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const i=this.ybase+this.y-this.ydisp;return i>=0&&i<this._rows}_getCorrectBufferLength(i){if(!this._hasScrollback)return i;const n=i+this._optionsService.rawOptions.scrollback;return n>t.MAX_BUFFER_SIZE?t.MAX_BUFFER_SIZE:n}fillViewportRows(i){if(this.lines.length===0){i===void 0&&(i=c.DEFAULT_ATTR_DATA);let n=this._rows;for(;n--;)this.lines.push(this.getBlankLine(i))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new h.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(i,n){const f=this.getNullCell(c.DEFAULT_ATTR_DATA);let p=0;const C=this._getCorrectBufferLength(n);if(C>this.lines.maxLength&&(this.lines.maxLength=C),this.lines.length>0){if(this._cols<i)for(let g=0;g<this.lines.length;g++)p+=+this.lines.get(g).resize(i,f);let l=0;if(this._rows<n)for(let g=this._rows;g<n;g++)this.lines.length<n+this.ybase&&(this._optionsService.rawOptions.windowsMode?this.lines.push(new c.BufferLine(i,f)):this.ybase>0&&this.lines.length<=this.ybase+this.y+l+1?(this.ybase--,l++,this.ydisp>0&&this.ydisp--):this.lines.push(new c.BufferLine(i,f)));else for(let g=this._rows;g>n;g--)this.lines.length>n+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(C<this.lines.maxLength){const g=this.lines.length-C;g>0&&(this.lines.trimStart(g),this.ybase=Math.max(this.ybase-g,0),this.ydisp=Math.max(this.ydisp-g,0),this.savedY=Math.max(this.savedY-g,0)),this.lines.maxLength=C}this.x=Math.min(this.x,i-1),this.y=Math.min(this.y,n-1),l&&(this.y+=l),this.savedX=Math.min(this.savedX,i-1),this.scrollTop=0}if(this.scrollBottom=n-1,this._isReflowEnabled&&(this._reflow(i,n),this._cols>i))for(let l=0;l<this.lines.length;l++)p+=+this.lines.get(l).resize(i,f);this._cols=i,this._rows=n,this._memoryCleanupQueue.clear(),p>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let i=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,i=!1);let n=0;for(;this._memoryCleanupPosition<this.lines.length;)if(n+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),n>100)return!0;return i}get _isReflowEnabled(){return this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(i,n){this._cols!==i&&(i>this._cols?this._reflowLarger(i,n):this._reflowSmaller(i,n))}_reflowLarger(i,n){const f=(0,u.reflowLargerGetLinesToRemove)(this.lines,this._cols,i,this.ybase+this.y,this.getNullCell(c.DEFAULT_ATTR_DATA));if(f.length>0){const p=(0,u.reflowLargerCreateNewLayout)(this.lines,f);(0,u.reflowLargerApplyNewLayout)(this.lines,p.layout),this._reflowLargerAdjustViewport(i,n,p.countRemoved)}}_reflowLargerAdjustViewport(i,n,f){const p=this.getNullCell(c.DEFAULT_ATTR_DATA);let C=f;for(;C-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<n&&this.lines.push(new c.BufferLine(i,p))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-f,0)}_reflowSmaller(i,n){const f=this.getNullCell(c.DEFAULT_ATTR_DATA),p=[];let C=0;for(let l=this.lines.length-1;l>=0;l--){let g=this.lines.get(l);if(!g||!g.isWrapped&&g.getTrimmedLength()<=i)continue;const w=[g];for(;g.isWrapped&&l>0;)g=this.lines.get(--l),w.unshift(g);const k=this.ybase+this.y;if(k>=l&&k<l+w.length)continue;const R=w[w.length-1].getTrimmedLength(),O=(0,u.reflowSmallerGetNewLineLengths)(w,this._cols,i),H=O.length-w.length;let W;W=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+H):Math.max(0,this.lines.length-this.lines.maxLength+H);const j=[];for(let V=0;V<H;V++){const q=this.getBlankLine(c.DEFAULT_ATTR_DATA,!0);j.push(q)}j.length>0&&(p.push({start:l+w.length+C,newLines:j}),C+=j.length),w.push(...j);let S=O.length-1,E=O[S];E===0&&(S--,E=O[S]);let D=w.length-H-1,x=R;for(;D>=0;){const V=Math.min(x,E);if(w[S]===void 0)break;if(w[S].copyCellsFrom(w[D],x-V,E-V,V,!0),E-=V,E===0&&(S--,E=O[S]),x-=V,x===0){D--;const q=Math.max(D,0);x=(0,u.getWrappedLineTrimmedLength)(w,q,this._cols)}}for(let V=0;V<w.length;V++)O[V]<i&&w[V].setCell(O[V],f);let U=H-W;for(;U-- >0;)this.ybase===0?this.y<n-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+C)-n&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+H,this.ybase+n-1)}if(p.length>0){const l=[],g=[];for(let S=0;S<this.lines.length;S++)g.push(this.lines.get(S));const w=this.lines.length;let k=w-1,R=0,O=p[R];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+C);let H=0;for(let S=Math.min(this.lines.maxLength-1,w+C-1);S>=0;S--)if(O&&O.start>k+H){for(let E=O.newLines.length-1;E>=0;E--)this.lines.set(S--,O.newLines[E]);S++,l.push({index:k+1,amount:O.newLines.length}),H+=O.newLines.length,O=p[++R]}else this.lines.set(S,g[k--]);let W=0;for(let S=l.length-1;S>=0;S--)l[S].index+=W,this.lines.onInsertEmitter.fire(l[S]),W+=l[S].amount;const j=Math.max(0,w+C-this.lines.maxLength);j>0&&this.lines.onTrimEmitter.fire(j)}}stringIndexToBufferIndex(i,n,f=!1){for(;n;){const p=this.lines.get(i);if(!p)return[-1,-1];const C=f?p.getTrimmedLength():p.length;for(let l=0;l<C;++l)if(p.get(l)[a.CHAR_DATA_WIDTH_INDEX]&&(n-=p.get(l)[a.CHAR_DATA_CHAR_INDEX].length||1),n<0)return[i,l];i++}return[i,0]}translateBufferLineToString(i,n,f=0,p){const C=this.lines.get(i);return C?C.translateToString(n,f,p):""}getWrappedRangeForLine(i){let n=i,f=i;for(;n>0&&this.lines.get(n).isWrapped;)n--;for(;f+1<this.lines.length&&this.lines.get(f+1).isWrapped;)f++;return{first:n,last:f}}setupTabStops(i){for(i!=null?this.tabs[i]||(i=this.prevStop(i)):(this.tabs={},i=0);i<this._cols;i+=this._optionsService.rawOptions.tabStopWidth)this.tabs[i]=!0}prevStop(i){for(i==null&&(i=this.x);!this.tabs[--i]&&i>0;);return i>=this._cols?this._cols-1:i<0?0:i}nextStop(i){for(i==null&&(i=this.x);!this.tabs[++i]&&i<this._cols;);return i>=this._cols?this._cols-1:i<0?0:i}clearMarkers(i){this._isClearing=!0;for(let n=0;n<this.markers.length;n++)this.markers[n].line===i&&(this.markers[n].dispose(),this.markers.splice(n--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let i=0;i<this.markers.length;i++)this.markers[i].dispose(),this.markers.splice(i--,1);this._isClearing=!1}addMarker(i){const n=new v.Marker(i);return this.markers.push(n),n.register(this.lines.onTrim(f=>{n.line-=f,n.line<0&&n.dispose()})),n.register(this.lines.onInsert(f=>{n.line>=f.index&&(n.line+=f.amount)})),n.register(this.lines.onDelete(f=>{n.line>=f.index&&n.line<f.index+f.amount&&n.dispose(),n.line>f.index&&(n.line-=f.amount)})),n.register(n.onDispose(()=>this._removeMarker(n))),n}_removeMarker(i){this._isClearing||this.markers.splice(this.markers.indexOf(i),1)}iterator(i,n,f,p,C){return new o(this,i,n,f,p,C)}};class o{constructor(n,f,p=0,C=n.lines.length,l=0,g=0){this._buffer=n,this._trimRight=f,this._startIndex=p,this._endIndex=C,this._startOverscan=l,this._endOverscan=g,this._startIndex<0&&(this._startIndex=0),this._endIndex>this._buffer.lines.length&&(this._endIndex=this._buffer.lines.length),this._current=this._startIndex}hasNext(){return this._current<this._endIndex}next(){const n=this._buffer.getWrappedRangeForLine(this._current);n.first<this._startIndex-this._startOverscan&&(n.first=this._startIndex-this._startOverscan),n.last>this._endIndex+this._endOverscan&&(n.last=this._endIndex+this._endOverscan),n.first=Math.max(n.first,0),n.last=Math.min(n.last,this._buffer.lines.length);let f="";for(let p=n.first;p<=n.last;++p)f+=this._buffer.translateBufferLineToString(p,this._trimRight);return this._current=n.last+1,{range:n,content:f}}}t.BufferStringIterator=o},8437:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLine=t.DEFAULT_ATTR_DATA=void 0;const h=r(482),c=r(643),_=r(511),a=r(3734);t.DEFAULT_ATTR_DATA=Object.freeze(new a.AttributeData);let u=0;class v{constructor(e,s,o=!1){this.isWrapped=o,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*e);const i=s||_.CellData.fromCharData([0,c.NULL_CELL_CHAR,c.NULL_CELL_WIDTH,c.NULL_CELL_CODE]);for(let n=0;n<e;++n)this.setCell(n,i);this.length=e}get(e){const s=this._data[3*e+0],o=2097151&s;return[this._data[3*e+1],2097152&s?this._combined[e]:o?(0,h.stringFromCodePoint)(o):"",s>>22,2097152&s?this._combined[e].charCodeAt(this._combined[e].length-1):o]}set(e,s){this._data[3*e+1]=s[c.CHAR_DATA_ATTR_INDEX],s[c.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[e]=s[1],this._data[3*e+0]=2097152|e|s[c.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*e+0]=s[c.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|s[c.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(e){return this._data[3*e+0]>>22}hasWidth(e){return 12582912&this._data[3*e+0]}getFg(e){return this._data[3*e+1]}getBg(e){return this._data[3*e+2]}hasContent(e){return 4194303&this._data[3*e+0]}getCodePoint(e){const s=this._data[3*e+0];return 2097152&s?this._combined[e].charCodeAt(this._combined[e].length-1):2097151&s}isCombined(e){return 2097152&this._data[3*e+0]}getString(e){const s=this._data[3*e+0];return 2097152&s?this._combined[e]:2097151&s?(0,h.stringFromCodePoint)(2097151&s):""}isProtected(e){return 536870912&this._data[3*e+2]}loadCell(e,s){return u=3*e,s.content=this._data[u+0],s.fg=this._data[u+1],s.bg=this._data[u+2],2097152&s.content&&(s.combinedData=this._combined[e]),268435456&s.bg&&(s.extended=this._extendedAttrs[e]),s}setCell(e,s){2097152&s.content&&(this._combined[e]=s.combinedData),268435456&s.bg&&(this._extendedAttrs[e]=s.extended),this._data[3*e+0]=s.content,this._data[3*e+1]=s.fg,this._data[3*e+2]=s.bg}setCellFromCodePoint(e,s,o,i,n,f){268435456&n&&(this._extendedAttrs[e]=f),this._data[3*e+0]=s|o<<22,this._data[3*e+1]=i,this._data[3*e+2]=n}addCodepointToCell(e,s){let o=this._data[3*e+0];2097152&o?this._combined[e]+=(0,h.stringFromCodePoint)(s):(2097151&o?(this._combined[e]=(0,h.stringFromCodePoint)(2097151&o)+(0,h.stringFromCodePoint)(s),o&=-2097152,o|=2097152):o=s|4194304,this._data[3*e+0]=o)}insertCells(e,s,o,i){if((e%=this.length)&&this.getWidth(e-1)===2&&this.setCellFromCodePoint(e-1,0,1,i?.fg||0,i?.bg||0,i?.extended||new a.ExtendedAttrs),s<this.length-e){const n=new _.CellData;for(let f=this.length-e-s-1;f>=0;--f)this.setCell(e+s+f,this.loadCell(e+f,n));for(let f=0;f<s;++f)this.setCell(e+f,o)}else for(let n=e;n<this.length;++n)this.setCell(n,o);this.getWidth(this.length-1)===2&&this.setCellFromCodePoint(this.length-1,0,1,i?.fg||0,i?.bg||0,i?.extended||new a.ExtendedAttrs)}deleteCells(e,s,o,i){if(e%=this.length,s<this.length-e){const n=new _.CellData;for(let f=0;f<this.length-e-s;++f)this.setCell(e+f,this.loadCell(e+s+f,n));for(let f=this.length-s;f<this.length;++f)this.setCell(f,o)}else for(let n=e;n<this.length;++n)this.setCell(n,o);e&&this.getWidth(e-1)===2&&this.setCellFromCodePoint(e-1,0,1,i?.fg||0,i?.bg||0,i?.extended||new a.ExtendedAttrs),this.getWidth(e)!==0||this.hasContent(e)||this.setCellFromCodePoint(e,0,1,i?.fg||0,i?.bg||0,i?.extended||new a.ExtendedAttrs)}replaceCells(e,s,o,i,n=!1){if(n)for(e&&this.getWidth(e-1)===2&&!this.isProtected(e-1)&&this.setCellFromCodePoint(e-1,0,1,i?.fg||0,i?.bg||0,i?.extended||new a.ExtendedAttrs),s<this.length&&this.getWidth(s-1)===2&&!this.isProtected(s)&&this.setCellFromCodePoint(s,0,1,i?.fg||0,i?.bg||0,i?.extended||new a.ExtendedAttrs);e<s&&e<this.length;)this.isProtected(e)||this.setCell(e,o),e++;else for(e&&this.getWidth(e-1)===2&&this.setCellFromCodePoint(e-1,0,1,i?.fg||0,i?.bg||0,i?.extended||new a.ExtendedAttrs),s<this.length&&this.getWidth(s-1)===2&&this.setCellFromCodePoint(s,0,1,i?.fg||0,i?.bg||0,i?.extended||new a.ExtendedAttrs);e<s&&e<this.length;)this.setCell(e++,o)}resize(e,s){if(e===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const o=3*e;if(e>this.length){if(this._data.buffer.byteLength>=4*o)this._data=new Uint32Array(this._data.buffer,0,o);else{const i=new Uint32Array(o);i.set(this._data),this._data=i}for(let i=this.length;i<e;++i)this.setCell(i,s)}else{this._data=this._data.subarray(0,o);const i=Object.keys(this._combined);for(let f=0;f<i.length;f++){const p=parseInt(i[f],10);p>=e&&delete this._combined[p]}const n=Object.keys(this._extendedAttrs);for(let f=0;f<n.length;f++){const p=parseInt(n[f],10);p>=e&&delete this._extendedAttrs[p]}}return this.length=e,4*o*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const e=new Uint32Array(this._data.length);return e.set(this._data),this._data=e,1}return 0}fill(e,s=!1){if(s)for(let o=0;o<this.length;++o)this.isProtected(o)||this.setCell(o,e);else{this._combined={},this._extendedAttrs={};for(let o=0;o<this.length;++o)this.setCell(o,e)}}copyFrom(e){this.length!==e.length?this._data=new Uint32Array(e._data):this._data.set(e._data),this.length=e.length,this._combined={};for(const s in e._combined)this._combined[s]=e._combined[s];this._extendedAttrs={};for(const s in e._extendedAttrs)this._extendedAttrs[s]=e._extendedAttrs[s];this.isWrapped=e.isWrapped}clone(){const e=new v(0);e._data=new Uint32Array(this._data),e.length=this.length;for(const s in this._combined)e._combined[s]=this._combined[s];for(const s in this._extendedAttrs)e._extendedAttrs[s]=this._extendedAttrs[s];return e.isWrapped=this.isWrapped,e}getTrimmedLength(){for(let e=this.length-1;e>=0;--e)if(4194303&this._data[3*e+0])return e+(this._data[3*e+0]>>22);return 0}copyCellsFrom(e,s,o,i,n){const f=e._data;if(n)for(let C=i-1;C>=0;C--){for(let l=0;l<3;l++)this._data[3*(o+C)+l]=f[3*(s+C)+l];268435456&f[3*(s+C)+2]&&(this._extendedAttrs[o+C]=e._extendedAttrs[s+C])}else for(let C=0;C<i;C++){for(let l=0;l<3;l++)this._data[3*(o+C)+l]=f[3*(s+C)+l];268435456&f[3*(s+C)+2]&&(this._extendedAttrs[o+C]=e._extendedAttrs[s+C])}const p=Object.keys(e._combined);for(let C=0;C<p.length;C++){const l=parseInt(p[C],10);l>=s&&(this._combined[l-s+o]=e._combined[l])}}translateToString(e=!1,s=0,o=this.length){e&&(o=Math.min(o,this.getTrimmedLength()));let i="";for(;s<o;){const n=this._data[3*s+0],f=2097151&n;i+=2097152&n?this._combined[s]:f?(0,h.stringFromCodePoint)(f):c.WHITESPACE_CELL_CHAR,s+=n>>22||1}return i}}t.BufferLine=v},4841:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getRangeLength=void 0,t.getRangeLength=function(r,h){if(r.start.y>r.end.y)throw new Error(`Buffer range end (${r.end.x}, ${r.end.y}) cannot be before start (${r.start.x}, ${r.start.y})`);return h*(r.end.y-r.start.y)+(r.end.x-r.start.x+1)}},4634:(L,t)=>{function r(h,c,_){if(c===h.length-1)return h[c].getTrimmedLength();const a=!h[c].hasContent(_-1)&&h[c].getWidth(_-1)===1,u=h[c+1].getWidth(0)===2;return a&&u?_-1:_}Object.defineProperty(t,"__esModule",{value:!0}),t.getWrappedLineTrimmedLength=t.reflowSmallerGetNewLineLengths=t.reflowLargerApplyNewLayout=t.reflowLargerCreateNewLayout=t.reflowLargerGetLinesToRemove=void 0,t.reflowLargerGetLinesToRemove=function(h,c,_,a,u){const v=[];for(let d=0;d<h.length-1;d++){let e=d,s=h.get(++e);if(!s.isWrapped)continue;const o=[h.get(d)];for(;e<h.length&&s.isWrapped;)o.push(s),s=h.get(++e);if(a>=d&&a<e){d+=o.length-1;continue}let i=0,n=r(o,i,c),f=1,p=0;for(;f<o.length;){const l=r(o,f,c),g=l-p,w=_-n,k=Math.min(g,w);o[i].copyCellsFrom(o[f],p,n,k,!1),n+=k,n===_&&(i++,n=0),p+=k,p===l&&(f++,p=0),n===0&&i!==0&&o[i-1].getWidth(_-1)===2&&(o[i].copyCellsFrom(o[i-1],_-1,n++,1,!1),o[i-1].setCell(_-1,u))}o[i].replaceCells(n,_,u);let C=0;for(let l=o.length-1;l>0&&(l>i||o[l].getTrimmedLength()===0);l--)C++;C>0&&(v.push(d+o.length-C),v.push(C)),d+=o.length-1}return v},t.reflowLargerCreateNewLayout=function(h,c){const _=[];let a=0,u=c[a],v=0;for(let d=0;d<h.length;d++)if(u===d){const e=c[++a];h.onDeleteEmitter.fire({index:d-v,amount:e}),d+=e-1,v+=e,u=c[++a]}else _.push(d);return{layout:_,countRemoved:v}},t.reflowLargerApplyNewLayout=function(h,c){const _=[];for(let a=0;a<c.length;a++)_.push(h.get(c[a]));for(let a=0;a<_.length;a++)h.set(a,_[a]);h.length=c.length},t.reflowSmallerGetNewLineLengths=function(h,c,_){const a=[],u=h.map((s,o)=>r(h,o,c)).reduce((s,o)=>s+o);let v=0,d=0,e=0;for(;e<u;){if(u-e<_){a.push(u-e);break}v+=_;const s=r(h,d,c);v>s&&(v-=s,d++);const o=h[d].getWidth(v-1)===2;o&&v--;const i=o?_-1:_;a.push(i),e+=i}return a},t.getWrappedLineTrimmedLength=r},5295:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferSet=void 0;const h=r(9092),c=r(8460),_=r(844);class a extends _.Disposable{constructor(v,d){super(),this._optionsService=v,this._bufferService=d,this._onBufferActivate=this.register(new c.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new h.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new h.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(v){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(v),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(v,d){this._normal.resize(v,d),this._alt.resize(v,d),this.setupTabStops(v)}setupTabStops(v){this._normal.setupTabStops(v),this._alt.setupTabStops(v)}}t.BufferSet=a},511:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CellData=void 0;const h=r(482),c=r(643),_=r(3734);class a extends _.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new _.ExtendedAttrs,this.combinedData=""}static fromCharData(v){const d=new a;return d.setFromCharData(v),d}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,h.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(v){this.fg=v[c.CHAR_DATA_ATTR_INDEX],this.bg=0;let d=!1;if(v[c.CHAR_DATA_CHAR_INDEX].length>2)d=!0;else if(v[c.CHAR_DATA_CHAR_INDEX].length===2){const e=v[c.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=e&&e<=56319){const s=v[c.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=s&&s<=57343?this.content=1024*(e-55296)+s-56320+65536|v[c.CHAR_DATA_WIDTH_INDEX]<<22:d=!0}else d=!0}else this.content=v[c.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|v[c.CHAR_DATA_WIDTH_INDEX]<<22;d&&(this.combinedData=v[c.CHAR_DATA_CHAR_INDEX],this.content=2097152|v[c.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}t.CellData=a},643:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WHITESPACE_CELL_CODE=t.WHITESPACE_CELL_WIDTH=t.WHITESPACE_CELL_CHAR=t.NULL_CELL_CODE=t.NULL_CELL_WIDTH=t.NULL_CELL_CHAR=t.CHAR_DATA_CODE_INDEX=t.CHAR_DATA_WIDTH_INDEX=t.CHAR_DATA_CHAR_INDEX=t.CHAR_DATA_ATTR_INDEX=t.DEFAULT_EXT=t.DEFAULT_ATTR=t.DEFAULT_COLOR=void 0,t.DEFAULT_COLOR=0,t.DEFAULT_ATTR=256|t.DEFAULT_COLOR<<9,t.DEFAULT_EXT=0,t.CHAR_DATA_ATTR_INDEX=0,t.CHAR_DATA_CHAR_INDEX=1,t.CHAR_DATA_WIDTH_INDEX=2,t.CHAR_DATA_CODE_INDEX=3,t.NULL_CELL_CHAR="",t.NULL_CELL_WIDTH=1,t.NULL_CELL_CODE=0,t.WHITESPACE_CELL_CHAR=" ",t.WHITESPACE_CELL_WIDTH=1,t.WHITESPACE_CELL_CODE=32},4863:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Marker=void 0;const h=r(8460),c=r(844);class _{constructor(u){this.line=u,this.isDisposed=!1,this._disposables=[],this._id=_._nextId++,this._onDispose=this.register(new h.EventEmitter),this.onDispose=this._onDispose.event}get id(){return this._id}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,c.disposeArray)(this._disposables),this._disposables.length=0)}register(u){return this._disposables.push(u),u}}t.Marker=_,_._nextId=1},7116:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_CHARSET=t.CHARSETS=void 0,t.CHARSETS={},t.DEFAULT_CHARSET=t.CHARSETS.B,t.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},t.CHARSETS.A={"#":"£"},t.CHARSETS.B=void 0,t.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},t.CHARSETS.C=t.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},t.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},t.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},t.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},t.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},t.CHARSETS.E=t.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},t.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},t.CHARSETS.H=t.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},t.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(L,t)=>{var r,h;Object.defineProperty(t,"__esModule",{value:!0}),t.C1_ESCAPED=t.C1=t.C0=void 0,function(c){c.NUL="\0",c.SOH="",c.STX="",c.ETX="",c.EOT="",c.ENQ="",c.ACK="",c.BEL="\x07",c.BS="\b",c.HT="	",c.LF=`
`,c.VT="\v",c.FF="\f",c.CR="\r",c.SO="",c.SI="",c.DLE="",c.DC1="",c.DC2="",c.DC3="",c.DC4="",c.NAK="",c.SYN="",c.ETB="",c.CAN="",c.EM="",c.SUB="",c.ESC="\x1B",c.FS="",c.GS="",c.RS="",c.US="",c.SP=" ",c.DEL=""}(r=t.C0||(t.C0={})),(h=t.C1||(t.C1={})).PAD="",h.HOP="",h.BPH="",h.NBH="",h.IND="",h.NEL="",h.SSA="",h.ESA="",h.HTS="",h.HTJ="",h.VTS="",h.PLD="",h.PLU="",h.RI="",h.SS2="",h.SS3="",h.DCS="",h.PU1="",h.PU2="",h.STS="",h.CCH="",h.MW="",h.SPA="",h.EPA="",h.SOS="",h.SGCI="",h.SCI="",h.CSI="",h.ST="",h.OSC="",h.PM="",h.APC="",(t.C1_ESCAPED||(t.C1_ESCAPED={})).ST=`${r.ESC}\\`},7399:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateKeyboardEvent=void 0;const h=r(2584),c={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};t.evaluateKeyboardEvent=function(_,a,u,v){const d={type:0,cancel:!1,key:void 0},e=(_.shiftKey?1:0)|(_.altKey?2:0)|(_.ctrlKey?4:0)|(_.metaKey?8:0);switch(_.keyCode){case 0:_.key==="UIKeyInputUpArrow"?d.key=a?h.C0.ESC+"OA":h.C0.ESC+"[A":_.key==="UIKeyInputLeftArrow"?d.key=a?h.C0.ESC+"OD":h.C0.ESC+"[D":_.key==="UIKeyInputRightArrow"?d.key=a?h.C0.ESC+"OC":h.C0.ESC+"[C":_.key==="UIKeyInputDownArrow"&&(d.key=a?h.C0.ESC+"OB":h.C0.ESC+"[B");break;case 8:if(_.altKey){d.key=h.C0.ESC+h.C0.DEL;break}d.key=h.C0.DEL;break;case 9:if(_.shiftKey){d.key=h.C0.ESC+"[Z";break}d.key=h.C0.HT,d.cancel=!0;break;case 13:d.key=_.altKey?h.C0.ESC+h.C0.CR:h.C0.CR,d.cancel=!0;break;case 27:d.key=h.C0.ESC,_.altKey&&(d.key=h.C0.ESC+h.C0.ESC),d.cancel=!0;break;case 37:if(_.metaKey)break;e?(d.key=h.C0.ESC+"[1;"+(e+1)+"D",d.key===h.C0.ESC+"[1;3D"&&(d.key=h.C0.ESC+(u?"b":"[1;5D"))):d.key=a?h.C0.ESC+"OD":h.C0.ESC+"[D";break;case 39:if(_.metaKey)break;e?(d.key=h.C0.ESC+"[1;"+(e+1)+"C",d.key===h.C0.ESC+"[1;3C"&&(d.key=h.C0.ESC+(u?"f":"[1;5C"))):d.key=a?h.C0.ESC+"OC":h.C0.ESC+"[C";break;case 38:if(_.metaKey)break;e?(d.key=h.C0.ESC+"[1;"+(e+1)+"A",u||d.key!==h.C0.ESC+"[1;3A"||(d.key=h.C0.ESC+"[1;5A")):d.key=a?h.C0.ESC+"OA":h.C0.ESC+"[A";break;case 40:if(_.metaKey)break;e?(d.key=h.C0.ESC+"[1;"+(e+1)+"B",u||d.key!==h.C0.ESC+"[1;3B"||(d.key=h.C0.ESC+"[1;5B")):d.key=a?h.C0.ESC+"OB":h.C0.ESC+"[B";break;case 45:_.shiftKey||_.ctrlKey||(d.key=h.C0.ESC+"[2~");break;case 46:d.key=e?h.C0.ESC+"[3;"+(e+1)+"~":h.C0.ESC+"[3~";break;case 36:d.key=e?h.C0.ESC+"[1;"+(e+1)+"H":a?h.C0.ESC+"OH":h.C0.ESC+"[H";break;case 35:d.key=e?h.C0.ESC+"[1;"+(e+1)+"F":a?h.C0.ESC+"OF":h.C0.ESC+"[F";break;case 33:_.shiftKey?d.type=2:_.ctrlKey?d.key=h.C0.ESC+"[5;"+(e+1)+"~":d.key=h.C0.ESC+"[5~";break;case 34:_.shiftKey?d.type=3:_.ctrlKey?d.key=h.C0.ESC+"[6;"+(e+1)+"~":d.key=h.C0.ESC+"[6~";break;case 112:d.key=e?h.C0.ESC+"[1;"+(e+1)+"P":h.C0.ESC+"OP";break;case 113:d.key=e?h.C0.ESC+"[1;"+(e+1)+"Q":h.C0.ESC+"OQ";break;case 114:d.key=e?h.C0.ESC+"[1;"+(e+1)+"R":h.C0.ESC+"OR";break;case 115:d.key=e?h.C0.ESC+"[1;"+(e+1)+"S":h.C0.ESC+"OS";break;case 116:d.key=e?h.C0.ESC+"[15;"+(e+1)+"~":h.C0.ESC+"[15~";break;case 117:d.key=e?h.C0.ESC+"[17;"+(e+1)+"~":h.C0.ESC+"[17~";break;case 118:d.key=e?h.C0.ESC+"[18;"+(e+1)+"~":h.C0.ESC+"[18~";break;case 119:d.key=e?h.C0.ESC+"[19;"+(e+1)+"~":h.C0.ESC+"[19~";break;case 120:d.key=e?h.C0.ESC+"[20;"+(e+1)+"~":h.C0.ESC+"[20~";break;case 121:d.key=e?h.C0.ESC+"[21;"+(e+1)+"~":h.C0.ESC+"[21~";break;case 122:d.key=e?h.C0.ESC+"[23;"+(e+1)+"~":h.C0.ESC+"[23~";break;case 123:d.key=e?h.C0.ESC+"[24;"+(e+1)+"~":h.C0.ESC+"[24~";break;default:if(!_.ctrlKey||_.shiftKey||_.altKey||_.metaKey)if(u&&!v||!_.altKey||_.metaKey)!u||_.altKey||_.ctrlKey||_.shiftKey||!_.metaKey?_.key&&!_.ctrlKey&&!_.altKey&&!_.metaKey&&_.keyCode>=48&&_.key.length===1?d.key=_.key:_.key&&_.ctrlKey&&(_.key==="_"&&(d.key=h.C0.US),_.key==="@"&&(d.key=h.C0.NUL)):_.keyCode===65&&(d.type=1);else{const s=c[_.keyCode],o=s?.[_.shiftKey?1:0];if(o)d.key=h.C0.ESC+o;else if(_.keyCode>=65&&_.keyCode<=90){const i=_.ctrlKey?_.keyCode-64:_.keyCode+32;let n=String.fromCharCode(i);_.shiftKey&&(n=n.toUpperCase()),d.key=h.C0.ESC+n}else if(_.keyCode===32)d.key=h.C0.ESC+(_.ctrlKey?h.C0.NUL:" ");else if(_.key==="Dead"&&_.code.startsWith("Key")){let i=_.code.slice(3,4);_.shiftKey||(i=i.toLowerCase()),d.key=h.C0.ESC+i,d.cancel=!0}}else _.keyCode>=65&&_.keyCode<=90?d.key=String.fromCharCode(_.keyCode-64):_.keyCode===32?d.key=h.C0.NUL:_.keyCode>=51&&_.keyCode<=55?d.key=String.fromCharCode(_.keyCode-51+27):_.keyCode===56?d.key=h.C0.DEL:_.keyCode===219?d.key=h.C0.ESC:_.keyCode===220?d.key=h.C0.FS:_.keyCode===221&&(d.key=h.C0.GS)}return d}},482:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Utf8ToUtf32=t.StringToUtf32=t.utf32ToString=t.stringFromCodePoint=void 0,t.stringFromCodePoint=function(r){return r>65535?(r-=65536,String.fromCharCode(55296+(r>>10))+String.fromCharCode(r%1024+56320)):String.fromCharCode(r)},t.utf32ToString=function(r,h=0,c=r.length){let _="";for(let a=h;a<c;++a){let u=r[a];u>65535?(u-=65536,_+=String.fromCharCode(55296+(u>>10))+String.fromCharCode(u%1024+56320)):_+=String.fromCharCode(u)}return _},t.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(r,h){const c=r.length;if(!c)return 0;let _=0,a=0;if(this._interim){const u=r.charCodeAt(a++);56320<=u&&u<=57343?h[_++]=1024*(this._interim-55296)+u-56320+65536:(h[_++]=this._interim,h[_++]=u),this._interim=0}for(let u=a;u<c;++u){const v=r.charCodeAt(u);if(55296<=v&&v<=56319){if(++u>=c)return this._interim=v,_;const d=r.charCodeAt(u);56320<=d&&d<=57343?h[_++]=1024*(v-55296)+d-56320+65536:(h[_++]=v,h[_++]=d)}else v!==65279&&(h[_++]=v)}return _}},t.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(r,h){const c=r.length;if(!c)return 0;let _,a,u,v,d=0,e=0,s=0;if(this.interim[0]){let n=!1,f=this.interim[0];f&=(224&f)==192?31:(240&f)==224?15:7;let p,C=0;for(;(p=63&this.interim[++C])&&C<4;)f<<=6,f|=p;const l=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,g=l-C;for(;s<g;){if(s>=c)return 0;if(p=r[s++],(192&p)!=128){s--,n=!0;break}this.interim[C++]=p,f<<=6,f|=63&p}n||(l===2?f<128?s--:h[d++]=f:l===3?f<2048||f>=55296&&f<=57343||f===65279||(h[d++]=f):f<65536||f>1114111||(h[d++]=f)),this.interim.fill(0)}const o=c-4;let i=s;for(;i<c;){for(;!(!(i<o)||128&(_=r[i])||128&(a=r[i+1])||128&(u=r[i+2])||128&(v=r[i+3]));)h[d++]=_,h[d++]=a,h[d++]=u,h[d++]=v,i+=4;if(_=r[i++],_<128)h[d++]=_;else if((224&_)==192){if(i>=c)return this.interim[0]=_,d;if(a=r[i++],(192&a)!=128){i--;continue}if(e=(31&_)<<6|63&a,e<128){i--;continue}h[d++]=e}else if((240&_)==224){if(i>=c)return this.interim[0]=_,d;if(a=r[i++],(192&a)!=128){i--;continue}if(i>=c)return this.interim[0]=_,this.interim[1]=a,d;if(u=r[i++],(192&u)!=128){i--;continue}if(e=(15&_)<<12|(63&a)<<6|63&u,e<2048||e>=55296&&e<=57343||e===65279)continue;h[d++]=e}else if((248&_)==240){if(i>=c)return this.interim[0]=_,d;if(a=r[i++],(192&a)!=128){i--;continue}if(i>=c)return this.interim[0]=_,this.interim[1]=a,d;if(u=r[i++],(192&u)!=128){i--;continue}if(i>=c)return this.interim[0]=_,this.interim[1]=a,this.interim[2]=u,d;if(v=r[i++],(192&v)!=128){i--;continue}if(e=(7&_)<<18|(63&a)<<12|(63&u)<<6|63&v,e<65536||e>1114111)continue;h[d++]=e}}return d}}},225:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeV6=void 0;const r=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],h=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let c;t.UnicodeV6=class{constructor(){if(this.version="6",!c){c=new Uint8Array(65536),c.fill(1),c[0]=0,c.fill(0,1,32),c.fill(0,127,160),c.fill(2,4352,4448),c[9001]=2,c[9002]=2,c.fill(2,11904,42192),c[12351]=1,c.fill(2,44032,55204),c.fill(2,63744,64256),c.fill(2,65040,65050),c.fill(2,65072,65136),c.fill(2,65280,65377),c.fill(2,65504,65511);for(let _=0;_<r.length;++_)c.fill(0,r[_][0],r[_][1]+1)}}wcwidth(_){return _<32?0:_<127?1:_<65536?c[_]:function(a,u){let v,d=0,e=u.length-1;if(a<u[0][0]||a>u[e][1])return!1;for(;e>=d;)if(v=d+e>>1,a>u[v][1])d=v+1;else{if(!(a<u[v][0]))return!0;e=v-1}return!1}(_,h)?0:_>=131072&&_<=196605||_>=196608&&_<=262141?2:1}}},5981:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.WriteBuffer=void 0;const h=r(8460),c=r(844);class _ extends c.Disposable{constructor(u){super(),this._action=u,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new h.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(u,v){if(v!==void 0&&this._syncCalls>v)return void(this._syncCalls=0);if(this._pendingData+=u.length,this._writeBuffer.push(u),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let d;for(this._isSyncWriting=!0;d=this._writeBuffer.shift();){this._action(d);const e=this._callbacks.shift();e&&e()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(u,v){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=u.length,this._writeBuffer.push(u),this._callbacks.push(v),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=u.length,this._writeBuffer.push(u),this._callbacks.push(v)}_innerWrite(u=0,v=!0){const d=u||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const e=this._writeBuffer[this._bufferOffset],s=this._action(e,v);if(s){const i=n=>Date.now()-d>=12?setTimeout(()=>this._innerWrite(0,n)):this._innerWrite(d,n);return void s.catch(n=>(queueMicrotask(()=>{throw n}),Promise.resolve(!1))).then(i)}const o=this._callbacks[this._bufferOffset];if(o&&o(),this._bufferOffset++,this._pendingData-=e.length,Date.now()-d>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}t.WriteBuffer=_},5941:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.toRgbString=t.parseColor=void 0;const r=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,h=/^[\da-f]+$/;function c(_,a){const u=_.toString(16),v=u.length<2?"0"+u:u;switch(a){case 4:return u[0];case 8:return v;case 12:return(v+v).slice(0,3);default:return v+v}}t.parseColor=function(_){if(!_)return;let a=_.toLowerCase();if(a.indexOf("rgb:")===0){a=a.slice(4);const u=r.exec(a);if(u){const v=u[1]?15:u[4]?255:u[7]?4095:65535;return[Math.round(parseInt(u[1]||u[4]||u[7]||u[10],16)/v*255),Math.round(parseInt(u[2]||u[5]||u[8]||u[11],16)/v*255),Math.round(parseInt(u[3]||u[6]||u[9]||u[12],16)/v*255)]}}else if(a.indexOf("#")===0&&(a=a.slice(1),h.exec(a)&&[3,6,9,12].includes(a.length))){const u=a.length/3,v=[0,0,0];for(let d=0;d<3;++d){const e=parseInt(a.slice(u*d,u*d+u),16);v[d]=u===1?e<<4:u===2?e:u===3?e>>4:e>>8}return v}},t.toRgbString=function(_,a=16){const[u,v,d]=_;return`rgb:${c(u,a)}/${c(v,a)}/${c(d,a)}`}},5770:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PAYLOAD_LIMIT=void 0,t.PAYLOAD_LIMIT=1e7},6351:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DcsHandler=t.DcsParser=void 0;const h=r(482),c=r(8742),_=r(5770),a=[];t.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=a,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=a}registerHandler(v,d){this._handlers[v]===void 0&&(this._handlers[v]=[]);const e=this._handlers[v];return e.push(d),{dispose:()=>{const s=e.indexOf(d);s!==-1&&e.splice(s,1)}}}clearHandler(v){this._handlers[v]&&delete this._handlers[v]}setHandlerFallback(v){this._handlerFb=v}reset(){if(this._active.length)for(let v=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;v>=0;--v)this._active[v].unhook(!1);this._stack.paused=!1,this._active=a,this._ident=0}hook(v,d){if(this.reset(),this._ident=v,this._active=this._handlers[v]||a,this._active.length)for(let e=this._active.length-1;e>=0;e--)this._active[e].hook(d);else this._handlerFb(this._ident,"HOOK",d)}put(v,d,e){if(this._active.length)for(let s=this._active.length-1;s>=0;s--)this._active[s].put(v,d,e);else this._handlerFb(this._ident,"PUT",(0,h.utf32ToString)(v,d,e))}unhook(v,d=!0){if(this._active.length){let e=!1,s=this._active.length-1,o=!1;if(this._stack.paused&&(s=this._stack.loopPosition-1,e=d,o=this._stack.fallThrough,this._stack.paused=!1),!o&&e===!1){for(;s>=0&&(e=this._active[s].unhook(v),e!==!0);s--)if(e instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=s,this._stack.fallThrough=!1,e;s--}for(;s>=0;s--)if(e=this._active[s].unhook(!1),e instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=s,this._stack.fallThrough=!0,e}else this._handlerFb(this._ident,"UNHOOK",v);this._active=a,this._ident=0}};const u=new c.Params;u.addParam(0),t.DcsHandler=class{constructor(v){this._handler=v,this._data="",this._params=u,this._hitLimit=!1}hook(v){this._params=v.length>1||v.params[0]?v.clone():u,this._data="",this._hitLimit=!1}put(v,d,e){this._hitLimit||(this._data+=(0,h.utf32ToString)(v,d,e),this._data.length>_.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(v){let d=!1;if(this._hitLimit)d=!1;else if(v&&(d=this._handler(this._data,this._params),d instanceof Promise))return d.then(e=>(this._params=u,this._data="",this._hitLimit=!1,e));return this._params=u,this._data="",this._hitLimit=!1,d}}},2015:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EscapeSequenceParser=t.VT500_TRANSITION_TABLE=t.TransitionTable=void 0;const h=r(844),c=r(8742),_=r(6242),a=r(6351);class u{constructor(s){this.table=new Uint8Array(s)}setDefault(s,o){this.table.fill(s<<4|o)}add(s,o,i,n){this.table[o<<8|s]=i<<4|n}addMany(s,o,i,n){for(let f=0;f<s.length;f++)this.table[o<<8|s[f]]=i<<4|n}}t.TransitionTable=u;const v=160;t.VT500_TRANSITION_TABLE=function(){const e=new u(4095),s=Array.apply(null,Array(256)).map((C,l)=>l),o=(C,l)=>s.slice(C,l),i=o(32,127),n=o(0,24);n.push(25),n.push.apply(n,o(28,32));const f=o(0,14);let p;for(p in e.setDefault(1,0),e.addMany(i,0,2,0),f)e.addMany([24,26,153,154],p,3,0),e.addMany(o(128,144),p,3,0),e.addMany(o(144,152),p,3,0),e.add(156,p,0,0),e.add(27,p,11,1),e.add(157,p,4,8),e.addMany([152,158,159],p,0,7),e.add(155,p,11,3),e.add(144,p,11,9);return e.addMany(n,0,3,0),e.addMany(n,1,3,1),e.add(127,1,0,1),e.addMany(n,8,0,8),e.addMany(n,3,3,3),e.add(127,3,0,3),e.addMany(n,4,3,4),e.add(127,4,0,4),e.addMany(n,6,3,6),e.addMany(n,5,3,5),e.add(127,5,0,5),e.addMany(n,2,3,2),e.add(127,2,0,2),e.add(93,1,4,8),e.addMany(i,8,5,8),e.add(127,8,5,8),e.addMany([156,27,24,26,7],8,6,0),e.addMany(o(28,32),8,0,8),e.addMany([88,94,95],1,0,7),e.addMany(i,7,0,7),e.addMany(n,7,0,7),e.add(156,7,0,0),e.add(127,7,0,7),e.add(91,1,11,3),e.addMany(o(64,127),3,7,0),e.addMany(o(48,60),3,8,4),e.addMany([60,61,62,63],3,9,4),e.addMany(o(48,60),4,8,4),e.addMany(o(64,127),4,7,0),e.addMany([60,61,62,63],4,0,6),e.addMany(o(32,64),6,0,6),e.add(127,6,0,6),e.addMany(o(64,127),6,0,0),e.addMany(o(32,48),3,9,5),e.addMany(o(32,48),5,9,5),e.addMany(o(48,64),5,0,6),e.addMany(o(64,127),5,7,0),e.addMany(o(32,48),4,9,5),e.addMany(o(32,48),1,9,2),e.addMany(o(32,48),2,9,2),e.addMany(o(48,127),2,10,0),e.addMany(o(48,80),1,10,0),e.addMany(o(81,88),1,10,0),e.addMany([89,90,92],1,10,0),e.addMany(o(96,127),1,10,0),e.add(80,1,11,9),e.addMany(n,9,0,9),e.add(127,9,0,9),e.addMany(o(28,32),9,0,9),e.addMany(o(32,48),9,9,12),e.addMany(o(48,60),9,8,10),e.addMany([60,61,62,63],9,9,10),e.addMany(n,11,0,11),e.addMany(o(32,128),11,0,11),e.addMany(o(28,32),11,0,11),e.addMany(n,10,0,10),e.add(127,10,0,10),e.addMany(o(28,32),10,0,10),e.addMany(o(48,60),10,8,10),e.addMany([60,61,62,63],10,0,11),e.addMany(o(32,48),10,9,12),e.addMany(n,12,0,12),e.add(127,12,0,12),e.addMany(o(28,32),12,0,12),e.addMany(o(32,48),12,9,12),e.addMany(o(48,64),12,0,11),e.addMany(o(64,127),12,12,13),e.addMany(o(64,127),10,12,13),e.addMany(o(64,127),9,12,13),e.addMany(n,13,13,13),e.addMany(i,13,13,13),e.add(127,13,0,13),e.addMany([27,156,24,26],13,14,0),e.add(v,0,2,0),e.add(v,8,5,8),e.add(v,6,0,6),e.add(v,11,0,11),e.add(v,13,13,13),e}();class d extends h.Disposable{constructor(s=t.VT500_TRANSITION_TABLE){super(),this._transitions=s,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new c.Params,this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._printHandlerFb=(o,i,n)=>{},this._executeHandlerFb=o=>{},this._csiHandlerFb=(o,i)=>{},this._escHandlerFb=o=>{},this._errorHandlerFb=o=>o,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,h.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new _.OscParser),this._dcsParser=this.register(new a.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(s,o=[64,126]){let i=0;if(s.prefix){if(s.prefix.length>1)throw new Error("only one byte as prefix supported");if(i=s.prefix.charCodeAt(0),i&&60>i||i>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(s.intermediates){if(s.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let f=0;f<s.intermediates.length;++f){const p=s.intermediates.charCodeAt(f);if(32>p||p>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");i<<=8,i|=p}}if(s.final.length!==1)throw new Error("final must be a single byte");const n=s.final.charCodeAt(0);if(o[0]>n||n>o[1])throw new Error(`final must be in range ${o[0]} .. ${o[1]}`);return i<<=8,i|=n,i}identToString(s){const o=[];for(;s;)o.push(String.fromCharCode(255&s)),s>>=8;return o.reverse().join("")}setPrintHandler(s){this._printHandler=s}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(s,o){const i=this._identifier(s,[48,126]);this._escHandlers[i]===void 0&&(this._escHandlers[i]=[]);const n=this._escHandlers[i];return n.push(o),{dispose:()=>{const f=n.indexOf(o);f!==-1&&n.splice(f,1)}}}clearEscHandler(s){this._escHandlers[this._identifier(s,[48,126])]&&delete this._escHandlers[this._identifier(s,[48,126])]}setEscHandlerFallback(s){this._escHandlerFb=s}setExecuteHandler(s,o){this._executeHandlers[s.charCodeAt(0)]=o}clearExecuteHandler(s){this._executeHandlers[s.charCodeAt(0)]&&delete this._executeHandlers[s.charCodeAt(0)]}setExecuteHandlerFallback(s){this._executeHandlerFb=s}registerCsiHandler(s,o){const i=this._identifier(s);this._csiHandlers[i]===void 0&&(this._csiHandlers[i]=[]);const n=this._csiHandlers[i];return n.push(o),{dispose:()=>{const f=n.indexOf(o);f!==-1&&n.splice(f,1)}}}clearCsiHandler(s){this._csiHandlers[this._identifier(s)]&&delete this._csiHandlers[this._identifier(s)]}setCsiHandlerFallback(s){this._csiHandlerFb=s}registerDcsHandler(s,o){return this._dcsParser.registerHandler(this._identifier(s),o)}clearDcsHandler(s){this._dcsParser.clearHandler(this._identifier(s))}setDcsHandlerFallback(s){this._dcsParser.setHandlerFallback(s)}registerOscHandler(s,o){return this._oscParser.registerHandler(s,o)}clearOscHandler(s){this._oscParser.clearHandler(s)}setOscHandlerFallback(s){this._oscParser.setHandlerFallback(s)}setErrorHandler(s){this._errorHandler=s}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(s,o,i,n,f){this._parseStack.state=s,this._parseStack.handlers=o,this._parseStack.handlerPos=i,this._parseStack.transition=n,this._parseStack.chunkPos=f}parse(s,o,i){let n,f=0,p=0,C=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,C=this._parseStack.chunkPos+1;else{if(i===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const l=this._parseStack.handlers;let g=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(i===!1&&g>-1){for(;g>=0&&(n=l[g](this._params),n!==!0);g--)if(n instanceof Promise)return this._parseStack.handlerPos=g,n}this._parseStack.handlers=[];break;case 4:if(i===!1&&g>-1){for(;g>=0&&(n=l[g](),n!==!0);g--)if(n instanceof Promise)return this._parseStack.handlerPos=g,n}this._parseStack.handlers=[];break;case 6:if(f=s[this._parseStack.chunkPos],n=this._dcsParser.unhook(f!==24&&f!==26,i),n)return n;f===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(f=s[this._parseStack.chunkPos],n=this._oscParser.end(f!==24&&f!==26,i),n)return n;f===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,C=this._parseStack.chunkPos+1,this.precedingCodepoint=0,this.currentState=15&this._parseStack.transition}for(let l=C;l<o;++l){switch(f=s[l],p=this._transitions.table[this.currentState<<8|(f<160?f:v)],p>>4){case 2:for(let O=l+1;;++O){if(O>=o||(f=s[O])<32||f>126&&f<v){this._printHandler(s,l,O),l=O-1;break}if(++O>=o||(f=s[O])<32||f>126&&f<v){this._printHandler(s,l,O),l=O-1;break}if(++O>=o||(f=s[O])<32||f>126&&f<v){this._printHandler(s,l,O),l=O-1;break}if(++O>=o||(f=s[O])<32||f>126&&f<v){this._printHandler(s,l,O),l=O-1;break}}break;case 3:this._executeHandlers[f]?this._executeHandlers[f]():this._executeHandlerFb(f),this.precedingCodepoint=0;break;case 0:break;case 1:if(this._errorHandler({position:l,code:f,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const g=this._csiHandlers[this._collect<<8|f];let w=g?g.length-1:-1;for(;w>=0&&(n=g[w](this._params),n!==!0);w--)if(n instanceof Promise)return this._preserveStack(3,g,w,p,l),n;w<0&&this._csiHandlerFb(this._collect<<8|f,this._params),this.precedingCodepoint=0;break;case 8:do switch(f){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(f-48)}while(++l<o&&(f=s[l])>47&&f<60);l--;break;case 9:this._collect<<=8,this._collect|=f;break;case 10:const k=this._escHandlers[this._collect<<8|f];let R=k?k.length-1:-1;for(;R>=0&&(n=k[R](),n!==!0);R--)if(n instanceof Promise)return this._preserveStack(4,k,R,p,l),n;R<0&&this._escHandlerFb(this._collect<<8|f),this.precedingCodepoint=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|f,this._params);break;case 13:for(let O=l+1;;++O)if(O>=o||(f=s[O])===24||f===26||f===27||f>127&&f<v){this._dcsParser.put(s,l,O),l=O-1;break}break;case 14:if(n=this._dcsParser.unhook(f!==24&&f!==26),n)return this._preserveStack(6,[],0,p,l),n;f===27&&(p|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0;break;case 4:this._oscParser.start();break;case 5:for(let O=l+1;;O++)if(O>=o||(f=s[O])<32||f>127&&f<v){this._oscParser.put(s,l,O),l=O-1;break}break;case 6:if(n=this._oscParser.end(f!==24&&f!==26),n)return this._preserveStack(5,[],0,p,l),n;f===27&&(p|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingCodepoint=0}this.currentState=15&p}}}t.EscapeSequenceParser=d},6242:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OscHandler=t.OscParser=void 0;const h=r(5770),c=r(482),_=[];t.OscParser=class{constructor(){this._state=0,this._active=_,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(a,u){this._handlers[a]===void 0&&(this._handlers[a]=[]);const v=this._handlers[a];return v.push(u),{dispose:()=>{const d=v.indexOf(u);d!==-1&&v.splice(d,1)}}}clearHandler(a){this._handlers[a]&&delete this._handlers[a]}setHandlerFallback(a){this._handlerFb=a}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=_}reset(){if(this._state===2)for(let a=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;a>=0;--a)this._active[a].end(!1);this._stack.paused=!1,this._active=_,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||_,this._active.length)for(let a=this._active.length-1;a>=0;a--)this._active[a].start();else this._handlerFb(this._id,"START")}_put(a,u,v){if(this._active.length)for(let d=this._active.length-1;d>=0;d--)this._active[d].put(a,u,v);else this._handlerFb(this._id,"PUT",(0,c.utf32ToString)(a,u,v))}start(){this.reset(),this._state=1}put(a,u,v){if(this._state!==3){if(this._state===1)for(;u<v;){const d=a[u++];if(d===59){this._state=2,this._start();break}if(d<48||57<d)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+d-48}this._state===2&&v-u>0&&this._put(a,u,v)}}end(a,u=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let v=!1,d=this._active.length-1,e=!1;if(this._stack.paused&&(d=this._stack.loopPosition-1,v=u,e=this._stack.fallThrough,this._stack.paused=!1),!e&&v===!1){for(;d>=0&&(v=this._active[d].end(a),v!==!0);d--)if(v instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=d,this._stack.fallThrough=!1,v;d--}for(;d>=0;d--)if(v=this._active[d].end(!1),v instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=d,this._stack.fallThrough=!0,v}else this._handlerFb(this._id,"END",a);this._active=_,this._id=-1,this._state=0}}},t.OscHandler=class{constructor(a){this._handler=a,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(a,u,v){this._hitLimit||(this._data+=(0,c.utf32ToString)(a,u,v),this._data.length>h.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(a){let u=!1;if(this._hitLimit)u=!1;else if(a&&(u=this._handler(this._data),u instanceof Promise))return u.then(v=>(this._data="",this._hitLimit=!1,v));return this._data="",this._hitLimit=!1,u}}},8742:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Params=void 0;const r=2147483647;class h{constructor(_=32,a=32){if(this.maxLength=_,this.maxSubParamsLength=a,a>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(_),this.length=0,this._subParams=new Int32Array(a),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(_),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}static fromArray(_){const a=new h;if(!_.length)return a;for(let u=Array.isArray(_[0])?1:0;u<_.length;++u){const v=_[u];if(Array.isArray(v))for(let d=0;d<v.length;++d)a.addSubParam(v[d]);else a.addParam(v)}return a}clone(){const _=new h(this.maxLength,this.maxSubParamsLength);return _.params.set(this.params),_.length=this.length,_._subParams.set(this._subParams),_._subParamsLength=this._subParamsLength,_._subParamsIdx.set(this._subParamsIdx),_._rejectDigits=this._rejectDigits,_._rejectSubDigits=this._rejectSubDigits,_._digitIsSub=this._digitIsSub,_}toArray(){const _=[];for(let a=0;a<this.length;++a){_.push(this.params[a]);const u=this._subParamsIdx[a]>>8,v=255&this._subParamsIdx[a];v-u>0&&_.push(Array.prototype.slice.call(this._subParams,u,v))}return _}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(_){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(_<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=_>r?r:_}}addSubParam(_){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(_<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=_>r?r:_,this._subParamsIdx[this.length-1]++}}hasSubParams(_){return(255&this._subParamsIdx[_])-(this._subParamsIdx[_]>>8)>0}getSubParams(_){const a=this._subParamsIdx[_]>>8,u=255&this._subParamsIdx[_];return u-a>0?this._subParams.subarray(a,u):null}getSubParamsAll(){const _={};for(let a=0;a<this.length;++a){const u=this._subParamsIdx[a]>>8,v=255&this._subParamsIdx[a];v-u>0&&(_[a]=this._subParams.slice(u,v))}return _}addDigit(_){let a;if(this._rejectDigits||!(a=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const u=this._digitIsSub?this._subParams:this.params,v=u[a-1];u[a-1]=~v?Math.min(10*v+_,r):_}}t.Params=h},5741:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AddonManager=void 0,t.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let r=this._addons.length-1;r>=0;r--)this._addons[r].instance.dispose()}loadAddon(r,h){const c={instance:h,dispose:h.dispose,isDisposed:!1};this._addons.push(c),h.dispose=()=>this._wrappedAddonDispose(c),h.activate(r)}_wrappedAddonDispose(r){if(r.isDisposed)return;let h=-1;for(let c=0;c<this._addons.length;c++)if(this._addons[c]===r){h=c;break}if(h===-1)throw new Error("Could not dispose an addon that has not been loaded");r.isDisposed=!0,r.dispose.apply(r.instance),this._addons.splice(h,1)}}},8771:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferApiView=void 0;const h=r(3785),c=r(511);t.BufferApiView=class{constructor(_,a){this._buffer=_,this.type=a}init(_){return this._buffer=_,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(_){const a=this._buffer.lines.get(_);if(a)return new h.BufferLineApiView(a)}getNullCell(){return new c.CellData}}},3785:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferLineApiView=void 0;const h=r(511);t.BufferLineApiView=class{constructor(c){this._line=c}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(c,_){if(!(c<0||c>=this._line.length))return _?(this._line.loadCell(c,_),_):this._line.loadCell(c,new h.CellData)}translateToString(c,_,a){return this._line.translateToString(c,_,a)}}},8285:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BufferNamespaceApi=void 0;const h=r(8771),c=r(8460);t.BufferNamespaceApi=class{constructor(_){this._core=_,this._onBufferChange=new c.EventEmitter,this.onBufferChange=this._onBufferChange.event,this._normal=new h.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new h.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}},7975:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ParserApi=void 0,t.ParserApi=class{constructor(r){this._core=r}registerCsiHandler(r,h){return this._core.registerCsiHandler(r,c=>h(c.toArray()))}addCsiHandler(r,h){return this.registerCsiHandler(r,h)}registerDcsHandler(r,h){return this._core.registerDcsHandler(r,(c,_)=>h(c,_.toArray()))}addDcsHandler(r,h){return this.registerDcsHandler(r,h)}registerEscHandler(r,h){return this._core.registerEscHandler(r,h)}addEscHandler(r,h){return this.registerEscHandler(r,h)}registerOscHandler(r,h){return this._core.registerOscHandler(r,h)}addOscHandler(r,h){return this.registerOscHandler(r,h)}}},7090:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeApi=void 0,t.UnicodeApi=class{constructor(r){this._core=r}register(r){this._core.unicodeService.register(r)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(r){this._core.unicodeService.activeVersion=r}}},744:function(L,t,r){var h=this&&this.__decorate||function(e,s,o,i){var n,f=arguments.length,p=f<3?s:i===null?i=Object.getOwnPropertyDescriptor(s,o):i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(e,s,o,i);else for(var C=e.length-1;C>=0;C--)(n=e[C])&&(p=(f<3?n(p):f>3?n(s,o,p):n(s,o))||p);return f>3&&p&&Object.defineProperty(s,o,p),p},c=this&&this.__param||function(e,s){return function(o,i){s(o,i,e)}};Object.defineProperty(t,"__esModule",{value:!0}),t.BufferService=t.MINIMUM_ROWS=t.MINIMUM_COLS=void 0;const _=r(2585),a=r(5295),u=r(8460),v=r(844);t.MINIMUM_COLS=2,t.MINIMUM_ROWS=1;let d=class extends v.Disposable{constructor(e){super(),this.isUserScrolling=!1,this._onResize=this.register(new u.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new u.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(e.rawOptions.cols||0,t.MINIMUM_COLS),this.rows=Math.max(e.rawOptions.rows||0,t.MINIMUM_ROWS),this.buffers=this.register(new a.BufferSet(e,this))}get buffer(){return this.buffers.active}resize(e,s){this.cols=e,this.rows=s,this.buffers.resize(e,s),this._onResize.fire({cols:e,rows:s})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(e,s=!1){const o=this.buffer;let i;i=this._cachedBlankLine,i&&i.length===this.cols&&i.getFg(0)===e.fg&&i.getBg(0)===e.bg||(i=o.getBlankLine(e,s),this._cachedBlankLine=i),i.isWrapped=s;const n=o.ybase+o.scrollTop,f=o.ybase+o.scrollBottom;if(o.scrollTop===0){const p=o.lines.isFull;f===o.lines.length-1?p?o.lines.recycle().copyFrom(i):o.lines.push(i.clone()):o.lines.splice(f+1,0,i.clone()),p?this.isUserScrolling&&(o.ydisp=Math.max(o.ydisp-1,0)):(o.ybase++,this.isUserScrolling||o.ydisp++)}else{const p=f-n+1;o.lines.shiftElements(n+1,p-1,-1),o.lines.set(f,i.clone())}this.isUserScrolling||(o.ydisp=o.ybase),this._onScroll.fire(o.ydisp)}scrollLines(e,s,o){const i=this.buffer;if(e<0){if(i.ydisp===0)return;this.isUserScrolling=!0}else e+i.ydisp>=i.ybase&&(this.isUserScrolling=!1);const n=i.ydisp;i.ydisp=Math.max(Math.min(i.ydisp+e,i.ybase),0),n!==i.ydisp&&(s||this._onScroll.fire(i.ydisp))}scrollPages(e){this.scrollLines(e*(this.rows-1))}scrollToTop(){this.scrollLines(-this.buffer.ydisp)}scrollToBottom(){this.scrollLines(this.buffer.ybase-this.buffer.ydisp)}scrollToLine(e){const s=e-this.buffer.ydisp;s!==0&&this.scrollLines(s)}};d=h([c(0,_.IOptionsService)],d),t.BufferService=d},7994:(L,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CharsetService=void 0,t.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(r){this.glevel=r,this.charset=this._charsets[r]}setgCharset(r,h){this._charsets[r]=h,this.glevel===r&&(this.charset=h)}}},1753:function(L,t,r){var h=this&&this.__decorate||function(i,n,f,p){var C,l=arguments.length,g=l<3?n:p===null?p=Object.getOwnPropertyDescriptor(n,f):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(i,n,f,p);else for(var w=i.length-1;w>=0;w--)(C=i[w])&&(g=(l<3?C(g):l>3?C(n,f,g):C(n,f))||g);return l>3&&g&&Object.defineProperty(n,f,g),g},c=this&&this.__param||function(i,n){return function(f,p){n(f,p,i)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreMouseService=void 0;const _=r(2585),a=r(8460),u=r(844),v={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:i=>i.button!==4&&i.action===1&&(i.ctrl=!1,i.alt=!1,i.shift=!1,!0)},VT200:{events:19,restrict:i=>i.action!==32},DRAG:{events:23,restrict:i=>i.action!==32||i.button!==3},ANY:{events:31,restrict:i=>!0}};function d(i,n){let f=(i.ctrl?16:0)|(i.shift?4:0)|(i.alt?8:0);return i.button===4?(f|=64,f|=i.action):(f|=3&i.button,4&i.button&&(f|=64),8&i.button&&(f|=128),i.action===32?f|=32:i.action!==0||n||(f|=3)),f}const e=String.fromCharCode,s={DEFAULT:i=>{const n=[d(i,!1)+32,i.col+32,i.row+32];return n[0]>255||n[1]>255||n[2]>255?"":`\x1B[M${e(n[0])}${e(n[1])}${e(n[2])}`},SGR:i=>{const n=i.action===0&&i.button!==4?"m":"M";return`\x1B[<${d(i,!0)};${i.col};${i.row}${n}`},SGR_PIXELS:i=>{const n=i.action===0&&i.button!==4?"m":"M";return`\x1B[<${d(i,!0)};${i.x};${i.y}${n}`}};let o=class extends u.Disposable{constructor(i,n){super(),this._bufferService=i,this._coreService=n,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new a.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const f of Object.keys(v))this.addProtocol(f,v[f]);for(const f of Object.keys(s))this.addEncoding(f,s[f]);this.reset()}addProtocol(i,n){this._protocols[i]=n}addEncoding(i,n){this._encodings[i]=n}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(i){if(!this._protocols[i])throw new Error(`unknown protocol "${i}"`);this._activeProtocol=i,this._onProtocolChange.fire(this._protocols[i].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(i){if(!this._encodings[i])throw new Error(`unknown encoding "${i}"`);this._activeEncoding=i}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(i){if(i.col<0||i.col>=this._bufferService.cols||i.row<0||i.row>=this._bufferService.rows||i.button===4&&i.action===32||i.button===3&&i.action!==32||i.button!==4&&(i.action===2||i.action===3)||(i.col++,i.row++,i.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,i,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(i))return!1;const n=this._encodings[this._activeEncoding](i);return n&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(n):this._coreService.triggerDataEvent(n,!0)),this._lastEvent=i,!0}explainEvents(i){return{down:!!(1&i),up:!!(2&i),drag:!!(4&i),move:!!(8&i),wheel:!!(16&i)}}_equalEvents(i,n,f){if(f){if(i.x!==n.x||i.y!==n.y)return!1}else if(i.col!==n.col||i.row!==n.row)return!1;return i.button===n.button&&i.action===n.action&&i.ctrl===n.ctrl&&i.alt===n.alt&&i.shift===n.shift}};o=h([c(0,_.IBufferService),c(1,_.ICoreService)],o),t.CoreMouseService=o},6975:function(L,t,r){var h=this&&this.__decorate||function(o,i,n,f){var p,C=arguments.length,l=C<3?i:f===null?f=Object.getOwnPropertyDescriptor(i,n):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")l=Reflect.decorate(o,i,n,f);else for(var g=o.length-1;g>=0;g--)(p=o[g])&&(l=(C<3?p(l):C>3?p(i,n,l):p(i,n))||l);return C>3&&l&&Object.defineProperty(i,n,l),l},c=this&&this.__param||function(o,i){return function(n,f){i(n,f,o)}};Object.defineProperty(t,"__esModule",{value:!0}),t.CoreService=void 0;const _=r(2585),a=r(8460),u=r(1439),v=r(844),d=Object.freeze({insertMode:!1}),e=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let s=class extends v.Disposable{constructor(o,i,n){super(),this._bufferService=o,this._logService=i,this._optionsService=n,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new a.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new a.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new a.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new a.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,u.clone)(d),this.decPrivateModes=(0,u.clone)(e)}reset(){this.modes=(0,u.clone)(d),this.decPrivateModes=(0,u.clone)(e)}triggerDataEvent(o,i=!1){if(this._optionsService.rawOptions.disableStdin)return;const n=this._bufferService.buffer;i&&this._optionsService.rawOptions.scrollOnUserInput&&n.ybase!==n.ydisp&&this._onRequestScrollToBottom.fire(),i&&this._onUserInput.fire(),this._logService.debug(`sending data "${o}"`,()=>o.split("").map(f=>f.charCodeAt(0))),this._onData.fire(o)}triggerBinaryEvent(o){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${o}"`,()=>o.split("").map(i=>i.charCodeAt(0))),this._onBinary.fire(o))}};s=h([c(0,_.IBufferService),c(1,_.ILogService),c(2,_.IOptionsService)],s),t.CoreService=s},9074:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DecorationService=void 0;const h=r(8055),c=r(8460),_=r(844),a=r(6106);let u=0,v=0;class d extends _.Disposable{constructor(){super(),this._decorations=new a.SortedList(o=>o?.marker.line),this._onDecorationRegistered=this.register(new c.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new c.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,_.toDisposable)(()=>{for(const o of this._decorations.values())this._onDecorationRemoved.fire(o);this.reset()}))}get decorations(){return this._decorations.values()}registerDecoration(o){if(o.marker.isDisposed)return;const i=new e(o);if(i){const n=i.marker.onDispose(()=>i.dispose());i.onDispose(()=>{i&&(this._decorations.delete(i)&&this._onDecorationRemoved.fire(i),n.dispose())}),this._decorations.insert(i),this._onDecorationRegistered.fire(i)}return i}reset(){for(const o of this._decorations.values())o.dispose();this._decorations.clear()}*getDecorationsAtCell(o,i,n){var f,p,C;let l=0,g=0;for(const w of this._decorations.getKeyIterator(i))l=(f=w.options.x)!==null&&f!==void 0?f:0,g=l+((p=w.options.width)!==null&&p!==void 0?p:1),o>=l&&o<g&&(!n||((C=w.options.layer)!==null&&C!==void 0?C:"bottom")===n)&&(yield w)}forEachDecorationAtCell(o,i,n,f){this._decorations.forEachByKey(i,p=>{var C,l,g;u=(C=p.options.x)!==null&&C!==void 0?C:0,v=u+((l=p.options.width)!==null&&l!==void 0?l:1),o>=u&&o<v&&(!n||((g=p.options.layer)!==null&&g!==void 0?g:"bottom")===n)&&f(p)})}dispose(){for(const o of this._decorations.values())this._onDecorationRemoved.fire(o);this.reset()}}t.DecorationService=d;class e extends _.Disposable{constructor(o){super(),this.options=o,this.isDisposed=!1,this.onRenderEmitter=this.register(new c.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new c.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=o.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=h.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=h.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InstantiationService=t.ServiceCollection=void 0;const h=r(2585),c=r(8343);class _{constructor(...u){this._entries=new Map;for(const[v,d]of u)this.set(v,d)}set(u,v){const d=this._entries.get(u);return this._entries.set(u,v),d}forEach(u){for(const[v,d]of this._entries.entries())u(v,d)}has(u){return this._entries.has(u)}get(u){return this._entries.get(u)}}t.ServiceCollection=_,t.InstantiationService=class{constructor(){this._services=new _,this._services.set(h.IInstantiationService,this)}setService(a,u){this._services.set(a,u)}getService(a){return this._services.get(a)}createInstance(a,...u){const v=(0,c.getServiceDependencies)(a).sort((s,o)=>s.index-o.index),d=[];for(const s of v){const o=this._services.get(s.id);if(!o)throw new Error(`[createInstance] ${a.name} depends on UNKNOWN service ${s.id}.`);d.push(o)}const e=v.length>0?v[0].index:u.length;if(u.length!==e)throw new Error(`[createInstance] First service dependency of ${a.name} at position ${e+1} conflicts with ${u.length} static arguments`);return new a(...u,...d)}}},7866:function(L,t,r){var h=this&&this.__decorate||function(d,e,s,o){var i,n=arguments.length,f=n<3?e:o===null?o=Object.getOwnPropertyDescriptor(e,s):o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")f=Reflect.decorate(d,e,s,o);else for(var p=d.length-1;p>=0;p--)(i=d[p])&&(f=(n<3?i(f):n>3?i(e,s,f):i(e,s))||f);return n>3&&f&&Object.defineProperty(e,s,f),f},c=this&&this.__param||function(d,e){return function(s,o){e(s,o,d)}};Object.defineProperty(t,"__esModule",{value:!0}),t.LogService=void 0;const _=r(844),a=r(2585),u={debug:a.LogLevelEnum.DEBUG,info:a.LogLevelEnum.INFO,warn:a.LogLevelEnum.WARN,error:a.LogLevelEnum.ERROR,off:a.LogLevelEnum.OFF};let v=class extends _.Disposable{constructor(d){super(),this._optionsService=d,this.logLevel=a.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel()))}_updateLogLevel(){this.logLevel=u[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(d){for(let e=0;e<d.length;e++)typeof d[e]=="function"&&(d[e]=d[e]())}_log(d,e,s){this._evalLazyOptionalParams(s),d.call(console,"xterm.js: "+e,...s)}debug(d,...e){this.logLevel<=a.LogLevelEnum.DEBUG&&this._log(console.log,d,e)}info(d,...e){this.logLevel<=a.LogLevelEnum.INFO&&this._log(console.info,d,e)}warn(d,...e){this.logLevel<=a.LogLevelEnum.WARN&&this._log(console.warn,d,e)}error(d,...e){this.logLevel<=a.LogLevelEnum.ERROR&&this._log(console.error,d,e)}};v=h([c(0,a.IOptionsService)],v),t.LogService=v},7302:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionsService=t.DEFAULT_OPTIONS=void 0;const h=r(8460),c=r(6114),_=r(844);t.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,customGlyphs:!0,drawBoldTextInBrightColors:!0,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rightClickSelectsWord:c.isMac,windowOptions:{},windowsMode:!1,wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const a=["normal","bold","100","200","300","400","500","600","700","800","900"];class u extends _.Disposable{constructor(d){super(),this._onOptionChange=this.register(new h.EventEmitter),this.onOptionChange=this._onOptionChange.event;const e=Object.assign({},t.DEFAULT_OPTIONS);for(const s in d)if(s in e)try{const o=d[s];e[s]=this._sanitizeAndValidateOption(s,o)}catch(o){console.error(o)}this.rawOptions=e,this.options=Object.assign({},e),this._setupOptions()}onSpecificOptionChange(d,e){return this.onOptionChange(s=>{s===d&&e(this.rawOptions[d])})}onMultipleOptionChange(d,e){return this.onOptionChange(s=>{d.indexOf(s)!==-1&&e()})}_setupOptions(){const d=s=>{if(!(s in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${s}"`);return this.rawOptions[s]},e=(s,o)=>{if(!(s in t.DEFAULT_OPTIONS))throw new Error(`No option with key "${s}"`);o=this._sanitizeAndValidateOption(s,o),this.rawOptions[s]!==o&&(this.rawOptions[s]=o,this._onOptionChange.fire(s))};for(const s in this.rawOptions){const o={get:d.bind(this,s),set:e.bind(this,s)};Object.defineProperty(this.options,s,o)}}_sanitizeAndValidateOption(d,e){switch(d){case"cursorStyle":if(e||(e=t.DEFAULT_OPTIONS[d]),!function(s){return s==="block"||s==="underline"||s==="bar"}(e))throw new Error(`"${e}" is not a valid value for ${d}`);break;case"wordSeparator":e||(e=t.DEFAULT_OPTIONS[d]);break;case"fontWeight":case"fontWeightBold":if(typeof e=="number"&&1<=e&&e<=1e3)break;e=a.includes(e)?e:t.DEFAULT_OPTIONS[d];break;case"cursorWidth":e=Math.floor(e);case"lineHeight":case"tabStopWidth":if(e<1)throw new Error(`${d} cannot be less than 1, value: ${e}`);break;case"minimumContrastRatio":e=Math.max(1,Math.min(21,Math.round(10*e)/10));break;case"scrollback":if((e=Math.min(e,4294967295))<0)throw new Error(`${d} cannot be less than 0, value: ${e}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(e<=0)throw new Error(`${d} cannot be less than or equal to 0, value: ${e}`);case"rows":case"cols":if(!e&&e!==0)throw new Error(`${d} must be numeric, value: ${e}`)}return e}}t.OptionsService=u},2660:function(L,t,r){var h=this&&this.__decorate||function(u,v,d,e){var s,o=arguments.length,i=o<3?v:e===null?e=Object.getOwnPropertyDescriptor(v,d):e;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(u,v,d,e);else for(var n=u.length-1;n>=0;n--)(s=u[n])&&(i=(o<3?s(i):o>3?s(v,d,i):s(v,d))||i);return o>3&&i&&Object.defineProperty(v,d,i),i},c=this&&this.__param||function(u,v){return function(d,e){v(d,e,u)}};Object.defineProperty(t,"__esModule",{value:!0}),t.OscLinkService=void 0;const _=r(2585);let a=class{constructor(u){this._bufferService=u,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(u){const v=this._bufferService.buffer;if(u.id===void 0){const n=v.addMarker(v.ybase+v.y),f={data:u,id:this._nextId++,lines:[n]};return n.onDispose(()=>this._removeMarkerFromLink(f,n)),this._dataByLinkId.set(f.id,f),f.id}const d=u,e=this._getEntryIdKey(d),s=this._entriesWithId.get(e);if(s)return this.addLineToLink(s.id,v.ybase+v.y),s.id;const o=v.addMarker(v.ybase+v.y),i={id:this._nextId++,key:this._getEntryIdKey(d),data:d,lines:[o]};return o.onDispose(()=>this._removeMarkerFromLink(i,o)),this._entriesWithId.set(i.key,i),this._dataByLinkId.set(i.id,i),i.id}addLineToLink(u,v){const d=this._dataByLinkId.get(u);if(d&&d.lines.every(e=>e.line!==v)){const e=this._bufferService.buffer.addMarker(v);d.lines.push(e),e.onDispose(()=>this._removeMarkerFromLink(d,e))}}getLinkData(u){var v;return(v=this._dataByLinkId.get(u))===null||v===void 0?void 0:v.data}_getEntryIdKey(u){return`${u.id};;${u.uri}`}_removeMarkerFromLink(u,v){const d=u.lines.indexOf(v);d!==-1&&(u.lines.splice(d,1),u.lines.length===0&&(u.data.id!==void 0&&this._entriesWithId.delete(u.key),this._dataByLinkId.delete(u.id)))}};a=h([c(0,_.IBufferService)],a),t.OscLinkService=a},8343:(L,t)=>{function r(h,c,_){c.di$target===c?c.di$dependencies.push({id:h,index:_}):(c.di$dependencies=[{id:h,index:_}],c.di$target=c)}Object.defineProperty(t,"__esModule",{value:!0}),t.createDecorator=t.getServiceDependencies=t.serviceRegistry=void 0,t.serviceRegistry=new Map,t.getServiceDependencies=function(h){return h.di$dependencies||[]},t.createDecorator=function(h){if(t.serviceRegistry.has(h))return t.serviceRegistry.get(h);const c=function(_,a,u){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");r(c,_,u)};return c.toString=()=>h,t.serviceRegistry.set(h,c),c}},2585:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IDecorationService=t.IUnicodeService=t.IOscLinkService=t.IOptionsService=t.ILogService=t.LogLevelEnum=t.IInstantiationService=t.ICharsetService=t.ICoreService=t.ICoreMouseService=t.IBufferService=void 0;const h=r(8343);var c;t.IBufferService=(0,h.createDecorator)("BufferService"),t.ICoreMouseService=(0,h.createDecorator)("CoreMouseService"),t.ICoreService=(0,h.createDecorator)("CoreService"),t.ICharsetService=(0,h.createDecorator)("CharsetService"),t.IInstantiationService=(0,h.createDecorator)("InstantiationService"),(c=t.LogLevelEnum||(t.LogLevelEnum={}))[c.DEBUG=0]="DEBUG",c[c.INFO=1]="INFO",c[c.WARN=2]="WARN",c[c.ERROR=3]="ERROR",c[c.OFF=4]="OFF",t.ILogService=(0,h.createDecorator)("LogService"),t.IOptionsService=(0,h.createDecorator)("OptionsService"),t.IOscLinkService=(0,h.createDecorator)("OscLinkService"),t.IUnicodeService=(0,h.createDecorator)("UnicodeService"),t.IDecorationService=(0,h.createDecorator)("DecorationService")},1480:(L,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UnicodeService=void 0;const h=r(8460),c=r(225);t.UnicodeService=class{constructor(){this._providers=Object.create(null),this._active="",this._onChange=new h.EventEmitter,this.onChange=this._onChange.event;const _=new c.UnicodeV6;this.register(_),this._active=_.version,this._activeProvider=_}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(_){if(!this._providers[_])throw new Error(`unknown Unicode version "${_}"`);this._active=_,this._activeProvider=this._providers[_],this._onChange.fire(_)}register(_){this._providers[_.version]=_}wcwidth(_){return this._activeProvider.wcwidth(_)}getStringCellWidth(_){let a=0;const u=_.length;for(let v=0;v<u;++v){let d=_.charCodeAt(v);if(55296<=d&&d<=56319){if(++v>=u)return a+this.wcwidth(d);const e=_.charCodeAt(v);56320<=e&&e<=57343?d=1024*(d-55296)+e-56320+65536:a+=this.wcwidth(e)}a+=this.wcwidth(d)}return a}}}},I={};function M(L){var t=I[L];if(t!==void 0)return t.exports;var r=I[L]={exports:{}};return T[L].call(r.exports,r,r.exports,M),r.exports}var m={};return(()=>{var L=m;Object.defineProperty(L,"__esModule",{value:!0}),L.Terminal=void 0;const t=M(3236),r=M(9042),h=M(7975),c=M(7090),_=M(5741),a=M(8285),u=["cols","rows"];L.Terminal=class{constructor(v){this._core=new t.Terminal(v),this._addonManager=new _.AddonManager,this._publicOptions=Object.assign({},this._core.options);const d=s=>this._core.options[s],e=(s,o)=>{this._checkReadonlyOptions(s),this._core.options[s]=o};for(const s in this._core.options){const o={get:d.bind(this,s),set:e.bind(this,s)};Object.defineProperty(this._publicOptions,s,o)}}_checkReadonlyOptions(v){if(u.includes(v))throw new Error(`Option "${v}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new h.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new c.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=new a.BufferNamespaceApi(this._core)),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const v=this._core.coreService.decPrivateModes;let d="none";switch(this._core.coreMouseService.activeProtocol){case"X10":d="x10";break;case"VT200":d="vt200";break;case"DRAG":d="drag";break;case"ANY":d="any"}return{applicationCursorKeysMode:v.applicationCursorKeys,applicationKeypadMode:v.applicationKeypad,bracketedPasteMode:v.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:d,originMode:v.origin,reverseWraparoundMode:v.reverseWraparound,sendFocusMode:v.sendFocus,wraparoundMode:v.wraparound}}get options(){return this._publicOptions}set options(v){for(const d in v)this._publicOptions[d]=v[d]}blur(){this._core.blur()}focus(){this._core.focus()}resize(v,d){this._verifyIntegers(v,d),this._core.resize(v,d)}open(v){this._core.open(v)}attachCustomKeyEventHandler(v){this._core.attachCustomKeyEventHandler(v)}registerLinkProvider(v){return this._core.registerLinkProvider(v)}registerCharacterJoiner(v){return this._checkProposedApi(),this._core.registerCharacterJoiner(v)}deregisterCharacterJoiner(v){this._checkProposedApi(),this._core.deregisterCharacterJoiner(v)}registerMarker(v=0){return this._verifyIntegers(v),this._core.addMarker(v)}registerDecoration(v){var d,e,s;return this._checkProposedApi(),this._verifyPositiveIntegers((d=v.x)!==null&&d!==void 0?d:0,(e=v.width)!==null&&e!==void 0?e:0,(s=v.height)!==null&&s!==void 0?s:0),this._core.registerDecoration(v)}hasSelection(){return this._core.hasSelection()}select(v,d,e){this._verifyIntegers(v,d,e),this._core.select(v,d,e)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(v,d){this._verifyIntegers(v,d),this._core.selectLines(v,d)}dispose(){this._addonManager.dispose(),this._core.dispose()}scrollLines(v){this._verifyIntegers(v),this._core.scrollLines(v)}scrollPages(v){this._verifyIntegers(v),this._core.scrollPages(v)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(v){this._verifyIntegers(v),this._core.scrollToLine(v)}clear(){this._core.clear()}write(v,d){this._core.write(v,d)}writeln(v,d){this._core.write(v),this._core.write(`\r
`,d)}paste(v){this._core.paste(v)}refresh(v,d){this._verifyIntegers(v,d),this._core.refresh(v,d)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(v){return this._addonManager.loadAddon(this,v)}static get strings(){return r}_verifyIntegers(...v){for(const d of v)if(d===1/0||isNaN(d)||d%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...v){for(const d of v)if(d&&(d===1/0||isNaN(d)||d%1!=0||d<0))throw new Error("This API only accepts positive integers")}}})(),m})()})})(ct);var kt=ct.exports,_t={exports:{}};(function(b,y){(function(T,I){b.exports=I()})(self,()=>(()=>{var T={593:(M,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.EventEmitter=void 0;var L=function(){function t(){this.listeners=[]}return Object.defineProperty(t.prototype,"register",{get:function(){var r=this.listeners;return function(h){return r.push(h),{dispose:function(){for(var c=0;c<r.length;c++)if(r[c]===h)return void r.splice(c,1)}}}},enumerable:!1,configurable:!0}),t.prototype.fire=function(r){for(var h=0,c=this.listeners;h<c.length;h++)(0,c[h])(r)},t}();m.EventEmitter=L},164:function(M,m,L){var t=this&&this.__createBinding||(Object.create?function(h,c,_,a){a===void 0&&(a=_);var u=Object.getOwnPropertyDescriptor(c,_);u&&!("get"in u?!c.__esModule:u.writable||u.configurable)||(u={enumerable:!0,get:function(){return c[_]}}),Object.defineProperty(h,a,u)}:function(h,c,_,a){a===void 0&&(a=_),h[a]=c[_]}),r=this&&this.__exportStar||function(h,c){for(var _ in h)_==="default"||Object.prototype.hasOwnProperty.call(c,_)||t(c,h,_)};Object.defineProperty(m,"__esModule",{value:!0}),r(L(287),m),r(L(925),m),r(L(918),m),r(L(836),m),r(L(459),m)},287:(M,m,L)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.LineDiscipline=void 0;var t=L(918),r=L(925),h=L(593),c=function(){function _(){this._onWriteToLower=new h.EventEmitter,this.onWriteToLower=this._onWriteToLower.register,this._onWriteToUpper=new h.EventEmitter,this.onWriteToUpper=this._onWriteToUpper.register,this._onSignalToUpper=new h.EventEmitter,this.onSignalToUpper=this._onSignalToUpper.register,this._onFlowActivated=new h.EventEmitter,this.onFlowActivated=this._onFlowActivated.register,this._onFlowDeactivated=new h.EventEmitter,this.onFlowDeactivated=this._onFlowDeactivated.register,this.T=r.defaultTermios,this.keyActions=new Array(256).fill("normal"),this.flowActivated=!0,this.column=0,this.baseColumn=0,this.vlnext=!1,this.echoprt=!1,this.toLowerBuf=[],this.toUpperBuf=[],this.termios=r.defaultTermios}return _.prototype.activateFlow=function(){this.flowActivated=!0,this._onFlowActivated.fire()},_.prototype.deactivateFlow=function(){this.flowActivated=!1,this._onFlowDeactivated.fire()},Object.defineProperty(_.prototype,"flow",{get:function(){return this.flowActivated},enumerable:!1,configurable:!0}),Object.defineProperty(_.prototype,"termios",{get:function(){return this.T},set:function(a){this.T=a;var u=new Array(256).fill("normal");a.ICANON_P&&(u[a.EOF_V]="VEOF",u[a.EOL_V]="VEOL",u[a.EOL2_V]="VEOL",u[a.ERASE_V]="VERASE",u[a.KILL_V]="VKILL",a.IEXTEN_P&&(u[a.REPRINT_V]="VREPRINT",u[a.WERASE_V]="VWERASE")),a.IEXTEN_P&&(u[a.LNEXT_V]="VLNEXT"),a.IXON_P&&(u[a.START_V]="VSTART",u[a.STOP_V]="VSTOP"),a.ISIG_P&&(u[a.INTR_V]="VINTR",u[a.QUIT_V]="VQUIT",u[a.SUSP_V]="VSUSP"),u[0]="normal",this.keyActions=u,this.T.IXON_P||(this.activateFlow(),this.flushToLower())},enumerable:!1,configurable:!0}),_.prototype.clearToLower=function(){this.toLowerBuf.length=0},_.prototype.flushToLower=function(){this.flowActivated!=0&&(this._onWriteToLower.fire(this.toLowerBuf),this.clearToLower())},_.prototype.outputToLower=function(a){var u;(u=this.toLowerBuf).push.apply(u,a)},_.prototype.clearToUpper=function(){this.toUpperBuf.length=0,this.baseColumn=this.column},_.prototype.flushToUpper=function(){this._onWriteToUpper.fire(this.toUpperBuf),this.clearToUpper()},_.prototype.outputToUpper=function(a){this.toUpperBuf.push(a)},_.prototype.outputToLowerWithPostprocess=function(a){if(this.T.OPOST_P)switch(a){case t.BS:this.column>0&&this.column--,this.outputToLower([t.BS]);break;case t.TAB:var u=8-this.column%8;this.column+=u,this.outputToLower(this.T.TABDLY_XTABS_P?new Array(u).fill(t.SP):[t.TAB]);break;case t.NL:this.T.ONLCR_P?(this.baseColumn=this.column=0,this.outputToLower([t.CR,t.NL])):this.T.ONLRET_P?(this.column=0,this.outputToLower([t.NL])):(this.baseColumn=this.column,this.outputToLower([t.NL]));break;case t.CR:this.T.ONOCR_P&&this.column==0||(this.T.OCRNL_P?(this.T.ONLRET_P&&(this.baseColumn=this.column=0),this.outputToLower([t.NL])):(this.baseColumn=this.column=0,this.outputToLower([t.CR])));break;default:this.T.IUTF8_P&&(0,t.isUtf8ContinuationByte)(a)||this.column++,this.outputToLower(this.T.OLCUC_P?[(0,t.toupper)(a)]:[a])}else this.outputToLower([a])},_.prototype.echoToLower=function(a,u){typeof a=="number"&&(a=[a]);for(var v=0,d=a;v<d.length;v++){var e=d[v];this.T.ECHOCTL_P&&(0,t.iscntrl)(e)&&e!=t.TAB&&!u?(this.outputToLower([94,64^e]),this.column+=2):this.outputToLowerWithPostprocess(e)}},_.prototype.inputFromLowerWithPreprocess=function(a){if(a==t.CR){if(this.T.IGNCR_P)return;this.T.ICRNL_P&&(a=t.NL)}else a==t.NL&&this.T.INLCR_P&&(a=t.CR);this.T.ICANON_P&&a==t.NL?((this.T.ECHO_P||this.T.ECHONL_P)&&(this.echoToLower(t.NL,!0),this.flushToLower()),this.outputToUpper(t.NL),this.flushToUpper()):this.T.ECHO_P?(this.finishECHOPRT(),a==t.NL?this.echoToLower(t.NL,!0):this.echoToLower(a),this.flushToLower(),this.outputToUpper(a)):this.outputToUpper(a)},_.prototype.erase=function(a){if(this.toUpperBuf.length!=0){if(a=="VKILL"){if(!this.T.ECHO_P)return void this.clearToUpper();if(!this.T.ECHOK_P||!this.T.ECHOKE_P||!this.T.ECHOE_P)return this.clearToUpper(),this.finishECHOPRT(),this.echoToLower(this.T.KILL_V),void(this.T.ECHOK_P&&this.echoToLower(t.NL,!0))}for(var u=!1,v=this.toUpperBuf.length-1;v>=0;v--){var d=this.toUpperBuf[v];if(!this.T.IUTF8_P||!(0,t.isUtf8ContinuationByte)(d)){if(a=="VWERASE"){if((0,t.isalnum)(d)||d==95)u=!0;else if(u)break}var e=this.toUpperBuf.splice(v);if(this.T.ECHO_P)if(this.T.ECHOPRT_P)this.startECHOPRT(),this.echoToLower(e);else if(a!="VERASE"||this.T.ECHOE_P)if(d==t.TAB){for(var s=0,o=!1,i=this.toUpperBuf.length-1;i>=0;i--){var n=this.toUpperBuf[i];if(n==t.TAB){o=!0;break}(0,t.iscntrl)(n)?this.T.ECHOCTL_P&&(s+=2):this.T.IUTF8_P&&(0,t.isUtf8ContinuationByte)(n)||s++}o||(s+=this.baseColumn),s=8-s%8,this.outputToLower(new Array(s).fill(t.BS)),this.column=Math.max(0,this.column-s)}else(0,t.iscntrl)(d)&&this.T.ECHOCTL_P&&this.echoToLower([t.BS,t.SP,t.BS],!0),(0,t.iscntrl)(d)&&!this.T.ECHOCTL_P||this.echoToLower([t.BS,t.SP,t.BS],!0);else this.echoToLower(this.T.ERASE_V);if(a=="VERASE")break}}this.toUpperBuf.length==0&&(this.clearToUpper(),this.T.ECHO_P&&this.finishECHOPRT())}},_.prototype.startECHOPRT=function(){this.echoprt||(this.echoToLower(92,!0),this.echoprt=!0)},_.prototype.finishECHOPRT=function(){this.echoprt&&(this.echoToLower(47,!0),this.echoprt=!1)},_.prototype.signal=function(a,u){this._onSignalToUpper.fire(a),this.T.NOFLSH_P||(this.clearToLower(),this.clearToUpper()),this.T.IXON_P&&this.activateFlow(),this.T.ECHO_P&&this.echoToLower(u),this.flushToLower()},_.prototype.checkStartFlow=function(){this.flowActivated==0&&this.T.IXON_P&&this.T.IXANY_P&&(this.activateFlow(),this.flushToLower())},_.prototype.nextLiteral=function(){this.vlnext=!0,this.T.ECHO_P&&(this.finishECHOPRT(),this.T.ECHOCTL_P&&(this.echoToLower([94,t.BS],!0),this.flushToLower()))},_.prototype.reprint=function(){this.finishECHOPRT(),this.echoToLower(this.T.REPRINT_V),this.echoToLower(t.NL,!0),this.echoToLower(this.toUpperBuf)},_.prototype.writeFromLower=function(a){for(var u=0,v=typeof a=="string"?(0,t.stringToUtf8Bytes)(a):a;u<v.length;u++){var d=v[u];this.T.ISTRIP_P&&(d&=127),this.T.IUCLC_P&&this.T.IEXTEN_P&&(d=(0,t.tolower)(d));var e=this.vlnext?"normal":this.keyActions[d];switch(this.vlnext=!1,e){case"normal":this.checkStartFlow(),this.inputFromLowerWithPreprocess(d);break;case"VERASE":case"VWERASE":case"VKILL":this.checkStartFlow(),this.erase(e),this.flushToLower();break;case"VEOF":this.checkStartFlow(),this.flushToUpper();break;case"VEOL":this.checkStartFlow(),this.T.ECHO_P&&(this.echoToLower(d),this.flushToLower()),this.outputToUpper(d),this.flushToUpper();break;case"VLNEXT":this.checkStartFlow(),this.nextLiteral();break;case"VREPRINT":this.checkStartFlow(),this.reprint(),this.flushToLower();break;case"VSTART":this.activateFlow(),this.flushToLower();break;case"VSTOP":this.deactivateFlow();break;case"VINTR":this.signal("SIGINT",d);break;case"VQUIT":this.signal("SIGQUIT",d);break;case"VSUSP":this.signal("SIGTSTP",d)}}this.T.ICANON_P||this.flushToUpper()},_.prototype.writeFromUpper=function(a){if(this.flowActivated==0)throw"Do not write anything during flowStatus is stopped";for(var u=0,v=typeof a=="string"?(0,t.stringToUtf8Bytes)(a):a;u<v.length;u++){var d=v[u];this.outputToLowerWithPostprocess(d)}this.flushToLower()},_}();m.LineDiscipline=c},836:(M,m,L)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.openpty=m.Slave=void 0;var t=L(593),r=L(287),h=L(918),c=function(){function a(u,v){var d=this;this.ldisc=u,this.slave=v,this.disposables=[],this._onWrite=new t.EventEmitter,this.onWrite=this._onWrite.register,this.fromLdiscToLowerBuffer=[],this.waitingForLower=!1;var e=function(){if(d.fromLdiscToLowerBuffer.length>=1){d.waitingForLower=!0;var n=new Uint8Array(d.fromLdiscToLowerBuffer.splice(0,4096));d.fromLdiscToLowerBuffer.length<=4096&&d.notifyWritable(),d._onWrite.fire([n,e])}else d.waitingForLower=!1};this.ldisc.onWriteToLower(function(n){var f;(f=d.fromLdiscToLowerBuffer).push.apply(f,n),d.waitingForLower||e()});var s=v.initFromMaster(),o=s.notifyWritable,i=s.notifyResize;this.notifyWritable=o,this.notifyResize=i}return a.prototype.activate=function(u){var v=this;this.onWrite(function(e){var s=e[0],o=e[1];return u.write(s,o)});var d=function(e){return v.ldisc.writeFromLower((0,h.stringToUtf8Bytes)(e))};this.disposables.push(u.onData(d),u.onBinary(d),u.onResize(function(e){var s=e.cols,o=e.rows;return v.notifyResize(o,s)}))},a.prototype.dispose=function(){this.disposables.forEach(function(u){return u.dispose()}),this.disposables.length=0},a}(),_=function(){function a(u){var v=this;this.ldisc=u,this._onReadable=new t.EventEmitter,this.onReadable=this._onReadable.register,this._onWritable=new t.EventEmitter,this.onWritable=this._onWritable.register,this._onSignal=new t.EventEmitter,this.onSignal=this._onSignal.register,this.fromLdiscToUpperBuffer=[],this.fromUpperToLdiscBuffer=[],this.winsize=[80,24],this.ldisc.onWriteToUpper(function(d){var e;(e=v.fromLdiscToUpperBuffer).push.apply(e,d),v._onReadable.fire()}),this.ldisc.onFlowActivated(function(){v.fromUpperToLdiscBuffer.length>=1&&(v.ldisc.writeFromUpper(v.fromUpperToLdiscBuffer),v.fromUpperToLdiscBuffer.length=0)}),this.ldisc.onSignalToUpper(function(d){v._onSignal.fire(d)})}return a.prototype.initFromMaster=function(){var u=this;return{notifyWritable:function(){return u._onWritable.fire()},notifyResize:function(v,d){u.winsize=[d,v],u._onSignal.fire("SIGWINCH")}}},Object.defineProperty(a.prototype,"readable",{get:function(){return this.fromLdiscToUpperBuffer.length>=1},enumerable:!1,configurable:!0}),a.prototype.read=function(u){var v=u!==void 0?Math.min(this.fromLdiscToUpperBuffer.length,u):this.fromLdiscToUpperBuffer.length;return this.fromLdiscToUpperBuffer.splice(0,v)},Object.defineProperty(a.prototype,"writable",{get:function(){return this.fromUpperToLdiscBuffer.length<=4096},enumerable:!1,configurable:!0}),a.prototype.write=function(u){var v,d=typeof u=="string"?(0,h.stringToUtf8Bytes)(u):u;(v=this.fromUpperToLdiscBuffer).push.apply(v,d),this.ldisc.flow&&(this.ldisc.writeFromUpper(this.fromUpperToLdiscBuffer),this.fromUpperToLdiscBuffer.length=0)},a.prototype.ioctl=function(u,v){switch(u){case"TCGETS":return this.ldisc.termios.clone();case"TCSETS":return void(this.ldisc.termios=v);case"TIOCGWINSZ":return this.winsize}},a}();m.Slave=_,m.openpty=function(){var a=new r.LineDiscipline,u=new _(a);return{master:new c(a,u),slave:u}}},925:(M,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.dataToTermios=m.termiosToData=m.defaultTermios=m.Termios=m.VEOL2=m.VLNEXT=m.VWERASE=m.VDISCARD=m.VREPRINT=m.VEOL=m.VSUSP=m.VSTOP=m.VSTART=m.VSWTCH=m.VMIN=m.VTIME=m.VEOF=m.VKILL=m.VERASE=m.VQUIT=m.VINTR=m.IEXTEN=m.ECHOKE=m.ECHOPRT=m.ECHOCTL=m.NOFLSH=m.ECHONL=m.ECHOK=m.ECHOE=m.ECHO=m.ICANON=m.ISIG=m.XTABS=m.TABDLY=m.ONLRET=m.ONOCR=m.OCRNL=m.ONLCR=m.OLCUC=m.OPOST=m.IUTF8=m.IMAXBEL=m.IXANY=m.IXON=m.IUCLC=m.ICRNL=m.IGNCR=m.INLCR=m.ISTRIP=void 0,m.ISTRIP=32,m.INLCR=64,m.IGNCR=128,m.ICRNL=256,m.IUCLC=512,m.IXON=1024,m.IXANY=2048,m.IMAXBEL=8192,m.IUTF8=16384,m.OPOST=1,m.OLCUC=2,m.ONLCR=4,m.OCRNL=8,m.ONOCR=16,m.ONLRET=32,m.TABDLY=6144,m.XTABS=6144,m.ISIG=1,m.ICANON=2,m.ECHO=8,m.ECHOE=16,m.ECHOK=32,m.ECHONL=64,m.NOFLSH=128,m.ECHOCTL=512,m.ECHOPRT=1024,m.ECHOKE=2048,m.IEXTEN=32768,m.VINTR=0,m.VQUIT=1,m.VERASE=2,m.VKILL=3,m.VEOF=4,m.VTIME=5,m.VMIN=6,m.VSWTCH=7,m.VSTART=8,m.VSTOP=9,m.VSUSP=10,m.VEOL=11,m.VREPRINT=12,m.VDISCARD=13,m.VWERASE=14,m.VLNEXT=15,m.VEOL2=16;var L=function(){function t(r,h,c,_,a){this.iflag=r,this.oflag=h,this.cflag=c,this.lflag=_,this.cc=a,this.ISTRIP_P=(this.iflag&m.ISTRIP)!=0,this.INLCR_P=(this.iflag&m.INLCR)!=0,this.IGNCR_P=(this.iflag&m.IGNCR)!=0,this.ICRNL_P=(this.iflag&m.ICRNL)!=0,this.IUCLC_P=(this.iflag&m.IUCLC)!=0,this.IXON_P=(this.iflag&m.IXON)!=0,this.IXANY_P=(this.iflag&m.IXANY)!=0,this.IUTF8_P=(this.iflag&m.IUTF8)!=0,this.OPOST_P=(this.oflag&m.OPOST)!=0,this.OLCUC_P=(this.oflag&m.OLCUC)!=0,this.ONLCR_P=(this.oflag&m.ONLCR)!=0,this.OCRNL_P=(this.oflag&m.OCRNL)!=0,this.ONOCR_P=(this.oflag&m.ONOCR)!=0,this.ONLRET_P=(this.oflag&m.ONLRET)!=0,this.TABDLY_XTABS_P=(this.oflag&m.TABDLY)==m.XTABS,this.ISIG_P=(this.lflag&m.ISIG)!=0,this.ICANON_P=(this.lflag&m.ICANON)!=0,this.ECHO_P=(this.lflag&m.ECHO)!=0,this.ECHOE_P=(this.lflag&m.ECHOE)!=0,this.ECHOK_P=(this.lflag&m.ECHOK)!=0,this.ECHONL_P=(this.lflag&m.ECHONL)!=0,this.NOFLSH_P=(this.lflag&m.NOFLSH)!=0,this.ECHOCTL_P=(this.lflag&m.ECHOCTL)!=0,this.ECHOPRT_P=(this.lflag&m.ECHOPRT)!=0,this.ECHOKE_P=(this.lflag&m.ECHOKE)!=0,this.IEXTEN_P=(this.lflag&m.IEXTEN)!=0,this.INTR_V=this.cc[m.VINTR],this.QUIT_V=this.cc[m.VQUIT],this.ERASE_V=this.cc[m.VERASE],this.KILL_V=this.cc[m.VKILL],this.EOF_V=this.cc[m.VEOF],this.TIME_V=this.cc[m.VTIME],this.MIN_V=this.cc[m.VMIN],this.SWTCH_V=this.cc[m.VSWTCH],this.START_V=this.cc[m.VSTART],this.STOP_V=this.cc[m.VSTOP],this.SUSP_V=this.cc[m.VSUSP],this.EOL_V=this.cc[m.VEOL],this.REPRINT_V=this.cc[m.VREPRINT],this.DISCARD_V=this.cc[m.VDISCARD],this.WERASE_V=this.cc[m.VWERASE],this.LNEXT_V=this.cc[m.VLNEXT],this.EOL2_V=this.cc[m.VEOL2]}return t.prototype.clone=function(){return new t(this.iflag,this.oflag,this.cflag,this.lflag,this.cc.concat())},t}();m.Termios=L,m.defaultTermios=new L(m.ICRNL|m.IXON|m.IMAXBEL|m.IUTF8,m.OPOST|m.ONLCR,191,m.ISIG|m.ICANON|m.ECHO|m.ECHOE|m.ECHOK|m.ECHOCTL|m.ECHOKE|m.IEXTEN,[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),m.termiosToData=function(t){for(var r=[t.iflag,t.oflag,t.cflag,t.lflag],h=0,c=8,_=0;_<t.cc.length;_++)h|=t.cc[_]<<c,(c+=8)==32&&(r.push(h),h=0,c=0);return r.push(h),r},m.dataToTermios=function(t){for(var r=[],h=4,c=t[h++],_=8,a=0;a<32;a++)r.push(c>>_&255),(_+=8)>=32&&(c=t[h++],_=0);return new L(t[0],t[1],t[2],t[3],r)}},459:(M,m,L)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.TtyServer=void 0;var t=L(925),r=function(){function h(c){var _=this;this.slave=c,this.shared=new SharedArrayBuffer(260),this.streamCtrl=new Int32Array(this.shared,0,1),this.streamData=new Int32Array(this.shared,4),this.state="idle",this.timeoutHandler=null,this.fromWorkerBuf=[],this.toWorkerBuf=[],this.stop_=null,c.onWritable(function(){_.fromWorkerBuf.length>=1&&_.feedFromWorker()}),c.onReadable(function(){var a;switch((a=_.toWorkerBuf).push.apply(a,c.read()),_.state){case"poll":_.waitForReadable(0);break;case"input":_.feedToWorker(_.toWorkerBuf.length)}}),c.onSignal(function(a){console.info("A signal ".concat(a," is currently ignored"))})}return h.prototype.ack=function(){Atomics.store(this.streamCtrl,0,1),Atomics.notify(this.streamCtrl,0),this.state="idle"},h.prototype.feedToWorker=function(c){if(this.state!="input")throw"worker does not wait for input";c>this.streamData.length-1&&(c=this.streamData.length-1);var _=this.toWorkerBuf.splice(0,c);this.streamData[0]=_.length,this.streamData.set(_,1),this.ack()},h.prototype.feedFromWorker=function(){if(this.fromWorkerBuf.length==0)throw"worker does not wait for output";this.slave.writable&&(this.ack(),this.slave.write(this.fromWorkerBuf.splice(0)))},h.prototype.waitForReadable=function(c){var _=this;if(this.state!="poll")throw"worker does not wait for poll";this.timeoutHandler&&(clearTimeout(this.timeoutHandler),this.timeoutHandler=null),this.toWorkerBuf.length>0?(this.streamData[0]=1,this.ack()):c<0||(c>0?this.timeoutHandler=setTimeout(function(){return _.waitForReadable(0)},1e3*c):(this.streamData[0]=2,this.ack()))},h.prototype.start=function(c,_){var a=this;this.stop();var u=!1;this.stop_=function(){return u=!0},c.onmessage=function(v){var d,e=v.data;if(typeof e=="object"&&e.ttyRequestType){if(u)return;var s=e;switch(s.ttyRequestType){case"read":a.state="input",a.toWorkerBuf.length>=1&&a.feedToWorker(s.length);break;case"write":(d=a.fromWorkerBuf).push.apply(d,s.buf),a.feedFromWorker();break;case"poll":a.state="poll",a.waitForReadable(s.timeout);break;case"tcgets":a.streamData.set((0,t.termiosToData)(a.slave.ioctl("TCGETS"))),a.ack();break;case"tcsets":a.slave.ioctl("TCSETS",(0,t.dataToTermios)(s.data)),a.ack();break;case"tiocgwinsz":var o=a.slave.ioctl("TIOCGWINSZ"),i=o[0],n=o[1];a.streamData[0]=i,a.streamData[1]=n,a.ack()}}else _&&_(v)},c.postMessage(this.shared)},h.prototype.stop=function(){this.stop_&&this.stop_()},h}();m.TtyServer=r},918:(M,m)=>{Object.defineProperty(m,"__esModule",{value:!0}),m.stringToUtf8Bytes=m.utf8BytesToString=m.toupper=m.tolower=m.isUtf8ContinuationByte=m.iscntrl=m.isalnum=m.SP=m.CR=m.NL=m.TAB=m.BS=void 0,m.BS=8,m.TAB=9,m.NL=10,m.CR=13,m.SP=32,m.isalnum=function(L){return 48<=L&&L<=57||65<=L&&L<=90||L==95||97<=L&&L<=122},m.iscntrl=function(L){return 0<=L&&L<=31&&L!=9||L==127},m.isUtf8ContinuationByte=function(L){return(192&L)==128},m.tolower=function(L){return 65<=L&&L<=90?L+32:L},m.toupper=function(L){return 97<=L&&L<=122?L-32:L},m.utf8BytesToString=function(L){for(var t="",r=0;r<L.length;){var h=L[r],c=void 0;if(h<128)c=h;else if((224&h)==192){if(L.length<=r+1)break;c=(31&h)<<6,c|=63&L[++r]}else if((240&h)==224){if(L.length<=r+2)break;c=(15&h)<<12,c|=(63&L[++r])<<6,c|=63&L[++r]}else if((248&h)==240){if(L.length<=r+3)break;c=(3&h)<<18,c|=(63&L[++r])<<12,c|=(63&L[++r])<<6,c|=63&L[++r]}else c=65534;r++,t+=String.fromCodePoint(c)}return[t,L.slice(r)]},m.stringToUtf8Bytes=function(L){for(var t=[],r=0;r<L.length;){var h=L.codePointAt(r);h<128?t.push(h):h<2048?(t.push(192|h>>6),t.push(128|63&h)):h<65536?(t.push(224|h>>12),t.push(128|h>>6&63),t.push(128|63&h)):(t.push(240|h>>18),t.push(128|h>>12&63),t.push(128|h>>6&63),t.push(128|63&h)),r+=h>=65536?2:1}return t}}},I={};return function M(m){var L=I[m];if(L!==void 0)return L.exports;var t=I[m]={exports:{}};return T[m].call(t.exports,t,t.exports,M),t.exports}(164)})())})(_t);var Rt=_t.exports;var At=0;function Oe(b,y,T,I,M,m){var L,t,r={};for(t in y)t=="ref"?L=y[t]:r[t]=y[t];var h={type:b,props:r,key:T,ref:L,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--At,__source:M,__self:m};if(typeof b=="function"&&(L=b.defaultProps))for(t in L)r[t]===void 0&&(r[t]=L[t]);return X.vnode&&X.vnode(h),h}const Dt=({onCommand:b,worker:y})=>{const T=wt(null);return ot(()=>{const I=new kt.Terminal({cursorBlink:!0});I.open(T.current);const{master:M,slave:m}=Rt.openpty();return I.loadAddon(M),I.focus(),I.write("> "),m.onReadable(()=>{const L=m.read();b(L)}),m.onSignal(L=>console.log(L)),y.onmessage=L=>{m.write(`${L.data}`)},()=>I.dispose()},[b,y]),Oe("div",{ref:T})};let Z;const dt=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&dt.decode();let oe=null;function pe(){return(oe===null||oe.byteLength===0)&&(oe=new Uint8Array(Z.memory.buffer)),oe}function ke(b,y){return b=b>>>0,dt.decode(pe().subarray(b,b+y))}const ie=new Array(128).fill(void 0);ie.push(void 0,null,!0,!1);let he=ie.length;function Bt(b){he===ie.length&&ie.push(ie.length+1);const y=he;return he=ie[y],ie[y]=b,y}let Re=0;const ge=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},xt=typeof ge.encodeInto=="function"?function(b,y){return ge.encodeInto(b,y)}:function(b,y){const T=ge.encode(b);return y.set(T),{read:b.length,written:T.length}};function Ot(b,y,T){if(T===void 0){const t=ge.encode(b),r=y(t.length)>>>0;return pe().subarray(r,r+t.length).set(t),Re=t.length,r}let I=b.length,M=y(I)>>>0;const m=pe();let L=0;for(;L<I;L++){const t=b.charCodeAt(L);if(t>127)break;m[M+L]=t}if(L!==I){L!==0&&(b=b.slice(L)),M=T(M,I,I=L+b.length*3)>>>0;const t=pe().subarray(M+L,M+I),r=xt(b,t);L+=r.written}return Re=L,M}let ae=null;function ne(){return(ae===null||ae.byteLength===0)&&(ae=new Int32Array(Z.memory.buffer)),ae}function Pt(b){return ie[b]}function It(b){b<132||(ie[b]=he,he=b)}function ze(b){const y=Pt(b);return It(b),y}class be{static __wrap(y){y=y>>>0;const T=Object.create(be.prototype);return T.__wbg_ptr=y,T}__destroy_into_raw(){const y=this.__wbg_ptr;return this.__wbg_ptr=0,y}free(){const y=this.__destroy_into_raw();Z.__wbg_reader_free(y)}static new(){const y=Z.reader_new();return be.__wrap(y)}push(y){try{const M=Z.__wbindgen_add_to_stack_pointer(-16),m=Ot(y,Z.__wbindgen_malloc,Z.__wbindgen_realloc),L=Re;Z.reader_push(M,this.__wbg_ptr,m,L);var T=ne()[M/4+0],I=ne()[M/4+1];if(I)throw ze(T)}finally{Z.__wbindgen_add_to_stack_pointer(16)}}expression_complete(){return Z.reader_expression_complete(this.__wbg_ptr)!==0}new_expression(){return Z.reader_new_expression(this.__wbg_ptr)!==0}eval(){let y,T;try{const h=Z.__wbindgen_add_to_stack_pointer(-16);Z.reader_eval(h,this.__wbg_ptr);var I=ne()[h/4+0],M=ne()[h/4+1],m=ne()[h/4+2],L=ne()[h/4+3],t=I,r=M;if(L)throw t=0,r=0,ze(m);return y=t,T=r,ke(t,r)}finally{Z.__wbindgen_add_to_stack_pointer(16),Z.__wbindgen_free(y,T)}}}async function Mt(b,y){if(typeof Response=="function"&&b instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(b,y)}catch(I){if(b.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",I);else throw I}const T=await b.arrayBuffer();return await WebAssembly.instantiate(T,y)}else{const T=await WebAssembly.instantiate(b,y);return T instanceof WebAssembly.Instance?{instance:T,module:b}:T}}function Ht(){const b={};return b.wbg={},b.wbg.__wbindgen_string_new=function(y,T){const I=ke(y,T);return Bt(I)},b.wbg.__wbindgen_throw=function(y,T){throw new Error(ke(y,T))},b}function Ft(b,y){return Z=b.exports,ut.__wbindgen_wasm_module=y,ae=null,oe=null,Z}async function ut(b){if(Z!==void 0)return Z;typeof b>"u"&&(b=new URL("/lisp_rs/assets/lisp_rs_bg-96df70d3.wasm",self.location));const y=Ht();(typeof b=="string"||typeof Request=="function"&&b instanceof Request||typeof URL=="function"&&b instanceof URL)&&(b=fetch(b));const{instance:T,module:I}=await Mt(await b,y);return Ft(T,I)}const Ut=()=>{const[b,y]=bt();return ot(()=>{ut().then(()=>{y(be.new())})},[]),b};function Nt(){const b=Ut(),y=xe(()=>new Worker(new URL("/lisp_rs/assets/worker-8a90597e.js",self.location)),[]),T=Et(I=>{const M=I.map(t=>String.fromCharCode(t)).join("");b?.push(M);let m="";if(b?.expression_complete())try{m=b?.eval()}catch(t){m=t}const L=b?.expression_complete()||b?.new_expression()?"> ":". ";y.postMessage({result:m,prompt:L})},[b]);return Oe(Dt,{onCommand:T,worker:y})}Ct(Oe(Nt,{}),document.getElementById("app"));
